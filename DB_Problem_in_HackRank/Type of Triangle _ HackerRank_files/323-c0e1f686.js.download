(window.webpackJsonp=window.webpackJsonp||[]).push([[323],{C8X7:function(e,t,o){},Zqjb:function(e,t,o){},gGYH:function(e,t,o){"use strict";o.r(t);o("CX2u");var s=o("MVZn"),i=o.n(s),a=(o("rGqo"),o("lSNA")),n=o.n(a),l=o("w13Q"),r=o("cDcd"),c=o.n(r),d=o("17x9"),p=o.n(d),u=o("EVdn"),m=o.n(u),h=o("OnOE"),f=o.n(h),g=o("TSYQ"),b=o.n(g),C=o("wd/R"),S=o.n(C),E=o("OEX3"),O=o("O766"),k=o("H59Z"),v=o("eOGF"),w=o("ZaSc"),N=o("DM5n"),j=o("EfbJ"),U=o("oBtd"),y=o("mo6X"),F=o("IreD"),T=o("ryrm"),L=o("XzeZ"),D=o("pVnL"),_=o.n(D);o("Zqjb");function M(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,s)}return o}class W extends c.a.Component{constructor(){super(),n()(this,"state",void 0),n()(this,"onChange",e=>{const t=e.target.files;if(t.length){const e=t[0].name;this.setState({fileName:e})}this.props.onChange(e)}),this.state={fileName:""}}render(){const e=this.props,t=e.className,o=e.id,s=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?M(Object(o),!0).forEach((function(t){n()(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):M(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}({},this.props),i=this.state.fileName;return["className","onChange"].forEach(e=>{delete s[e]}),c.a.createElement("div",{className:b()("file-input-wrap",t),id:o||""},c.a.createElement("input",_()({className:"file-input",type:"file"},s,{onChange:this.onChange})),c.a.createElement("div",{className:"fake-input-wrap"},c.a.createElement("input",{type:"text",className:"fake-input",readOnly:!0,value:i}),c.a.createElement(E.d,{className:"fake-button btn",type:"button"},"Select File")))}}var P=W,A=o("xNbf");o("C8X7");o.d(t,"PureCodeshellEditor",(function(){return x})),Object(v.O)(["codemirror/.*.js","lib/codemirror_mode_elixir.js"]);class I extends c.a.Component{constructor(){super(),n()(this,"state",void 0),n()(this,"markersReference",void 0),n()(this,"compileTimeout",void 0),n()(this,"allowSubmitCodeAction",void 0),n()(this,"fullscreen",()=>{const e=this.props.toggleFullScreen;e&&(this.$wrapper.codeshell("saveLangCode"),e(!0))}),n()(this,"restoreFullscreen",()=>{const e=this.props.toggleFullScreen,t=this.state.isInFocus;if(!e||t)return;const o=m()(this.refs.codeshellWrapper);this.$wrapper.codeshell("saveLangCode"),e(!1),setTimeout(()=>{m()(window).scrollTop(o.offset().top-50)},0)}),n()(this,"deleteMarkersOnSource",()=>{const e=this.markersReference;if(!e.length)return;const t=m()(this.refs.codeshellWrapper).codeshell("getEditor");e.forEach(e=>{t.removeLineWidget(e)}),t.refresh(),this.markersReference=[]}),n()(this,"onInputChange",(e,t)=>{"languageSelect"===e?this.setState({selectedLanguage:t.target.value}):"fileSelect"===e&&this.setState({selectedFile:t.target.files[0]})}),n()(this,"uploadSolution",()=>{const e=this.state,t=e.selectedLanguage,o=e.selectedFile;if(!o)return;const s=new FormData,i=m()(this.refs.codeshellWrapper);s.append("language",t||"auto-detect"),s.append("source_file",o),s.append("is_file_upload","1"),s.append("current_language",i.codeshell("getOptions").language),this.setState({uploadingSolution:!0,isUploadConfirmOpen:!1}),Object(w.h)({url:Object(N.e)("uploadCode"),data:s,success:e=>{if(this.setState({uploadingSolution:!1}),e.ok){const t=e.data,o=t.language,s=t.source;i.codeshell("getOptions").lang_display_mapping[o]?(i.codeshell("forkNewBuffer",{language:o,code:s}),this.setState({isUploadModalOpen:!1})):this.setState({uploadErr:"Language not supported for this challenge"})}else this.setState({uploadErr:e.message})}})}),n()(this,"toggleConfirmUpload",e=>{const t=e.target.checked;L.b.set("block_upload_file_confirm",t)}),n()(this,"onUploadConfirmClose",()=>{this.setState({isUploadConfirmOpen:!1})}),n()(this,"onUploadModalClose",()=>{this.setState({isUploadModalOpen:!1,selectedFile:void 0,selectedLanguage:"auto-detect"})}),n()(this,"onCompileTestClick",(e,t)=>{const o=this.props.onCompileTest;if(this.setState({submissionMsg:""}),!Object.keys(t).length)return;m()(this.refs.codeshellWrapper).codeshell("getOptions").language&&o(t)}),n()(this,"onSubmitCodeClick",(e,t)=>{const o=this.props,s=o.onSubmitCode,i=o.confirmSubmitCode;this.setState({submissionMsg:""}),!i||!0===L.b.get("confirm_submit_code")||this.allowSubmitCodeAction?(s(t),this.allowSubmitCodeAction=!1):this.setState({isSubmissionDialogOpen:!0})}),n()(this,"onSubmissionDialogClose",()=>{this.setState({isSubmissionDialogOpen:!1})}),n()(this,"onSubmissionConfirm",e=>{this.allowSubmitCodeAction=!0,this.setState({isSubmissionDialogOpen:!1}),this.triggerSubmission(e)}),n()(this,"saveSubmissionChoice",e=>{const t=e.target.checked;L.b.set("confirm_submit_code",t)}),n()(this,"triggerSubmission",e=>{e.preventDefault(),m()(this.refs.codeshellWrapper).find("button.bb-submit").click()}),n()(this,"triggerCompile",e=>{e.preventDefault(),m()(this.refs.codeshellWrapper).find("button.bb-compile").click()}),n()(this,"onAuth",()=>{const e=m()(this.refs.codeshellWrapper),t=this.state.authAction;setTimeout(()=>{"compile"===t?e.find("button.bb-compile").click():"submit"===t&&e.find("button.bb-submit").click()},0)}),n()(this,"onFocus",()=>{this.setState({isInFocus:!0})}),n()(this,"onBlur",()=>{this.setState({isInFocus:!1})}),this.state={submissionMsg:"",loadingEditor:!0,selectedLanguage:"auto-detect",isInFocus:!1},this.markersReference=[],this.allowSubmitCodeAction=!1}componentDidMount(){this.beforeLoadTimestamp=S()().valueOf(),this.loadModules()}componentDidUpdate(e,t){const o=this.props,s=o.compileTestBlocked,i=o.submitBlocked,a=o.errorMarkers,n=this.state.editorInitialized,l=m()(this.refs.codeshellWrapper);t.editorInitialized===n&&e.compileTestBlocked===s||l.find("button.bb-compile").prop("disabled",s),t.editorInitialized===n&&e.submitBlocked===i||l.find("button.bb-submit").prop("disabled",i),t.editorInitialized===n&&e.errorMarkers===a||(a?this.addMarkersOnSource(a):this.deleteMarkersOnSource()),this.manageEditorControlOptions()}componentWillUnmount(){this.$wrapper.codeshell("saveLangCode"),m()(this.refs.codeshellWrapper).off("click.codeshellEvent"),clearTimeout(this.compileTimeout),k.a.unbind(["alt","r"],this.triggerCompile),k.a.unbind(["alt","enter"],this.triggerSubmission),k.a.unbind(["alt","f"],this.fullscreen),k.a.unbind(["esc"],this.restoreFullscreen)}assignPluginEvents(){const e=m()(this.refs.codeshellWrapper);e.on("click.codeshellEvent","a.fullscreen",this.fullscreen),e.on("click.codeshellEvent","a.restorefullscreen",this.restoreFullscreen),e.on("click.codeshellEvent","button.upload_file",()=>{!0===L.b.get("block_upload_file_confirm")?this.setState({isUploadModalOpen:!0}):this.setState({isUploadConfirmOpen:!0})}),e.on("codeshellsubmit.codeshellEvent",this.onSubmitCodeClick),e.on("codeshellcompile.codeshellEvent",this.onCompileTestClick),k.a.bind(["alt","r"],this.triggerCompile),k.a.bind(["alt","enter"],this.triggerSubmission),k.a.bind(["alt","f"],this.fullscreen)}assignTooltips(){const e=m()(this.refs.codeshellWrapper);e.find("button.bb-compile").attr({"data-tip":"Alt/Option + R","data-for":"codeshellTooltip"}),e.find("button.bb-submit").attr({"data-tip":"Alt/Option + Enter","data-for":"codeshellTooltip"}),e.find(".fullscreen i").attr({"data-tip":"Alt/Option + F","data-for":"codeshellTooltip"}),f.a.rebuild()}loadModules(){const e=this.props,t=e.theme,s=(e.appUtil,[]);if("theme-m"===t){const e=new Promise((e,t)=>{(()=>{const s=t;o.e(122).then((t=>{e(o("4jsi").default)}).bind(null,o)).catch(s)})()});s.push(e)}s.push(Object(F.i)(this.props.appUtil)),Promise.all(s).then(()=>{this.setState({loadingEditor:!1},()=>{this.initializeEditor()})})}initializeEditor(){if(this.state.loadingEditor)return;const e=this.props,t=e.submission,o=e.onCodeChange,s=e.editorConfig,a=e.languageTemplate,n=e.disableLineWrapping,l=e.onEditorLoad,r=e.onLangChange,c=this.props.appUtil.assetPath,d={};t&&(d.initialCode=t.code,d.initialLanguage=t.language);const p=m()(this.refs.codeshellWrapper),u=i()({loadmode:(e,t)=>{r(t.lang),Object(y.d)(t.lang,c).finally(()=>{t.callback()})}},s);if(p.codeshell(u,a,d),this.$wrapper=p,n){p.codeshell("getEditor").setOption("lineWrapping",!1)}p.codeshell("onChange",o),this.assignPluginEvents(),this.setState({editorInitialized:!0}),this.afterLoadTimestamp=S()().valueOf();const h=this.afterLoadTimestamp-this.beforeLoadTimestamp;U.a.track("EditorLoadTime","",{attribute1:h,attribute2:"codeshell",attribute3:p.codeshell("getOptions").language}),l(p),this.manageEditorControlOptions()}manageEditorControlOptions(){const e=this.props.isFullScreen,t=m()(this.refs.codeshellWrapper),o=e?".fullscreen":".restorefullscreen",s=e?".restorefullscreen":".fullscreen";t.find(o).addClass("force-hide").removeClass("active-link"),t.find(s).removeClass("force-hide").addClass("active-link"),k.a[e?"bind":"unbind"](["esc"],this.restoreFullscreen)}addMarkersOnSource(e){if(!e)return;const t=m()(this.refs.codeshellWrapper).codeshell("getEditor"),o=t.lineCount(),s=e.markers;this.markersReference=[],s.forEach(e=>{const s=e.message,i=e.line_number;if(i<=o){const e=m()(`<div class="error-marker"><span class="error-marker-icon">!</span>${s}</div>`)[0],o=t.addLineWidget(i-1,e,{above:!0});this.markersReference.push(o)}}),s.length&&t.refresh()}renderUploadForm(){const e=this.state,t=e.uploadingSolution,o=e.uploadErr,s=e.selectedFile;return c.a.createElement("form",{className:"confirm-upload"},c.a.createElement("div",{className:"file-upload-wrapper mlB"},c.a.createElement("label",{className:"file-label"},"Source File"),c.a.createElement(P,{name:"source_file",onChange:this.onInputChange.bind(this,"fileSelect")})),c.a.createElement("div",{className:"file-upload-wrapper"},c.a.createElement("label",{className:"language-label"},"Language"),c.a.createElement("div",{className:"languages-wrapper"},c.a.createElement("select",{className:"select-language",name:"language",type:"select",onChange:this.onInputChange.bind(this,"languageSelect")},c.a.createElement("option",{value:"auto-detect"},"Auto Detect"),c.a.createElement("option",{value:"current-language"},"Current Language"),Object.keys(y.b).map(e=>c.a.createElement("option",{key:e,value:e},y.b[e]))))),o&&c.a.createElement("p",{className:"form-error"},o),c.a.createElement("div",{className:"clearfix"},c.a.createElement("div",{className:"pull-right"},c.a.createElement(E.d,{disabled:t||!s,onClick:this.uploadSolution,type:"button"},"Upload"))))}renderUploadConfirmForm(){const e=this.props.theme;return c.a.createElement(T.a,{theme:e,title:"Attn: Upload file",className:"codeeditor-modal",open:!0,onConfirm:()=>this.setState({isUploadModalOpen:!0,isUploadConfirmOpen:!1}),onCancel:this.onUploadConfirmClose,onClose:this.onUploadConfirmClose},c.a.createElement("p",null,"Uploading a file will replace the current content in your code editor. Would you like to continue?"),c.a.createElement("form",{className:"confirm-upload-form"},c.a.createElement("label",{className:"confirm-upload-label"},c.a.createElement("input",{type:"checkbox",className:"confirm-upload",onChange:this.toggleConfirmUpload}),"Skip this alert next time")))}renderSubmissionDialog(){const e=this.props.theme;return c.a.createElement(T.a,{theme:e,title:"Confirm Submission",className:"codeeditor-modal",open:!0,onConfirm:this.onSubmissionConfirm,onCancel:this.onSubmissionDialogClose,onClose:this.onSubmissionDialogClose},c.a.createElement("p",null,"Are you sure you want to submit this code?"),c.a.createElement("form",{className:"confirm-upload-form"},c.a.createElement("label",{className:"confirm-upload-label"},c.a.createElement("input",{id:"confirm-submit-checkbox",type:"checkbox",className:"confirm-upload",onChange:this.saveSubmissionChoice}),"Don't ask me again")))}render(){const e=this.props,t=e.className,o=e.theme,s=this.state,i=s.isUploadConfirmOpen,a=s.isUploadModalOpen,n=s.isSubmissionDialogOpen,l=s.submissionMsg,r=s.loadingEditor;return c.a.createElement("div",{className:b()("codeeditor-view",t,{"theme-m-section":"theme-m"===o}),onBlur:this.onBlur,onFocus:this.onFocus},c.a.createElement("div",{ref:"codeshellWrapper",id:"codeshell-wrapper"},r&&c.a.createElement("div",{className:"loading-editor text-center"},c.a.createElement(A.a,null))),c.a.createElement("div",{id:"submission-message"},l),i&&this.renderUploadConfirmForm(),n&&this.renderSubmissionDialog(),a&&c.a.createElement(O.a,{theme:o,title:"Upload Dialog",modalClass:"code-upload-modal",open:!0,onClose:this.onUploadModalClose},this.renderUploadForm()),c.a.createElement(f.a,{id:"codeshellTooltip",effect:"solid"}))}}n()(I,"propTypes",{onCompileTest:p.a.func,onSubmitCode:p.a.func.isRequired,confirmSubmitCode:p.a.bool,disableLineWrapping:p.a.bool,editorConfig:p.a.object.isRequired,languageTemplate:p.a.object,submission:p.a.object,loadingData:p.a.bool,toggleFullScreen:p.a.func,appUtil:p.a.object.isRequired,onCodeChange:p.a.func,compileTestBlocked:p.a.bool,submitBlocked:p.a.bool,errorMarkers:p.a.object,theme:p.a.string,onEditorLoad:p.a.func,onLangChange:p.a.func}),n()(I,"defaultProps",{confirmSubmitCode:!1,languageTemplate:{},onCodeChange:v.J,onEditorLoad:v.J,onLangChange:v.J,theme:"dark"});const x=I;I=Object(j.b)(I);t.default=I;Object(l.d)("codeshell_editor_theme_m.js")}}]);
//# sourceMappingURL=https://hrcdn.net/fcore/assets/sourcemaps/323-c0e1f686.js.map