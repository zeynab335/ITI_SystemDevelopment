!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.CodeMirror=t()}(this,function(){"use strict";var e=navigator.userAgent,t=navigator.platform,u=/gecko\/\d/i.test(e),n=/MSIE \d/.test(e),i=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(e),r=/Edge\/(\d+)/.exec(e),v=n||i||r,y=v&&(n?document.documentMode||6:+(r||i)[1]),f=!r&&/WebKit\//.test(e),i=f&&/Qt\/\d+\.\d+/.test(e),o=!r&&/Chrome\//.test(e),p=/Opera\//.test(e),l=/Apple Computer/.test(navigator.vendor),s=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(e),c=/PhantomJS/.test(e),a=!r&&/AppleWebKit/.test(e)&&/Mobile\/\w+/.test(e),d=/Android/.test(e),h=a||d||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(e),g=a||/Mac/.test(t),m=/\bCrOS\b/.test(e),_=/win/i.test(t),e=p&&e.match(/Version\/(\d*\.\d*)/);(e=e&&Number(e[1]))&&15<=e&&(f=!(p=!1));var x=g&&(i||p&&(null==e||e<12.11)),b=u||v&&9<=y;function k(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}var C,w=function(e,t){var n=e.className,i=k(t).exec(n);i&&(t=n.slice(i.index+i[0].length),e.className=n.slice(0,i.index)+(t?i[1]+t:""))};function S(e){for(var t=e.childNodes.length;0<t;--t)e.removeChild(e.firstChild);return e}function T(e,t){return S(e).appendChild(t)}function L(e,t,n,i){var r=document.createElement(e);if(n&&(r.className=n),i&&(r.style.cssText=i),"string"==typeof t)r.appendChild(document.createTextNode(t));else if(t)for(var o=0;o<t.length;++o)r.appendChild(t[o]);return r}function j(e,t,n,i){i=L(e,t,n,i);return i.setAttribute("role","presentation"),i}function A(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if(11==t.nodeType&&(t=t.host),t==e)return!0}while(t=t.parentNode)}function M(){var t;try{t=document.activeElement}catch(e){t=document.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function O(e,t){var n=e.className;k(t).test(n)||(e.className+=(n?" ":"")+t)}function E(e,t){for(var n=e.split(" "),i=0;i<n.length;i++)n[i]&&!k(n[i]).test(t)&&(t+=" "+n[i]);return t}C=document.createRange?function(e,t,n,i){var r=document.createRange();return r.setEnd(i||e,n),r.setStart(e,t),r}:function(e,t,n){var i=document.body.createTextRange();try{i.moveToElementText(e.parentNode)}catch(e){return i}return i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i};var N=function(e){e.select()};function P(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function F(e,t,n){for(var i in t=t||{},e)!e.hasOwnProperty(i)||!1===n&&t.hasOwnProperty(i)||(t[i]=e[i]);return t}function D(e,t,n,i,r){null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length);for(var o=i||0,s=r||0;;){var a=e.indexOf("\t",o);if(a<0||t<=a)return s+(t-o);s+=a-o,s+=n-s%n,o=a+1}}a?N=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:v&&(N=function(e){try{e.select()}catch(e){}});var I=function(){this.id=null};function R(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}I.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var H=30,B={toString:function(){return"CodeMirror.Pass"}},W={scroll:!1},K={origin:"*mouse"},U={origin:"+move"};function z(e,t,n){for(var i=0,r=0;;){var o=e.indexOf("\t",i);-1==o&&(o=e.length);var s=o-i;if(o==e.length||t<=r+s)return i+Math.min(s,t-r);if(r+=o-i,i=o+1,t<=(r+=n-r%n))return i}}var V=[""];function q(e){for(;V.length<=e;)V.push(G(V)+" ");return V[e]}function G(e){return e[e.length-1]}function $(e,t){for(var n=[],i=0;i<e.length;i++)n[i]=t(e[i],i);return n}function X(){}function J(e,t){e=Object.create?Object.create(e):(X.prototype=e,new X);return t&&F(t,e),e}var Y=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function Q(e){return/\w/.test(e)||""<e&&(e.toUpperCase()!=e.toLowerCase()||Y.test(e))}function Z(e,t){return t?!!(-1<t.source.indexOf("\\w")&&Q(e))||t.test(e):Q(e)}function ee(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return;return 1}var te=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function ne(e){return 768<=e.charCodeAt(0)&&te.test(e)}function ie(e,t,n){for(;(n<0?0<t:t<e.length)&&ne(e.charAt(t));)t+=n;return t}function re(e,t,n){for(var i=n<t?-1:1;;){if(t==n)return t;var r=(t+n)/2,r=i<0?Math.ceil(r):Math.floor(r);if(r==t)return e(r)?t:n;e(r)?n=r:t=r+i}}var oe=null;function se(e,t,n){var i;oe=null;for(var r=0;r<e.length;++r){var o=e[r];if(o.from<t&&o.to>t)return r;o.to==t&&(o.from!=o.to&&"before"==n?i=r:oe=r),o.from==t&&(o.from!=o.to&&"before"!=n?i=r:oe=r)}return null!=i?i:oe}var ae,le,ce,de,he,ue,fe,pe=(ae="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",le="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111",ce=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,de=/[stwN]/,he=/[LRr]/,ue=/[Lb1n]/,fe=/[1n]/,function(e,t){var n="ltr"==t?"L":"R";if(0==e.length||"ltr"==t&&!ce.test(e))return!1;for(var i,r=e.length,o=[],s=0;s<r;++s)o.push((i=e.charCodeAt(s))<=247?ae.charAt(i):1424<=i&&i<=1524?"R":1536<=i&&i<=1785?le.charAt(i-1536):1774<=i&&i<=2220?"r":8192<=i&&i<=8203?"w":8204==i?"b":"L");for(var a=0,l=n;a<r;++a){var c=o[a];"m"==c?o[a]=l:l=c}for(var d=0,h=n;d<r;++d){var u=o[d];"1"==u&&"r"==h?o[d]="n":he.test(u)&&"r"==(h=u)&&(o[d]="R")}for(var f=1,p=o[0];f<r-1;++f){var g=o[f];"+"==g&&"1"==p&&"1"==o[f+1]?o[f]="1":","!=g||p!=o[f+1]||"1"!=p&&"n"!=p||(o[f]=p),p=g}for(var m=0;m<r;++m){var v=o[m];if(","==v)o[m]="N";else if("%"==v){for(var y=void 0,y=m+1;y<r&&"%"==o[y];++y);for(var _=m&&"!"==o[m-1]||y<r&&"1"==o[y]?"1":"N",x=m;x<y;++x)o[x]=_;m=y-1}}for(var b=0,k=n;b<r;++b){var C=o[b];"L"==k&&"1"==C?o[b]="L":he.test(C)&&(k=C)}for(var w=0;w<r;++w)if(de.test(o[w])){for(var S=void 0,S=w+1;S<r&&de.test(o[S]);++S);for(var T="L"==(w?o[w-1]:n),L=T==("L"==(S<r?o[S]:n))?T?"L":"R":n,j=w;j<S;++j)o[j]=L;w=S-1}for(var A,M=[],O=0;O<r;)if(ue.test(o[O])){var E=O;for(++O;O<r&&ue.test(o[O]);++O);M.push(new ge(0,E,O))}else{var N=O,P=M.length;for(++O;O<r&&"L"!=o[O];++O);for(var F=N;F<O;)if(fe.test(o[F])){N<F&&M.splice(P,0,new ge(1,N,F));var D=F;for(++F;F<O&&fe.test(o[F]);++F);M.splice(P,0,new ge(2,D,F)),N=F}else++F;N<O&&M.splice(P,0,new ge(1,N,O))}return"ltr"==t&&(1==M[0].level&&(A=e.match(/^\s+/))&&(M[0].from=A[0].length,M.unshift(new ge(0,0,A[0].length))),1==G(M).level&&(A=e.match(/\s+$/))&&(G(M).to-=A[0].length,M.push(new ge(0,r-A[0].length,r)))),"rtl"==t?M.reverse():M});function ge(e,t,n){this.level=e,this.from=t,this.to=n}function me(e,t){var n=e.order;return null==n&&(n=e.order=pe(e.text,t)),n}var ve=[],ye=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):(e=e._handlers||(e._handlers={}))[t]=(e[t]||ve).concat(n)};function _e(e,t){return e._handlers&&e._handlers[t]||ve}function xe(e,t,n){var i;e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent?e.detachEvent("on"+t,n):!(e=(i=e._handlers)&&i[t])||-1<(n=R(e,n))&&(i[t]=e.slice(0,n).concat(e.slice(n+1)))}function be(e,t){var n=_e(e,t);if(n.length)for(var i=Array.prototype.slice.call(arguments,2),r=0;r<n.length;++r)n[r].apply(null,i)}function ke(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),be(e,n||t.type,e,t),je(t)||t.codemirrorIgnore}function Ce(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),i=0;i<t.length;++i)-1==R(n,t[i])&&n.push(t[i])}function we(e,t){return 0<_e(e,t).length}function Se(e){e.prototype.on=function(e,t){ye(this,e,t)},e.prototype.off=function(e,t){xe(this,e,t)}}function Te(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Le(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function je(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function Ae(e){Te(e),Le(e)}function Me(e){return e.target||e.srcElement}function Oe(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),g&&e.ctrlKey&&1==t&&(t=3),t}var Ee,Ne,Pe=function(){if(v&&y<9)return!1;var e=L("div");return"draggable"in e||"dragDrop"in e}();var Fe=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],i=e.length;t<=i;){var r=e.indexOf("\n",t);-1==r&&(r=e.length);var o=e.slice(t,"\r"==e.charAt(r-1)?r-1:r),s=o.indexOf("\r");-1!=s?(n.push(o.slice(0,s)),t+=s+1):(n.push(o),t=r+1)}return n}:function(e){return e.split(/\r\n?|\n/)},De=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},Ie="oncopy"in(i=L("div"))||(i.setAttribute("oncopy","return;"),"function"==typeof i.oncopy),Re=null;var He={},Be={};function We(e){if("string"==typeof e&&Be.hasOwnProperty(e))e=Be[e];else if(e&&"string"==typeof e.name&&Be.hasOwnProperty(e.name)){var t=Be[e.name];"string"==typeof t&&(t={name:t}),(e=J(t,e)).name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return We("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return We("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function Ke(e,t){t=We(t);var n=He[t.name];if(!n)return Ke(e,"text/plain");var i=n(e,t);if(Ue.hasOwnProperty(t.name)){var r,o=Ue[t.name];for(r in o)o.hasOwnProperty(r)&&(i.hasOwnProperty(r)&&(i["_"+r]=i[r]),i[r]=o[r])}if(i.name=t.name,t.helperType&&(i.helperType=t.helperType),t.modeProps)for(var s in t.modeProps)i[s]=t.modeProps[s];return i}var Ue={};function ze(e,t){F(t,Ue.hasOwnProperty(e)?Ue[e]:Ue[e]={})}function Ve(e,t){if(!0===t)return t;if(e.copyState)return e.copyState(t);var n,i={};for(n in t){var r=t[n];r instanceof Array&&(r=r.concat([])),i[n]=r}return i}function qe(e,t){for(var n;e.innerMode&&(n=e.innerMode(t))&&n.mode!=e;)t=n.state,e=n.mode;return n||{mode:e,state:t}}function Ge(e,t,n){return!e.startState||e.startState(t,n)}var $e=function(e,t,n){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=n};function Xe(e,t){if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var i=0;;++i){var r=n.children[i],o=r.chunkSize();if(t<o){n=r;break}t-=o}return n.lines[t]}function Je(e,t,n){var i=[],r=t.line;return e.iter(t.line,n.line+1,function(e){e=e.text;r==n.line&&(e=e.slice(0,n.ch)),r==t.line&&(e=e.slice(t.ch)),i.push(e),++r}),i}function Ye(e,t,n){var i=[];return e.iter(t,n,function(e){i.push(e.text)}),i}function Qe(e,t){var n=t-e.height;if(n)for(var i=e;i;i=i.parent)i.height+=n}function Ze(e){if(null==e.parent)return null;for(var t=e.parent,n=R(t.lines,e),i=t.parent;i;i=(t=i).parent)for(var r=0;i.children[r]!=t;++r)n+=i.children[r].chunkSize();return n+t.first}function et(e,t){var n=e.first;e:do{for(var i=0;i<e.children.length;++i){var r=e.children[i],o=r.height;if(t<o){e=r;continue e}t-=o,n+=r.chunkSize()}return n}while(!e.lines);for(var s=0;s<e.lines.length;++s){var a=e.lines[s].height;if(t<a)break;t-=a}return n+s}function tt(e,t){return t>=e.first&&t<e.first+e.size}function nt(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function it(e,t,n){if(void 0===n&&(n=null),!(this instanceof it))return new it(e,t,n);this.line=e,this.ch=t,this.sticky=n}function rt(e,t){return e.line-t.line||e.ch-t.ch}function ot(e,t){return e.sticky==t.sticky&&0==rt(e,t)}function st(e){return it(e.line,e.ch)}function at(e,t){return rt(e,t)<0?t:e}function lt(e,t){return rt(e,t)<0?e:t}function ct(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function dt(e,t){if(t.line<e.first)return it(e.first,0);var n=e.first+e.size-1;return t.line>n?it(n,Xe(e,n).text.length):(e=Xe(e,(n=t).line).text.length,null==(t=n.ch)||e<t?it(n.line,e):t<0?it(n.line,0):n)}function ht(e,t){for(var n=[],i=0;i<t.length;i++)n[i]=dt(e,t[i]);return n}$e.prototype.eol=function(){return this.pos>=this.string.length},$e.prototype.sol=function(){return this.pos==this.lineStart},$e.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},$e.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},$e.prototype.eat=function(e){var t=this.string.charAt(this.pos),e="string"==typeof e?t==e:t&&(e.test?e.test(t):e(t));if(e)return++this.pos,t},$e.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},$e.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},$e.prototype.skipToEnd=function(){this.pos=this.string.length},$e.prototype.skipTo=function(e){e=this.string.indexOf(e,this.pos);if(-1<e)return this.pos=e,!0},$e.prototype.backUp=function(e){this.pos-=e},$e.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=D(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?D(this.string,this.lineStart,this.tabSize):0)},$e.prototype.indentation=function(){return D(this.string,null,this.tabSize)-(this.lineStart?D(this.string,this.lineStart,this.tabSize):0)},$e.prototype.match=function(e,t,n){if("string"!=typeof e){var i=this.string.slice(this.pos).match(e);return i&&0<i.index?null:(i&&!1!==t&&(this.pos+=i[0].length),i)}i=function(e){return n?e.toLowerCase():e};if(i(this.string.substr(this.pos,e.length))==i(e))return!1!==t&&(this.pos+=e.length),!0},$e.prototype.current=function(){return this.string.slice(this.start,this.pos)},$e.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},$e.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},$e.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)};var ut=function(e,t){this.state=e,this.lookAhead=t},ft=function(e,t,n,i){this.state=t,this.doc=e,this.line=n,this.maxLookAhead=i||0,this.baseTokens=null,this.baseTokenPos=1};function pt(t,n,i,e){var l=[t.state.modeGen],r={};Ct(t,n.text,t.doc.mode,i,function(e,t){return l.push(e,t)},r,e);for(var c=i.state,o=0;o<t.state.overlays.length;++o)!function(e){i.baseTokens=l;var o=t.state.overlays[e],s=1,a=0;i.state=!0,Ct(t,n.text,o.mode,i,function(e,t){for(var n=s;a<e;){var i=l[s];e<i&&l.splice(s,1,e,l[s+1],i),s+=2,a=Math.min(e,i)}if(t)if(o.opaque)l.splice(n,s-n,e,"overlay "+t),s=n+2;else for(;n<s;n+=2){var r=l[n+1];l[n+1]=(r?r+" ":"")+"overlay "+t}},r),i.state=c,i.baseTokens=null,i.baseTokenPos=1}(o);return{styles:l,classes:r.bgClass||r.textClass?r:null}}function gt(e,t,n){var i,r,o;return t.styles&&t.styles[0]==e.state.modeGen||(i=mt(e,Ze(t)),r=t.text.length>e.options.maxHighlightLength&&Ve(e.doc.mode,i.state),o=pt(e,t,i),r&&(i.state=r),t.stateAfter=i.save(!r),t.styles=o.styles,o.classes?t.styleClasses=o.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))),t.styles}function mt(n,i,e){var t=n.doc,r=n.display;if(!t.mode.startState)return new ft(t,!0,i);var o=function(e,t,n){for(var i,r,o=e.doc,s=n?-1:t-(e.doc.mode.innerMode?1e3:100),a=t;s<a;--a){if(a<=o.first)return o.first;var l=Xe(o,a-1),c=l.stateAfter;if(c&&(!n||a+(c instanceof ut?c.lookAhead:0)<=o.modeFrontier))return a;l=D(l.text,null,e.options.tabSize);(null==r||l<i)&&(r=a-1,i=l)}return r}(n,i,e),s=o>t.first&&Xe(t,o-1).stateAfter,a=s?ft.fromSaved(t,s,o):new ft(t,Ge(t.mode),o);return t.iter(o,i,function(e){vt(n,e.text,a);var t=a.line;e.stateAfter=t==i-1||t%5==0||t>=r.viewFrom&&t<r.viewTo?a.save():null,a.nextLine()}),e&&(t.modeFrontier=a.line),a}function vt(e,t,n,i){var r=e.doc.mode,o=new $e(t,e.options.tabSize,n);for(o.start=o.pos=i||0,""==t&&yt(r,n.state);!o.eol();)_t(r,o,n.state),o.start=o.pos}function yt(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){t=qe(e,t);return t.mode.blankLine?t.mode.blankLine(t.state):void 0}}function _t(e,t,n,i){for(var r=0;r<10;r++){i&&(i[0]=qe(e,n).mode);var o=e.token(t,n);if(t.pos>t.start)return o}throw new Error("Mode "+e.name+" failed to advance stream.")}ft.prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},ft.prototype.baseToken=function(e){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;var t=this.baseTokens[this.baseTokenPos+1];return{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},ft.prototype.nextLine=function(){this.line++,0<this.maxLookAhead&&this.maxLookAhead--},ft.fromSaved=function(e,t,n){return t instanceof ut?new ft(e,Ve(e.mode,t.state),n,t.lookAhead):new ft(e,Ve(e.mode,t),n)},ft.prototype.save=function(e){e=!1!==e?Ve(this.doc.mode,this.state):this.state;return 0<this.maxLookAhead?new ut(e,this.maxLookAhead):e};var xt=function(e,t,n){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=n};function bt(e,t,n,i){var r,o,s=e.doc,a=s.mode,l=Xe(s,(t=dt(s,t)).line),c=mt(e,t.line,n),d=new $e(l.text,e.options.tabSize,c);for(i&&(o=[]);(i||d.pos<t.ch)&&!d.eol();)d.start=d.pos,r=_t(a,d,c.state),i&&o.push(new xt(d,r,Ve(s.mode,c.state)));return i?o:new xt(d,r,c.state)}function kt(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var i=n[1]?"bgClass":"textClass";null==t[i]?t[i]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(t[i])||(t[i]+=" "+n[2])}return e}function Ct(e,t,n,i,r,o,s){var a=n.flattenSpans;null==a&&(a=e.options.flattenSpans);var l=0,c=null,d=new $e(t,e.options.tabSize,i),h=e.options.addModeClass&&[null];for(""==t&&kt(yt(n,i.state),o);!d.eol();){var u,f=d.pos>e.options.maxHighlightLength?(a=!1,s&&vt(e,t,i,d.pos),d.pos=t.length,null):kt(_t(n,d,i.state,h),o);if(!h||(u=h[0].name)&&(f="m-"+(f?u+" "+f:u)),!a||c!=f){for(;l<d.start;)r(l=Math.min(d.start,l+5e3),c);c=f}d.start=d.pos}for(;l<d.pos;){var p=Math.min(d.pos,l+5e3);r(p,c),l=p}}var wt=!1,St=!1;function Tt(e,t,n){this.marker=e,this.from=t,this.to=n}function Lt(e,t){if(e)for(var n=0;n<e.length;++n){var i=e[n];if(i.marker==t)return i}}function jt(e,t){if(t.full)return null;var n=tt(e,t.from.line)&&Xe(e,t.from.line).markedSpans,i=tt(e,t.to.line)&&Xe(e,t.to.line).markedSpans;if(!n&&!i)return null;var r=t.from.ch,o=t.to.ch,e=0==rt(t.from,t.to),s=function(e,t,n){var i;if(e)for(var r=0;r<e.length;++r){var o,s=e[r],a=s.marker;!(null==s.from||(a.inclusiveLeft?s.from<=t:s.from<t))&&(s.from!=t||"bookmark"!=a.type||n&&s.marker.insertLeft)||(o=null==s.to||(a.inclusiveRight?s.to>=t:s.to>t),(i=i||[]).push(new Tt(a,s.from,o?null:s.to)))}return i}(n,r,e),a=function(e,t,n){var i;if(e)for(var r=0;r<e.length;++r){var o,s=e[r],a=s.marker;!(null==s.to||(a.inclusiveRight?s.to>=t:s.to>t))&&(s.from!=t||"bookmark"!=a.type||n&&!s.marker.insertLeft)||(o=null==s.from||(a.inclusiveLeft?s.from<=t:s.from<t),(i=i||[]).push(new Tt(a,o?null:s.from-t,null==s.to?null:s.to-t)))}return i}(i,o,e),l=1==t.text.length,c=G(t.text).length+(l?r:0);if(s)for(var d=0;d<s.length;++d){var h,u=s[d];null==u.to&&((h=Lt(a,u.marker))?l&&(u.to=null==h.to?null:h.to+c):u.to=r)}if(a)for(var f=0;f<a.length;++f){var p=a[f];null!=p.to&&(p.to+=c),null==p.from?Lt(s,p.marker)||(p.from=c,l&&(s=s||[]).push(p)):(p.from+=c,l&&(s=s||[]).push(p))}s=s&&At(s),a&&a!=s&&(a=At(a));var g=[s];if(!l){var m,v=t.text.length-2;if(0<v&&s)for(var y=0;y<s.length;++y)null==s[y].to&&(m=m||[]).push(new Tt(s[y].marker,null,null));for(var _=0;_<v;++_)g.push(m);g.push(a)}return g}function At(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&!1!==n.marker.clearWhenEmpty&&e.splice(t--,1)}return e.length?e:null}function Mt(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function Ot(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function Et(e){return e.inclusiveLeft?-1:0}function Nt(e){return e.inclusiveRight?1:0}function Pt(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var i=e.find(),r=t.find(),n=rt(i.from,r.from)||Et(e)-Et(t);if(n)return-n;r=rt(i.to,r.to)||Nt(e)-Nt(t);return r||t.id-e.id}function Ft(e,t){var n,i=St&&e.markedSpans;if(i)for(var r,o=0;o<i.length;++o)(r=i[o]).marker.collapsed&&null==(t?r.from:r.to)&&(!n||Pt(n,r.marker)<0)&&(n=r.marker);return n}function Dt(e){return Ft(e,!0)}function It(e){return Ft(e,!1)}function Rt(e,t,n,i,r){var t=Xe(e,t),o=St&&t.markedSpans;if(o)for(var s=0;s<o.length;++s){var a=o[s];if(a.marker.collapsed){var l=a.marker.find(0),c=rt(l.from,n)||Et(a.marker)-Et(r),d=rt(l.to,i)||Nt(a.marker)-Nt(r);if(!(0<=c&&d<=0||c<=0&&0<=d)&&(c<=0&&(a.marker.inclusiveRight&&r.inclusiveLeft?0<=rt(l.to,n):0<rt(l.to,n))||0<=c&&(a.marker.inclusiveRight&&r.inclusiveLeft?rt(l.from,i)<=0:rt(l.from,i)<0)))return 1}}}function Ht(e){for(var t;t=Dt(e);)e=t.find(-1,!0).line;return e}function Bt(e,t){var n=Xe(e,t),e=Ht(n);return n==e?t:Ze(e)}function Wt(e,t){if(t>e.lastLine())return t;var n,i=Xe(e,t);if(!Kt(e,i))return t;for(;n=It(i);)i=n.find(1,!0).line;return Ze(i)+1}function Kt(e,t){var n=St&&t.markedSpans;if(n)for(var i,r=0;r<n.length;++r)if((i=n[r]).marker.collapsed){if(null==i.from)return!0;if(!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&function e(t,n,i){if(null==i.to){var r=i.marker.find(1,!0);return e(t,r.line,Lt(r.line.markedSpans,i.marker))}if(i.marker.inclusiveRight&&i.to==n.text.length)return!0;for(var o=void 0,s=0;s<n.markedSpans.length;++s)if((o=n.markedSpans[s]).marker.collapsed&&!o.marker.widgetNode&&o.from==i.to&&(null==o.to||o.to!=i.from)&&(o.marker.inclusiveLeft||i.marker.inclusiveRight)&&e(t,n,o))return!0}(e,t,i))return!0}}function Ut(e){for(var t=0,n=(e=Ht(e)).parent,i=0;i<n.lines.length;++i){var r=n.lines[i];if(r==e)break;t+=r.height}for(var o=n.parent;o;o=(n=o).parent)for(var s=0;s<o.children.length;++s){var a=o.children[s];if(a==n)break;t+=a.height}return t}function zt(e){if(0==e.height)return 0;for(var t,n=e.text.length,i=e;t=Dt(i);){var r=t.find(0,!0),i=r.from.line;n+=r.from.ch-r.to.ch}for(i=e;t=It(i);){var o=t.find(0,!0);n-=i.text.length-o.from.ch,n+=(i=o.to.line).text.length-o.to.ch}return n}function Vt(e){var n=e.display,e=e.doc;n.maxLine=Xe(e,e.first),n.maxLineLength=zt(n.maxLine),n.maxLineChanged=!0,e.iter(function(e){var t=zt(e);t>n.maxLineLength&&(n.maxLineLength=t,n.maxLine=e)})}var qt=function(e,t,n){this.text=e,Ot(this,t),this.height=n?n(this):1};qt.prototype.lineNo=function(){return Ze(this)},Se(qt);var Gt={},$t={};function Xt(e,t){if(!e||/^\s*$/.test(e))return null;t=t.addModeClass?$t:Gt;return t[e]||(t[e]=e.replace(/\S+/g,"cm-$&"))}function Jt(e,t){var n=j("span",null,null,f?"padding-right: .1px":null),i={pre:j("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:e.getOption("lineWrapping")};t.measure={};for(var r=0;r<=(t.rest?t.rest.length:0);r++){var o=r?t.rest[r-1]:t.line,s=void 0;i.pos=0,i.addToken=Qt,function(e){if(null!=Ne)return Ne;var t=T(e,document.createTextNode("AخA")),n=C(t,0,1).getBoundingClientRect(),t=C(t,1,2).getBoundingClientRect();return S(e),n&&n.left!=n.right&&(Ne=t.right-n.right<3)}(e.display.measure)&&(s=me(o,e.doc.direction))&&(i.addToken=function(h,u){return function(e,t,n,i,r,o,s){n=n?n+" cm-force-border":"cm-force-border";for(var a=e.pos,l=a+t.length;;){for(var c=void 0,d=0;d<u.length&&!((c=u[d]).to>a&&c.from<=a);d++);if(c.to>=l)return h(e,t,n,i,r,o,s);h(e,t.slice(0,c.to-a),n,i,null,o,s),i=null,t=t.slice(c.to-a),a=c.to}}}(i.addToken,s)),i.map=[],function(e,t,n){var i=e.markedSpans,r=e.text,o=0;if(!i){for(var s=1;s<n.length;s+=2)t.addToken(t,r.slice(o,o=n[s]),Xt(n[s+1],t.cm.options));return}for(var a,l,c,d,h,u,f,p=r.length,g=0,m=1,v="",y=0;;){if(y==g){c=d=h=l="",u=f=null,y=1/0;for(var _=[],x=void 0,b=0;b<i.length;++b){var k=i[b],C=k.marker;if("bookmark"==C.type&&k.from==g&&C.widgetNode)_.push(C);else if(k.from<=g&&(null==k.to||k.to>g||C.collapsed&&k.to==g&&k.from==g)){if(null!=k.to&&k.to!=g&&y>k.to&&(y=k.to,d=""),C.className&&(c+=" "+C.className),C.css&&(l=(l?l+";":"")+C.css),C.startStyle&&k.from==g&&(h+=" "+C.startStyle),C.endStyle&&k.to==y&&(x=x||[]).push(C.endStyle,k.to),C.title&&((f=f||{}).title=C.title),C.attributes)for(var w in C.attributes)(f=f||{})[w]=C.attributes[w];C.collapsed&&(!u||Pt(u.marker,C)<0)&&(u=k)}else k.from>g&&y>k.from&&(y=k.from)}if(x)for(var S=0;S<x.length;S+=2)x[S+1]==y&&(d+=" "+x[S]);if(!u||u.from==g)for(var T=0;T<_.length;++T)Zt(t,0,_[T]);if(u&&(u.from||0)==g){if(Zt(t,(null==u.to?p+1:u.to)-g,u.marker,null==u.from),null==u.to)return;u.to==g&&(u=!1)}}if(p<=g)break;for(var L=Math.min(p,y);;){if(v){var j,A=g+v.length;if(u||(j=L<A?v.slice(0,L-g):v,t.addToken(t,j,a?a+c:c,h,g+j.length==y?d:"",l,f)),L<=A){v=v.slice(L-g),g=L;break}g=A,h=""}v=r.slice(o,o=n[m++]),a=Xt(n[m++],t.cm.options)}}}(o,i,gt(e,o,t!=e.display.externalMeasured&&Ze(o))),o.styleClasses&&(o.styleClasses.bgClass&&(i.bgClass=E(o.styleClasses.bgClass,i.bgClass||"")),o.styleClasses.textClass&&(i.textClass=E(o.styleClasses.textClass,i.textClass||""))),0==i.map.length&&i.map.push(0,0,i.content.appendChild(function(e){null==Ee&&(t=L("span","​"),T(e,L("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Ee=t.offsetWidth<=1&&2<t.offsetHeight&&!(v&&y<8)));var t=Ee?L("span","​"):L("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return t.setAttribute("cm-text",""),t}(e.display.measure))),0==r?(t.measure.map=i.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(i.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return f&&(n=i.content.lastChild,(/\bcm-tab\b/.test(n.className)||n.querySelector&&n.querySelector(".cm-tab"))&&(i.content.className="cm-tab-wrap-hack")),be(e,"renderLine",e,t.line,i.pre),i.pre.className&&(i.textClass=E(i.pre.className,i.textClass||"")),i}function Yt(e){var t=L("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function Qt(e,t,n,i,r,o,s){if(t){var a,l=e.splitSpaces?function(e,t){if(1<e.length&&!/  /.test(e))return e;for(var n=t,i="",r=0;r<e.length;r++){var o=e.charAt(r);" "!=o||!n||r!=e.length-1&&32!=e.charCodeAt(r+1)||(o=" "),i+=o,n=" "==o}return i}(t,e.trailingSpace):t,c=e.cm.state.specialChars,d=!1;if(c.test(t)){a=document.createDocumentFragment();for(var h=0;;){c.lastIndex=h;var u=c.exec(t),f=u?u.index-h:t.length-h;if(f&&(p=document.createTextNode(l.slice(h,h+f)),v&&y<9?a.appendChild(L("span",[p])):a.appendChild(p),e.map.push(e.pos,e.pos+f,p),e.col+=f,e.pos+=f),!u)break;h+=1+f;var p=void 0;"\t"==u[0]?(f=(f=e.cm.options.tabSize)-e.col%f,(p=a.appendChild(L("span",q(f),"cm-tab"))).setAttribute("role","presentation"),p.setAttribute("cm-text","\t"),e.col+=f):("\r"==u[0]||"\n"==u[0]?(p=a.appendChild(L("span","\r"==u[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",u[0]):((p=e.cm.options.specialCharPlaceholder(u[0])).setAttribute("cm-text",u[0]),v&&y<9?a.appendChild(L("span",[p])):a.appendChild(p)),e.col+=1),e.map.push(e.pos,e.pos+1,p),e.pos++}}else e.col+=t.length,a=document.createTextNode(l),e.map.push(e.pos,e.pos+t.length,a),v&&y<9&&(d=!0),e.pos+=t.length;if(e.trailingSpace=32==l.charCodeAt(t.length-1),n||i||r||d||o){n=n||"";i&&(n+=i),r&&(n+=r);var g=L("span",[a],n,o);if(s)for(var m in s)s.hasOwnProperty(m)&&"style"!=m&&"class"!=m&&g.setAttribute(m,s[m]);return e.content.appendChild(g)}e.content.appendChild(a)}}function Zt(e,t,n,i){var r=!i&&n.widgetNode;r&&e.map.push(e.pos,e.pos+t,r),!i&&e.cm.display.input.needsContentAttribute&&(r=r||e.content.appendChild(document.createElement("span"))).setAttribute("cm-marker",n.id),r&&(e.cm.display.input.setUneditable(r),e.content.appendChild(r)),e.pos+=t,e.trailingSpace=!1}function en(e,t,n){this.line=t,this.rest=function(e){for(var t,n;t=It(e);)e=t.find(1,!0).line,(n=n||[]).push(e);return n}(t),this.size=this.rest?Ze(G(this.rest))-n+1:1,this.node=this.text=null,this.hidden=Kt(e,t)}function tn(e,t,n){for(var i=[],r=t;r<n;r=s){var o=new en(e.doc,Xe(e.doc,r),r),s=r+o.size;i.push(o)}return i}var nn=null;function rn(e,t){var n=e.ownsGroup;if(n)try{!function(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n].call(null);for(var i=0;i<e.ops.length;i++){var r=e.ops[i];if(r.cursorActivityHandlers)for(;r.cursorActivityCalled<r.cursorActivityHandlers.length;)r.cursorActivityHandlers[r.cursorActivityCalled++].call(null,r.cm)}}while(n<t.length)}(n)}finally{nn=null,t(n)}}var on=null;function sn(e,t){var n=_e(e,t);if(n.length){var i,r=Array.prototype.slice.call(arguments,2);nn?i=nn.delayedCallbacks:on?i=on:(i=on=[],setTimeout(an,0));for(var o=0;o<n.length;++o)!function(e){i.push(function(){return n[e].apply(null,r)})}(o)}}function an(){var e=on;on=null;for(var t=0;t<e.length;++t)e[t]()}function ln(e,t,n,i){for(var r=0;r<t.changes.length;r++){var o=t.changes[r];"text"==o?function(e,t){var n=t.text.className,i=dn(e,t);t.text==t.node&&(t.node=i.pre);t.text.parentNode.replaceChild(i.pre,t.text),t.text=i.pre,i.bgClass!=t.bgClass||i.textClass!=t.textClass?(t.bgClass=i.bgClass,t.textClass=i.textClass,hn(e,t)):n&&(t.text.className=n)}(e,t):"gutter"==o?un(e,t,n,i):"class"==o?hn(e,t):"widget"==o&&function(e,t,n){t.alignable&&(t.alignable=null);for(var i=t.node.firstChild,r=void 0;i;i=r)r=i.nextSibling,"CodeMirror-linewidget"==i.className&&t.node.removeChild(i);fn(e,t,n)}(e,t,i)}t.changes=null}function cn(e){return e.node==e.text&&(e.node=L("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),v&&y<8&&(e.node.style.zIndex=2)),e.node}function dn(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):Jt(e,t)}function hn(e,t){var n,i;n=e,(i=(r=t).bgClass?r.bgClass+" "+(r.line.bgClass||""):r.line.bgClass)&&(i+=" CodeMirror-linebackground"),r.background?i?r.background.className=i:(r.background.parentNode.removeChild(r.background),r.background=null):i&&(e=cn(r),r.background=e.insertBefore(L("div",null,i),e.firstChild),n.display.input.setUneditable(r.background)),t.line.wrapClass?cn(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var r=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=r||""}function un(e,t,n,i){t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass&&(o=cn(t),t.gutterBackground=L("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px; width: "+i.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),o.insertBefore(t.gutterBackground,t.text));var r=t.line.gutterMarkers;if(e.options.lineNumbers||r){var o=cn(t),s=t.gutter=L("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px");if(e.display.input.setUneditable(s),o.insertBefore(s,t.text),t.line.gutterClass&&(s.className+=" "+t.line.gutterClass),!e.options.lineNumbers||r&&r["CodeMirror-linenumbers"]||(t.lineNumber=s.appendChild(L("div",nt(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+i.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),r)for(var a=0;a<e.display.gutterSpecs.length;++a){var l=e.display.gutterSpecs[a].className,c=r.hasOwnProperty(l)&&r[l];c&&s.appendChild(L("div",[c],"CodeMirror-gutter-elt","left: "+i.gutterLeft[l]+"px; width: "+i.gutterWidth[l]+"px"))}}}function fn(e,t,n){if(pn(e,t.line,t,n,!0),t.rest)for(var i=0;i<t.rest.length;i++)pn(e,t.rest[i],t,n,!1)}function pn(e,t,n,i,r){if(t.widgets)for(var o=cn(n),s=0,a=t.widgets;s<a.length;++s){var l=a[s],c=L("div",[l.node],"CodeMirror-linewidget");l.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),function(e,t,n,i){e.noHScroll&&((n.alignable||(n.alignable=[])).push(t),n=i.wrapperWidth,t.style.left=i.fixedPos+"px",e.coverGutter||(n-=i.gutterTotalWidth,t.style.paddingLeft=i.gutterTotalWidth+"px"),t.style.width=n+"px");e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-i.gutterTotalWidth+"px"))}(l,c,n,i),e.display.input.setUneditable(c),r&&l.above?o.insertBefore(c,n.gutter||n.text):o.appendChild(c),sn(l,"redraw")}}function gn(e){if(null!=e.height)return e.height;var t,n=e.doc.cm;return n?(A(document.body,e.node)||(t="position: relative;",e.coverGutter&&(t+="margin-left: -"+n.display.gutters.offsetWidth+"px;"),e.noHScroll&&(t+="width: "+n.display.wrapper.clientWidth+"px;"),T(n.display.measure,L("div",[e.node],null,t))),e.height=e.node.parentNode.offsetHeight):0}function mn(e,t){for(var n=Me(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return 1}function vn(e){return e.lineSpace.offsetTop}function yn(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function _n(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=T(e.measure,L("pre","x")),t=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,t={left:parseInt(t.paddingLeft),right:parseInt(t.paddingRight)};return isNaN(t.left)||isNaN(t.right)||(e.cachedPaddingH=t),t}function xn(e){return H-e.display.nativeBarWidth}function bn(e){return e.display.scroller.clientWidth-xn(e)-e.display.barWidth}function kn(e){return e.display.scroller.clientHeight-xn(e)-e.display.barHeight}function Cn(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var i=0;i<e.rest.length;i++)if(e.rest[i]==t)return{map:e.measure.maps[i],cache:e.measure.caches[i]};for(var r=0;r<e.rest.length;r++)if(Ze(e.rest[r])>n)return{map:e.measure.maps[r],cache:e.measure.caches[r],before:!0}}function wn(e,t,n,i){return Ln(e,Tn(e,t),n,i)}function Sn(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[ei(e,t)];e=e.display.externalMeasured;return e&&t>=e.lineN&&t<e.lineN+e.size?e:void 0}function Tn(e,t){var n,i,r=Ze(t),o=Sn(e,r);o&&!o.text?o=null:o&&o.changes&&(ln(e,o,r,Xn(e)),e.curOp.forceUpdate=!0),o||(n=e,e=Ze(i=Ht(i=t)),(i=n.display.externalMeasured=new en(n.doc,i,e)).lineN=e,e=i.built=Jt(n,i),i.text=e.pre,T(n.display.lineMeasure,e.pre),o=i);r=Cn(o,t,r);return{line:t,view:o,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function Ln(e,t,n,i,r){t.before&&(n=-1);var o,s=n+(i||"");return t.cache.hasOwnProperty(s)?o=t.cache[s]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(function(e,t,n){var i=e.options.lineWrapping,e=i&&bn(e);if(!t.measure.heights||i&&t.measure.width!=e){var r=t.measure.heights=[];if(i){t.measure.width=e;for(var o=t.text.firstChild.getClientRects(),s=0;s<o.length-1;s++){var a=o[s],l=o[s+1];2<Math.abs(a.bottom-l.bottom)&&r.push((a.bottom+l.top)/2-n.top)}}r.push(n.bottom-n.top)}}(e,t.view,t.rect),t.hasHeights=!0),(o=function(e,t,n,i){var r,o=Mn(t.map,n,i),s=o.node,a=o.start,l=o.end,c=o.collapse;if(3==s.nodeType){for(var d=0;d<4;d++){for(;a&&ne(t.line.text.charAt(o.coverStart+a));)--a;for(;o.coverStart+l<o.coverEnd&&ne(t.line.text.charAt(o.coverStart+l));)++l;if((r=v&&y<9&&0==a&&l==o.coverEnd-o.coverStart?s.parentNode.getBoundingClientRect():function(e,t){var n=An;if("left"==t)for(var i=0;i<e.length&&(n=e[i]).left==n.right;i++);else for(var r=e.length-1;0<=r&&(n=e[r]).left==n.right;r--);return n}(C(s,a,l).getClientRects(),i)).left||r.right||0==a)break;l=a,--a,c="right"}v&&y<11&&(r=function(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function(e){if(null!=Re)return Re;var e=(t=T(e,L("span","x"))).getBoundingClientRect(),t=C(t,0,1).getBoundingClientRect();return Re=1<Math.abs(e.left-t.left)}(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,e=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*e,bottom:t.bottom*e}}(e.display.measure,r))}else 0<a&&(c=i="right"),r=e.options.lineWrapping&&1<(g=s.getClientRects()).length?g["right"==i?g.length-1:0]:s.getBoundingClientRect();!(v&&y<9)||a||r&&(r.left||r.right)||(m=s.parentNode.getClientRects()[0],r=m?{left:m.left,right:m.left+$n(e.display),top:m.top,bottom:m.bottom}:An);for(var h=r.top-t.rect.top,n=r.bottom-t.rect.top,u=(h+n)/2,f=t.view.measure.heights,p=0;p<f.length-1&&!(u<f[p]);p++);var g=p?f[p-1]:0,m=f[p],m={left:("right"==c?r.right:r.left)-t.rect.left,right:("left"==c?r.left:r.right)-t.rect.left,top:g,bottom:m};r.left||r.right||(m.bogus=!0);e.options.singleCursorHeightPerLine||(m.rtop=h,m.rbottom=n);return m}(e,t,n,i)).bogus||(t.cache[s]=o)),{left:o.left,right:o.right,top:r?o.rtop:o.top,bottom:r?o.rbottom:o.bottom}}var jn,An={left:0,right:0,top:0,bottom:0};function Mn(e,t,n){for(var i,r,o,s,a,l,c=0;c<e.length;c+=3)if(a=e[c],l=e[c+1],t<a?(r=0,o=1,s="left"):t<l?o=(r=t-a)+1:(c==e.length-3||t==l&&e[c+3]>t)&&(r=(o=l-a)-1,l<=t&&(s="right")),null!=r){if(i=e[c+2],a==l&&n==(i.insertLeft?"left":"right")&&(s=n),"left"==n&&0==r)for(;c&&e[c-2]==e[c-3]&&e[c-1].insertLeft;)i=e[2+(c-=3)],s="left";if("right"==n&&r==l-a)for(;c<e.length-3&&e[c+3]==e[c+4]&&!e[c+5].insertLeft;)i=e[(c+=3)+2],s="right";break}return{node:i,start:r,end:o,collapse:s,coverStart:a,coverEnd:l}}function On(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function En(e){e.display.externalMeasure=null,S(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)On(e.display.view[t])}function Nn(e){En(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Pn(){return o&&d?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Fn(){return o&&d?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function Dn(e){var t=0;if(e.widgets)for(var n=0;n<e.widgets.length;++n)e.widgets[n].above&&(t+=gn(e.widgets[n]));return t}function In(e,t,n,i,r){if(r||(r=Dn(t),n.top+=r,n.bottom+=r),"line"==i)return n;i=i||"local";t=Ut(t);return"local"==i?t+=vn(e.display):t-=e.display.viewOffset,"page"!=i&&"window"!=i||(t+=(e=e.display.lineSpace.getBoundingClientRect()).top+("window"==i?0:Fn()),i=e.left+("window"==i?0:Pn()),n.left+=i,n.right+=i),n.top+=t,n.bottom+=t,n}function Rn(e,t,n){if("div"==n)return t;var i=t.left,t=t.top;"page"==n?(i-=Pn(),t-=Fn()):"local"!=n&&n||(i+=(n=e.display.sizer.getBoundingClientRect()).left,t+=n.top);e=e.display.lineSpace.getBoundingClientRect();return{left:i-e.left,top:t-e.top}}function Hn(e,t,n,i,r){return In(e,i=i||Xe(e.doc,t.line),wn(e,i,t.ch,r),n)}function Bn(n,e,i,r,o,s){function a(e,t){e=Ln(n,o,e,t?"right":"left",s);return t?e.left=e.right:e.right=e.left,In(n,r,e,i)}r=r||Xe(n.doc,e.line),o=o||Tn(n,r);var l=me(r,n.doc.direction),t=e.ch,c=e.sticky;if(t>=r.text.length?(t=r.text.length,c="before"):t<=0&&(t=0,c="after"),!l)return a("before"==c?t-1:t,"before"==c);function d(e,t,n){return a(n?e-1:e,1==l[t].level!=n)}var h=se(l,t,c),e=oe,h=d(t,h,"before"==c);return null!=e&&(h.other=d(t,e,"before"!=c)),h}function Wn(e,t){var n=0;t=dt(e.doc,t),e.options.lineWrapping||(n=$n(e.display)*t.ch);t=Xe(e.doc,t.line),e=Ut(t)+vn(e.display);return{left:n,right:n,top:e,bottom:e+t.height}}function Kn(e,t,n,i,r){n=it(e,t,n);return n.xRel=r,i&&(n.outside=!0),n}function Un(e,t,n){var i=e.doc;if((n+=e.display.viewOffset)<0)return Kn(i.first,0,null,!0,-1);var r=et(i,n),o=i.first+i.size-1;if(o<r)return Kn(i.first+i.size-1,Xe(i,o).text.length,null,!0,1);t<0&&(t=0);for(var s=Xe(i,r);;){var a=function(n,e,t,i,r){r-=Ut(e);var o=Tn(n,e),s=Dn(e),a=0,l=e.text.length,c=!0,d=me(e,n.doc.direction);d&&(f=(n.options.lineWrapping?function(e,t,n,i,r,o,s){var s=zn(e,t,i,s),a=s.begin,l=s.end;/\s/.test(t.text.charAt(l-1))&&l--;for(var c=null,d=null,h=0;h<r.length;h++){var u,f=r[h];f.from>=l||f.to<=a||(u=1!=f.level,u=Ln(e,i,u?Math.min(l,f.to)-1:Math.max(a,f.from)).right,u=u<o?o-u+1e9:u-o,(!c||u<d)&&(c=f,d=u))}c=c||r[r.length-1];c.from<a&&(c={from:a,to:c.to,level:c.level});c.to>l&&(c={from:c.from,to:l,level:c.level});return c}:function(n,i,r,o,s,a,l){var e=re(function(e){var t=s[e],e=1!=t.level;return qn(Bn(n,it(r,e?t.to:t.from,e?"before":"after"),"line",i,o),a,l,!0)},0,s.length-1),t=s[e];{var c;0<e&&(c=1!=t.level,qn(c=Bn(n,it(r,c?t.from:t.to,c?"after":"before"),"line",i,o),a,l,!0)&&c.top>l&&(t=s[e-1]))}return t})(n,e,t,o,d,i,r),c=1!=f.level,a=c?f.from:f.to-1,l=c?f.to:f.from-1);var h=null,u=null,d=re(function(e){var t=Ln(n,o,e);return t.top+=s,t.bottom+=s,qn(t,i,r,!1)&&(t.top<=r&&t.left<=i&&(h=e,u=t),1)},a,l),f=!1;{var p,g;u?(p=i-u.left<u.right-i,d=h+((g=p==c)?0:1),g=g?"after":"before",p=p?u.left:u.right):(c||d!=l&&d!=a||d++,g=0==d||d!=e.text.length&&Ln(n,o,d-(c?1:0)).bottom+s<=r==c?"after":"before",c=Bn(n,it(t,d,g),"line",e,o),p=c.left,f=r<c.top||r>=c.bottom)}return d=ie(e.text,d,1),Kn(t,d,g,f,i-p)}(e,s,r,t,n),l=function(e,t){var n,i=St&&e.markedSpans;if(i)for(var r=0;r<i.length;++r){var o=i[r];o.marker.collapsed&&(null==o.from||o.from<t)&&(null==o.to||o.to>t)&&(!n||Pt(n,o.marker)<0)&&(n=o.marker)}return n}(s,a.ch+(0<a.xRel?1:0));if(!l)return a;l=l.find(1);if(l.line==r)return l;s=Xe(i,r=l.line)}}function zn(t,e,n,i){i-=Dn(e);var r=e.text.length,e=re(function(e){return Ln(t,n,e-1).bottom<=i},r,0);return{begin:e,end:r=re(function(e){return Ln(t,n,e).top>i},e,r)}}function Vn(e,t,n,i){return zn(e,t,n=n||Tn(e,t),In(e,t,Ln(e,n,i),"line").top)}function qn(e,t,n,i){return!(e.bottom<=n)&&(e.top>n||(i?e.left:e.right)>t)}function Gn(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==jn){jn=L("pre");for(var t=0;t<49;++t)jn.appendChild(document.createTextNode("x")),jn.appendChild(L("br"));jn.appendChild(document.createTextNode("x"))}T(e.measure,jn);var n=jn.offsetHeight/50;return 3<n&&(e.cachedTextHeight=n),S(e.measure),n||1}function $n(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=L("span","xxxxxxxxxx"),n=L("pre",[t]);T(e.measure,n);t=t.getBoundingClientRect(),t=(t.right-t.left)/10;return 2<t&&(e.cachedCharWidth=t),t||10}function Xn(e){for(var t=e.display,n={},i={},r=t.gutters.clientLeft,o=t.gutters.firstChild,s=0;o;o=o.nextSibling,++s){var a=e.display.gutterSpecs[s].className;n[a]=o.offsetLeft+o.clientLeft+r,i[a]=o.clientWidth}return{fixedPos:Jn(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:i,wrapperWidth:t.wrapper.clientWidth}}function Jn(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function Yn(i){var r=Gn(i.display),o=i.options.lineWrapping,s=o&&Math.max(5,i.display.scroller.clientWidth/$n(i.display)-3);return function(e){if(Kt(i.doc,e))return 0;var t=0;if(e.widgets)for(var n=0;n<e.widgets.length;n++)e.widgets[n].height&&(t+=e.widgets[n].height);return o?t+(Math.ceil(e.text.length/s)||1)*r:t+r}}function Qn(e){var t=e.doc,n=Yn(e);t.iter(function(e){var t=n(e);t!=e.height&&Qe(e,t)})}function Zn(e,t,n,i){var r=e.display;if(!n&&"true"==Me(t).getAttribute("cm-not-content"))return null;var o,s,a=r.lineSpace.getBoundingClientRect();try{o=t.clientX-a.left,s=t.clientY-a.top}catch(t){return null}var l,r=Un(e,o,s);return i&&1==r.xRel&&(l=Xe(e.doc,r.line).text).length==r.ch&&(l=D(l,l.length,e.options.tabSize)-l.length,r=it(r.line,Math.max(0,Math.round((o-_n(e.display).left)/$n(e.display))-l))),r}function ei(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var n=e.display.view,i=0;i<n.length;i++)if((t-=n[i].size)<0)return i}function ti(e,t,n,i){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),i=i||0;var r,o,s=e.display;i&&n<s.viewTo&&(null==s.updateLineNumbers||s.updateLineNumbers>t)&&(s.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=s.viewTo?St&&Bt(e.doc,t)<s.viewTo&&ii(e):n<=s.viewFrom?St&&Wt(e.doc,n+i)>s.viewFrom?ii(e):(s.viewFrom+=i,s.viewTo+=i):t<=s.viewFrom&&n>=s.viewTo?ii(e):t<=s.viewFrom?(r=ri(e,n,n+i,1))?(s.view=s.view.slice(r.index),s.viewFrom=r.lineN,s.viewTo+=i):ii(e):n>=s.viewTo?(o=ri(e,t,t,-1))?(s.view=s.view.slice(0,o.index),s.viewTo=o.lineN):ii(e):(r=ri(e,t,t,-1),o=ri(e,n,n+i,1),r&&o?(s.view=s.view.slice(0,r.index).concat(tn(e,r.lineN,o.lineN)).concat(s.view.slice(o.index)),s.viewTo+=i):ii(e));e=s.externalMeasured;e&&(n<e.lineN?e.lineN+=i:t<e.lineN+e.size&&(s.externalMeasured=null))}function ni(e,t,n){e.curOp.viewChanged=!0;var i=e.display,r=e.display.externalMeasured;r&&t>=r.lineN&&t<r.lineN+r.size&&(i.externalMeasured=null),t<i.viewFrom||t>=i.viewTo||(null==(t=i.view[ei(e,t)]).node||-1==R(t=t.changes||(t.changes=[]),n)&&t.push(n))}function ii(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function ri(e,t,n,i){var r,o=ei(e,t),s=e.display.view;if(!St||n==e.doc.first+e.doc.size)return{index:o,lineN:n};for(var a=e.display.viewFrom,l=0;l<o;l++)a+=s[l].size;if(a!=t){if(0<i){if(o==s.length-1)return null;r=a+s[o].size-t,o++}else r=a-t;t+=r,n+=r}for(;Bt(e.doc,n)!=n;){if(o==(i<0?0:s.length-1))return null;n+=i*s[o-(i<0?1:0)].size,o+=i}return{index:o,lineN:n}}function oi(e){for(var t=e.display.view,n=0,i=0;i<t.length;i++){var r=t[i];r.hidden||r.node&&!r.changes||++n}return n}function si(e){e.display.input.showSelection(e.display.input.prepareSelection())}function ai(e,t){void 0===t&&(t=!0);for(var n,i,r=e.doc,o={},s=o.cursors=document.createDocumentFragment(),a=o.selection=document.createDocumentFragment(),l=0;l<r.sel.ranges.length;l++)!t&&l==r.sel.primIndex||((n=r.sel.ranges[l]).from().line>=e.display.viewTo||n.to().line<e.display.viewFrom||(((i=n.empty())||e.options.showCursorWhenSelecting)&&li(e,n.head,s),i||function(r,e,t){var n=r.display,o=r.doc,s=document.createDocumentFragment(),i=_n(r.display),C=i.left,w=Math.max(n.sizerWidth,bn(r)-n.sizer.offsetLeft)-i.right,S="ltr"==o.direction;function T(e,t,n,i){t<0&&(t=0),t=Math.round(t),i=Math.round(i),s.appendChild(L("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==n?w-e:n)+"px;\n                             height: "+(i-t)+"px"))}function a(n,g,m){var v,y,i=Xe(o,n),_=i.text.length;function x(e,t){return Hn(r,it(n,e),"div",i,t)}function b(e,t,n){e=Vn(r,i,null,e),t="ltr"==t==("after"==n)?"left":"right";return x("after"==n?e.begin:e.end-(/\s/.test(i.text.charAt(e.end-1))?2:1),t)[t]}var k=me(i,o.direction);return function(e,t,n,i){if(!e)return i(t,n,"ltr",0);for(var r=!1,o=0;o<e.length;++o){var s=e[o];(s.from<n&&s.to>t||t==n&&s.to==t)&&(i(Math.max(s.from,t),Math.min(s.to,n),1==s.level?"rtl":"ltr",o),r=!0)}r||i(t,n,"ltr")}(k,g||0,null==m?_:m,function(e,t,n,i){var r,o,s,a,l="ltr"==n,c=x(e,l?"left":"right"),d=x(t-1,l?"right":"left"),h=null==g&&0==e,u=null==m&&t==_,f=0==i,p=!k||i==k.length-1;d.top-c.top<=3?(r=(S?u:h)&&p,i=(S?h:u)&&f?C:(l?c:d).left,r=r?w:(l?d:c).right,T(i,c.top,r-i,c.bottom)):(n=l?(o=S&&h&&f?C:c.left,s=S?w:b(e,n,"before"),a=S?C:b(t,n,"after"),S&&u&&p?w:d.right):(o=S?b(e,n,"before"):C,s=!S&&h&&f?w:c.right,a=!S&&u&&p?C:d.left,S?b(t,n,"after"):w),T(o,c.top,s-o,c.bottom),c.bottom<d.top&&T(C,c.bottom,null,d.top),T(a,d.top,n-a,d.bottom)),(!v||ci(c,v)<0)&&(v=c),ci(d,v)<0&&(v=d),(!y||ci(c,y)<0)&&(y=c),ci(d,y)<0&&(y=d)}),{start:v,end:y}}var l=e.from(),n=e.to();l.line==n.line?a(l.line,l.ch,n.ch):(i=Xe(o,l.line),e=Xe(o,n.line),e=Ht(i)==Ht(e),i=a(l.line,l.ch,e?i.text.length+1:null).end,n=a(n.line,e?0:null,n.ch).start,e&&(i.top<n.top-2?(T(i.right,i.top,null,i.bottom),T(C,n.top,n.left,n.bottom)):T(i.right,i.top,n.left-i.right,i.bottom)),i.bottom<n.top&&T(C,i.bottom,null,n.top));t.appendChild(s)}(e,n,a)));return o}function li(e,t,n){var i=Bn(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),t=n.appendChild(L("div"," ","CodeMirror-cursor"));t.style.left=i.left+"px",t.style.top=i.top+"px",t.style.height=Math.max(0,i.bottom-i.top)*e.options.cursorHeight+"px",i.other&&((n=n.appendChild(L("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"))).style.display="",n.style.left=i.other.left+"px",n.style.top=i.other.top+"px",n.style.height=.85*(i.other.bottom-i.other.top)+"px")}function ci(e,t){return e.top-t.top||e.left-t.left}function di(e){var t,n;e.state.focused&&(t=e.display,clearInterval(t.blinker),n=!0,t.cursorDiv.style.visibility="",0<e.options.cursorBlinkRate?t.blinker=setInterval(function(){return t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden"))}function hi(e){e.state.focused||(e.display.input.focus(),fi(e))}function ui(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,pi(e))},100)}function fi(e,t){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(be(e,"focus",e,t),e.state.focused=!0,O(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),f&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),di(e))}function pi(e,t){e.state.delayingBlurEvent||(e.state.focused&&(be(e,"blur",e,t),e.state.focused=!1,w(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function gi(e){for(var t=e.display,n=t.lineDiv.offsetTop,i=0;i<t.view.length;i++){var r,o=t.view[i],s=e.options.lineWrapping,a=void 0,l=0;if(!o.hidden){v&&y<8?(a=(r=o.node.offsetTop+o.node.offsetHeight)-n,n=r):(a=(c=o.node.getBoundingClientRect()).bottom-c.top,!s&&o.text.firstChild&&(l=o.text.firstChild.getBoundingClientRect().right-c.left-1));var c=o.line.height-a;if((.005<c||c<-.005)&&(Qe(o.line,a),mi(o.line),o.rest))for(var d=0;d<o.rest.length;d++)mi(o.rest[d]);l>e.display.sizerWidth&&((l=Math.ceil(l/$n(e.display)))>e.display.maxLineLength&&(e.display.maxLineLength=l,e.display.maxLine=o.line,e.display.maxLineChanged=!0))}}}function mi(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t){var n=e.widgets[t],i=n.node.parentNode;i&&(n.height=i.offsetHeight)}}function vi(e,t,n){var i=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop,i=Math.floor(i-vn(e)),r=n&&null!=n.bottom?n.bottom:i+e.wrapper.clientHeight,o=et(t,i),i=et(t,r);return n&&n.ensure&&(r=n.ensure.from.line,n=n.ensure.to.line,r<o?i=et(t,Ut(Xe(t,o=r))+e.wrapper.clientHeight):Math.min(n,t.lastLine())>=i&&(o=et(t,Ut(Xe(t,n))-e.wrapper.clientHeight),i=n)),{from:o,to:Math.max(i,o+1)}}function yi(e,t){var n=e.display,i=Gn(e.display);t.top<0&&(t.top=0);var r=(e.curOp&&null!=e.curOp.scrollTop?e.curOp:n.scroller).scrollTop,o=kn(e),s={};t.bottom-t.top>o&&(t.bottom=t.top+o);var a=e.doc.height+yn(n),l=t.top<i,i=t.bottom>a-i;t.top<r?s.scrollTop=l?0:t.top:t.bottom>r+o&&((c=Math.min(t.top,(i?a:t.bottom)-o))!=r&&(s.scrollTop=c));var c=(e.curOp&&null!=e.curOp.scrollLeft?e.curOp:n.scroller).scrollLeft,e=bn(e)-(e.options.fixedGutter?n.gutters.offsetWidth:0),n=t.right-t.left>e;return n&&(t.right=t.left+e),t.left<10?s.scrollLeft=0:t.left<c?s.scrollLeft=Math.max(0,t.left-(n?0:10)):t.right>e+c-3&&(s.scrollLeft=t.right+(n?0:10)-e),s}function _i(e,t){null!=t&&(ki(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc:e.curOp).scrollTop+t)}function xi(e){ki(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function bi(e,t,n){null==t&&null==n||ki(e),null!=t&&(e.curOp.scrollLeft=t),null!=n&&(e.curOp.scrollTop=n)}function ki(e){var t=e.curOp.scrollToPos;t&&(e.curOp.scrollToPos=null,Ci(e,Wn(e,t.from),Wn(e,t.to),t.margin))}function Ci(e,t,n,i){i=yi(e,{left:Math.min(t.left,n.left),top:Math.min(t.top,n.top)-i,right:Math.max(t.right,n.right),bottom:Math.max(t.bottom,n.bottom)+i});bi(e,i.scrollLeft,i.scrollTop)}function wi(e,t){Math.abs(e.doc.scrollTop-t)<2||(u||zi(e,{top:t}),Si(e,t,!0),u&&zi(e),Hi(e,100))}function Si(e,t,n){t=Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t),e.display.scroller.scrollTop==t&&!n||(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t))}function Ti(e,t,n,i){t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!i||(e.doc.scrollLeft=t,Gi(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function Li(e){var t=e.display,n=t.gutters.offsetWidth,i=Math.round(e.doc.height+yn(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:i,scrollHeight:i+xn(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}e=function(e,t,n){this.cm=n;var i=this.vert=L("div",[L("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),r=this.horiz=L("div",[L("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");i.tabIndex=r.tabIndex=-1,e(i),e(r),ye(i,"scroll",function(){i.clientHeight&&t(i.scrollTop,"vertical")}),ye(r,"scroll",function(){r.clientWidth&&t(r.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,v&&y<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};e.prototype.update=function(e){var t,n=e.scrollWidth>e.clientWidth+1,i=e.scrollHeight>e.clientHeight+1,r=e.nativeBarWidth;return i?(this.vert.style.display="block",this.vert.style.bottom=n?r+"px":"0",t=e.viewHeight-(n?r:0),this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+t)+"px"):(this.vert.style.display="",this.vert.firstChild.style.height="0"),n?(this.horiz.style.display="block",this.horiz.style.right=i?r+"px":"0",this.horiz.style.left=e.barLeft+"px",t=e.viewWidth-e.barLeft-(i?r:0),this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+t)+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0"),!this.checkedZeroWidth&&0<e.clientHeight&&(0==r&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:i?r:0,bottom:n?r:0}},e.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},e.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},e.prototype.zeroWidthHack=function(){var e=g&&!s?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new I,this.disableVert=new I},e.prototype.enableZeroWidthBar=function(n,i,r){n.style.pointerEvents="auto",i.set(1e3,function e(){var t=n.getBoundingClientRect();("vert"==r?document.elementFromPoint(t.right-1,(t.top+t.bottom)/2):document.elementFromPoint((t.right+t.left)/2,t.bottom-1))!=n?n.style.pointerEvents="none":i.set(1e3,e)})},e.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)};i=function(){};function ji(e,t){t=t||Li(e);var n=e.display.barWidth,i=e.display.barHeight;Ai(e,t);for(var r=0;r<4&&n!=e.display.barWidth||i!=e.display.barHeight;r++)n!=e.display.barWidth&&e.options.lineWrapping&&gi(e),Ai(e,Li(e)),n=e.display.barWidth,i=e.display.barHeight}function Ai(e,t){var n=e.display,i=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=i.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=i.bottom)+"px",n.heightForcer.style.borderBottom=i.bottom+"px solid transparent",i.right&&i.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=i.bottom+"px",n.scrollbarFiller.style.width=i.right+"px"):n.scrollbarFiller.style.display="",i.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=i.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}i.prototype.update=function(){return{bottom:0,right:0}},i.prototype.setScrollLeft=function(){},i.prototype.setScrollTop=function(){},i.prototype.clear=function(){};var Mi={native:e,null:i};function Oi(n){n.display.scrollbars&&(n.display.scrollbars.clear(),n.display.scrollbars.addClass&&w(n.display.wrapper,n.display.scrollbars.addClass)),n.display.scrollbars=new Mi[n.options.scrollbarStyle](function(e){n.display.wrapper.insertBefore(e,n.display.scrollbarFiller),ye(e,"mousedown",function(){n.state.focused&&setTimeout(function(){return n.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,t){("horizontal"==t?Ti:wi)(n,e)},n),n.display.scrollbars.addClass&&O(n.display.wrapper,n.display.scrollbars.addClass)}var Ei=0;function Ni(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Ei},e=e.curOp,nn?nn.ops.push(e):e.ownsGroup=nn={ops:[e],delayedCallbacks:[]}}function Pi(e){e=e.curOp;e&&rn(e,function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;!function(e){for(var t=e.ops,n=0;n<t.length;n++)!function(e){var t=e.cm,n=t.display;(function(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=xn(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=xn(e)+"px",t.scrollbarsClipped=!0)})(t),e.updateMaxLine&&Vt(t);e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new Wi(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}(t[n]);for(var i=0;i<t.length;i++)!function(e){e.updatedDisplay=e.mustUpdate&&Ki(e.cm,e.update)}(t[i]);for(var r=0;r<t.length;r++)!function(e){var t=e.cm,n=t.display;e.updatedDisplay&&gi(t);e.barMeasure=Li(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=wn(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+xn(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-bn(t)));(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=n.input.prepareSelection())}(t[r]);for(var o=0;o<t.length;o++)!function(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&Ti(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1);var n=e.focus&&e.focus==M();e.preparedSelection&&t.display.input.showSelection(e.preparedSelection,n);!e.updatedDisplay&&e.startHeight==t.doc.height||ji(t,e.barMeasure);e.updatedDisplay&&qi(t,e.barMeasure);e.selectionChanged&&di(t);t.state.focused&&e.updateInput&&t.display.input.reset(e.typing);n&&hi(e.cm)}(t[o]);for(var s=0;s<t.length;s++)!function(e){var t=e.cm,n=t.display,i=t.doc;e.updatedDisplay&&Ui(t,e.update);null==n.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(n.wheelStartX=n.wheelStartY=null);null!=e.scrollTop&&Si(t,e.scrollTop,e.forceScroll);null!=e.scrollLeft&&Ti(t,e.scrollLeft,!0,!0);{var r;e.scrollToPos&&(r=function(e,t,n,i){null==i&&(i=0),e.options.lineWrapping||t!=n||(n="before"==(t=t.ch?it(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t).sticky?it(t.line,t.ch+1,"before"):t);for(var r=0;r<5;r++){var o,s=!1,a=Bn(e,t),l=n&&n!=t?Bn(e,n):a,c=yi(e,o={left:Math.min(a.left,l.left),top:Math.min(a.top,l.top)-i,right:Math.max(a.left,l.left),bottom:Math.max(a.bottom,l.bottom)+i}),a=e.doc.scrollTop,l=e.doc.scrollLeft;if(null!=c.scrollTop&&(wi(e,c.scrollTop),1<Math.abs(e.doc.scrollTop-a)&&(s=!0)),null!=c.scrollLeft&&(Ti(e,c.scrollLeft),1<Math.abs(e.doc.scrollLeft-l)&&(s=!0)),!s)break}return o}(t,dt(i,e.scrollToPos.from),dt(i,e.scrollToPos.to),e.scrollToPos.margin),function(e,t){var n,i,r;ke(e,"scrollCursorIntoView")||(i=(n=e.display).sizer.getBoundingClientRect(),r=null,t.top+i.top<0?r=!0:t.bottom+i.top>(window.innerHeight||document.documentElement.clientHeight)&&(r=!1),null==r||c||(t=L("div","​",null,"position: absolute;\n                         top: "+(t.top-n.viewOffset-vn(e.display))+"px;\n                         height: "+(t.bottom-t.top+xn(e)+n.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;"),e.display.lineSpace.appendChild(t),t.scrollIntoView(r),e.display.lineSpace.removeChild(t)))}(t,r))}var o=e.maybeHiddenMarkers,s=e.maybeUnhiddenMarkers;if(o)for(var a=0;a<o.length;++a)o[a].lines.length||be(o[a],"hide");if(s)for(var l=0;l<s.length;++l)s[l].lines.length&&be(s[l],"unhide");n.wrapper.offsetHeight&&(i.scrollTop=t.display.scroller.scrollTop);e.changeObjs&&be(t,"changes",t,e.changeObjs);e.update&&e.update.finish()}(t[s])}(e)})}function Fi(e,t){if(e.curOp)return t();Ni(e);try{return t()}finally{Pi(e)}}function Di(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Ni(e);try{return t.apply(e,arguments)}finally{Pi(e)}}}function Ii(e){return function(){if(this.curOp)return e.apply(this,arguments);Ni(this);try{return e.apply(this,arguments)}finally{Pi(this)}}}function Ri(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);Ni(e);try{return t.apply(this,arguments)}finally{Pi(e)}}}function Hi(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,P(Bi,e))}function Bi(s){var a,l,c,d=s.doc;d.highlightFrontier>=s.display.viewTo||(a=+new Date+s.options.workTime,l=mt(s,d.highlightFrontier),c=[],d.iter(l.line,Math.min(d.first+d.size,s.display.viewTo+500),function(e){if(l.line>=s.display.viewFrom){var t=e.styles,n=e.text.length>s.options.maxHighlightLength?Ve(d.mode,l.state):null,i=pt(s,e,l,!0);n&&(l.state=n),e.styles=i.styles;n=e.styleClasses,i=i.classes;i?e.styleClasses=i:n&&(e.styleClasses=null);for(var r=!t||t.length!=e.styles.length||n!=i&&(!n||!i||n.bgClass!=i.bgClass||n.textClass!=i.textClass),o=0;!r&&o<t.length;++o)r=t[o]!=e.styles[o];r&&c.push(l.line),e.stateAfter=l.save(),l.nextLine()}else e.text.length<=s.options.maxHighlightLength&&vt(s,e.text,l),e.stateAfter=l.line%5==0?l.save():null,l.nextLine();if(+new Date>a)return Hi(s,s.options.workDelay),!0}),d.highlightFrontier=l.line,d.modeFrontier=Math.max(d.modeFrontier,l.line),c.length&&Fi(s,function(){for(var e=0;e<c.length;e++)ni(s,c[e],"text")}))}var Wi=function(e,t,n){var i=e.display;this.viewport=t,this.visible=vi(i,e.doc,t),this.editorIsHidden=!i.wrapper.offsetWidth,this.wrapperHeight=i.wrapper.clientHeight,this.wrapperWidth=i.wrapper.clientWidth,this.oldDisplayWidth=bn(e),this.force=n,this.dims=Xn(e),this.events=[]};function Ki(e,t){var n=e.display,i=e.doc;if(t.editorIsHidden)return ii(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==oi(e))return!1;$i(e)&&(ii(e),t.dims=Xn(e));var r=i.first+i.size,o=Math.max(t.visible.from-e.options.viewportMargin,i.first),s=Math.min(r,t.visible.to+e.options.viewportMargin);n.viewFrom<o&&o-n.viewFrom<20&&(o=Math.max(i.first,n.viewFrom)),n.viewTo>s&&n.viewTo-s<20&&(s=Math.min(r,n.viewTo)),St&&(o=Bt(e.doc,o),s=Wt(e.doc,s));var a=o!=n.viewFrom||s!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth;i=o,r=s,0==(s=(o=e).display).view.length||i>=s.viewTo||r<=s.viewFrom?(s.view=tn(o,i,r),s.viewFrom=i):(s.viewFrom>i?s.view=tn(o,i,s.viewFrom).concat(s.view):s.viewFrom<i&&(s.view=s.view.slice(ei(o,i))),s.viewFrom=i,s.viewTo<r?s.view=s.view.concat(tn(o,s.viewTo,r)):s.viewTo>r&&(s.view=s.view.slice(0,ei(o,r)))),s.viewTo=r,n.viewOffset=Ut(Xe(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";o=oi(e);if(!a&&0==o&&!t.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;s=function(e){if(e.hasFocus())return null;var t=M();if(!t||!A(e.display.lineDiv,t))return null;var n={activeElt:t};return!window.getSelection||(t=window.getSelection()).anchorNode&&t.extend&&A(e.display.lineDiv,t.anchorNode)&&(n.anchorNode=t.anchorNode,n.anchorOffset=t.anchorOffset,n.focusNode=t.focusNode,n.focusOffset=t.focusOffset),n}(e);return 4<o&&(n.lineDiv.style.display="none"),function(n,e,t){var i=n.display,r=n.options.lineNumbers,o=i.lineDiv,s=o.firstChild;function a(e){var t=e.nextSibling;return f&&g&&n.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),t}for(var l=i.view,c=i.viewFrom,d=0;d<l.length;d++){var h=l[d];if(!h.hidden)if(h.node&&h.node.parentNode==o){for(;s!=h.node;)s=a(s);var u=r&&null!=e&&e<=c&&h.lineNumber;h.changes&&(-1<R(h.changes,"gutter")&&(u=!1),ln(n,h,c,t)),u&&(S(h.lineNumber),h.lineNumber.appendChild(document.createTextNode(nt(n.options,c)))),s=h.node.nextSibling}else{u=function(e,t,n,i){var r=dn(e,t);return t.text=t.node=r.pre,r.bgClass&&(t.bgClass=r.bgClass),r.textClass&&(t.textClass=r.textClass),hn(e,t),un(e,t,n,i),fn(e,t,i),t.node}(n,h,c,t);o.insertBefore(u,s)}c+=h.size}for(;s;)s=a(s)}(e,n.updateLineNumbers,t.dims),4<o&&(n.lineDiv.style.display=""),n.renderedView=n.view,(r=s)&&r.activeElt&&r.activeElt!=M()&&(r.activeElt.focus(),r.anchorNode&&A(document.body,r.anchorNode)&&A(document.body,r.focusNode)&&(o=window.getSelection(),(s=document.createRange()).setEnd(r.anchorNode,r.anchorOffset),s.collapse(!1),o.removeAllRanges(),o.addRange(s),o.extend(r.focusNode,r.focusOffset))),S(n.cursorDiv),S(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,a&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,Hi(e,400)),!(n.updateLineNumbers=null)}function Ui(e,t){for(var n=t.viewport,i=!0;(i&&e.options.lineWrapping&&t.oldDisplayWidth!=bn(e)||(n&&null!=n.top&&(n={top:Math.min(e.doc.height+yn(e.display)-kn(e),n.top)}),t.visible=vi(e.display,e.doc,n),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&Ki(e,t);i=!1){gi(e);var r=Li(e);si(e),ji(e,r),qi(e,r),t.force=!1}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function zi(e,t){var n=new Wi(e,t);Ki(e,n)&&(gi(e),Ui(e,n),t=Li(e),si(e),ji(e,t),qi(e,t),n.finish())}function Vi(e){var t=e.gutters.offsetWidth;e.sizer.style.marginLeft=t+"px"}function qi(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+xn(e)+"px"}function Gi(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var i=Jn(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,o=i+"px",s=0;s<n.length;s++)if(!n[s].hidden){e.options.fixedGutter&&(n[s].gutter&&(n[s].gutter.style.left=o),n[s].gutterBackground&&(n[s].gutterBackground.style.left=o));var a=n[s].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=o}e.options.fixedGutter&&(t.gutters.style.left=i+r+"px")}}function $i(e){if(e.options.lineNumbers){var t=e.doc,n=nt(e.options,t.first+t.size-1),i=e.display;if(n.length!=i.lineNumChars){var r=i.measure.appendChild(L("div",[L("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),t=r.firstChild.offsetWidth,r=r.offsetWidth-t;return i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(t,i.lineGutter.offsetWidth-r)+1,i.lineNumWidth=i.lineNumInnerWidth+r,i.lineNumChars=i.lineNumInnerWidth?n.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",Vi(e.display),1}}}function Xi(e,t){for(var n=[],i=!1,r=0;r<e.length;r++){var o=e[r],s=null;if("string"!=typeof o&&(s=o.style,o=o.className),"CodeMirror-linenumbers"==o){if(!t)continue;i=!0}n.push({className:o,style:s})}return t&&!i&&n.push({className:"CodeMirror-linenumbers",style:null}),n}function Ji(e){var t=e.gutters,n=e.gutterSpecs;S(t),e.lineGutter=null;for(var i=0;i<n.length;++i){var r=n[i],o=r.className,s=r.style,r=t.appendChild(L("div",null,"CodeMirror-gutter "+o));s&&(r.style.cssText=s),"CodeMirror-linenumbers"==o&&((e.lineGutter=r).style.width=(e.lineNumWidth||1)+"px")}t.style.display=n.length?"":"none",Vi(e)}function Yi(e){Ji(e.display),ti(e),Gi(e)}function Qi(e,t,n,i){var r=this;this.input=n,r.scrollbarFiller=L("div",null,"CodeMirror-scrollbar-filler"),r.scrollbarFiller.setAttribute("cm-not-content","true"),r.gutterFiller=L("div",null,"CodeMirror-gutter-filler"),r.gutterFiller.setAttribute("cm-not-content","true"),r.lineDiv=j("div",null,"CodeMirror-code"),r.selectionDiv=L("div",null,null,"position: relative; z-index: 1"),r.cursorDiv=L("div",null,"CodeMirror-cursors"),r.measure=L("div",null,"CodeMirror-measure"),r.lineMeasure=L("div",null,"CodeMirror-measure"),r.lineSpace=j("div",[r.measure,r.lineMeasure,r.selectionDiv,r.cursorDiv,r.lineDiv],null,"position: relative; outline: none");var o=j("div",[r.lineSpace],"CodeMirror-lines");r.mover=L("div",[o],null,"position: relative"),r.sizer=L("div",[r.mover],"CodeMirror-sizer"),r.sizerWidth=null,r.heightForcer=L("div",null,null,"position: absolute; height: "+H+"px; width: 1px;"),r.gutters=L("div",null,"CodeMirror-gutters"),r.lineGutter=null,r.scroller=L("div",[r.sizer,r.heightForcer,r.gutters],"CodeMirror-scroll"),r.scroller.setAttribute("tabIndex","-1"),r.wrapper=L("div",[r.scrollbarFiller,r.gutterFiller,r.scroller],"CodeMirror"),v&&y<8&&(r.gutters.style.zIndex=-1,r.scroller.style.paddingRight=0),f||u&&h||(r.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(r.wrapper):e(r.wrapper)),r.viewFrom=r.viewTo=t.first,r.reportedViewFrom=r.reportedViewTo=t.first,r.view=[],r.renderedView=null,r.externalMeasured=null,r.viewOffset=0,r.lastWrapHeight=r.lastWrapWidth=0,r.updateLineNumbers=null,r.nativeBarWidth=r.barHeight=r.barWidth=0,r.scrollbarsClipped=!1,r.lineNumWidth=r.lineNumInnerWidth=r.lineNumChars=null,r.alignWidgets=!1,r.cachedCharWidth=r.cachedTextHeight=r.cachedPaddingH=null,r.maxLine=null,r.maxLineLength=0,r.maxLineChanged=!1,r.wheelDX=r.wheelDY=r.wheelStartX=r.wheelStartY=null,r.shift=!1,r.selForContextMenu=null,r.activeTouch=null,r.gutterSpecs=Xi(i.gutters,i.lineNumbers),Ji(r),n.init(r)}Wi.prototype.signal=function(e,t){we(e,t)&&this.events.push(arguments)},Wi.prototype.finish=function(){for(var e=0;e<this.events.length;e++)be.apply(null,this.events[e])};var Zi=0,er=null;function tr(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}}function nr(e){e=tr(e);return e.x*=er,e.y*=er,e}function ir(e,t){var n=tr(t),i=n.x,r=n.y,o=e.display,s=o.scroller,a=s.scrollWidth>s.clientWidth,l=s.scrollHeight>s.clientHeight;if(i&&a||r&&l){if(r&&g&&f)e:for(var c=t.target,d=o.view;c!=s;c=c.parentNode)for(var h=0;h<d.length;h++)if(d[h].node==c){e.display.currentWheelTarget=c;break e}if(i&&!u&&!p&&null!=er)return r&&l&&wi(e,Math.max(0,s.scrollTop+r*er)),Ti(e,Math.max(0,s.scrollLeft+i*er)),(!r||r&&l)&&Te(t),void(o.wheelStartX=null);r&&null!=er&&(n=r*er,l=(a=e.doc.scrollTop)+o.wrapper.clientHeight,n<0?a=Math.max(0,a+n-50):l=Math.min(e.doc.height,l+n+50),zi(e,{top:a,bottom:l})),Zi<20&&(null==o.wheelStartX?(o.wheelStartX=s.scrollLeft,o.wheelStartY=s.scrollTop,o.wheelDX=i,o.wheelDY=r,setTimeout(function(){var e,t;null!=o.wheelStartX&&(t=s.scrollLeft-o.wheelStartX,t=(e=s.scrollTop-o.wheelStartY)&&o.wheelDY&&e/o.wheelDY||t&&o.wheelDX&&t/o.wheelDX,o.wheelStartX=o.wheelStartY=null,t&&(er=(er*Zi+t)/(Zi+1),++Zi))},200)):(o.wheelDX+=i,o.wheelDY+=r))}}v?er=-.53:u?er=15:o?er=-.7:l&&(er=-1/3);var rr=function(e,t){this.ranges=e,this.primIndex=t};rr.prototype.primary=function(){return this.ranges[this.primIndex]},rr.prototype.equals=function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],i=e.ranges[t];if(!ot(n.anchor,i.anchor)||!ot(n.head,i.head))return!1}return!0},rr.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new or(st(this.ranges[t].anchor),st(this.ranges[t].head));return new rr(e,this.primIndex)},rr.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},rr.prototype.contains=function(e,t){t=t||e;for(var n=0;n<this.ranges.length;n++){var i=this.ranges[n];if(0<=rt(t,i.from())&&rt(e,i.to())<=0)return n}return-1};var or=function(e,t){this.anchor=e,this.head=t};function sr(e,t,n){var i=e&&e.options.selectionsMayTouch,e=t[n];t.sort(function(e,t){return rt(e.from(),t.from())}),n=R(t,e);for(var r=1;r<t.length;r++){var o,s=t[r],a=t[r-1],l=rt(a.to(),s.from());(i&&!s.empty()?0<l:0<=l)&&(o=lt(a.from(),s.from()),l=at(a.to(),s.to()),a=a.empty()?s.from()==s.head:a.from()==a.head,r<=n&&--n,t.splice(--r,2,new or(a?l:o,a?o:l)))}return new rr(t,n)}function ar(e,t){return new rr([new or(e,t||e)],0)}function lr(e){return e.text?it(e.from.line+e.text.length-1,G(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function cr(e,t){if(rt(e,t.from)<0)return e;if(rt(e,t.to)<=0)return lr(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=lr(t).ch-t.to.ch),it(n,i)}function dr(e,t){for(var n=[],i=0;i<e.sel.ranges.length;i++){var r=e.sel.ranges[i];n.push(new or(cr(r.anchor,t),cr(r.head,t)))}return sr(e.cm,n,e.sel.primIndex)}function hr(e,t,n){return e.line==t.line?it(n.line,e.ch-t.ch+n.ch):it(n.line+(e.line-t.line),e.ch)}function ur(e){e.doc.mode=Ke(e.options,e.doc.modeOption),fr(e)}function fr(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,Hi(e,100),e.state.modeGen++,e.curOp&&ti(e)}function pr(e,t){return 0==t.from.ch&&0==t.to.ch&&""==G(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function gr(e,o,t,s){function r(e){return t?t[e]:null}function n(e,t,n){var i,r;i=t,r=n,t=s,(n=e).text=i,n.stateAfter&&(n.stateAfter=null),n.styles&&(n.styles=null),null!=n.order&&(n.order=null),Mt(n),Ot(n,r),(t=t?t(n):1)!=n.height&&Qe(n,t),sn(e,"change",e,o)}function i(e,t){for(var n=[],i=e;i<t;++i)n.push(new qt(d[i],r(i),s));return n}var a,l=o.from,c=o.to,d=o.text,h=Xe(e,l.line),u=Xe(e,c.line),f=G(d),p=r(d.length-1),g=c.line-l.line;o.full?(e.insert(0,i(0,d.length)),e.remove(d.length,e.size-d.length)):pr(e,o)?(a=i(0,d.length-1),n(u,u.text,p),g&&e.remove(l.line,g),a.length&&e.insert(l.line,a)):h==u?1==d.length?n(h,h.text.slice(0,l.ch)+f+h.text.slice(c.ch),p):((a=i(1,d.length-1)).push(new qt(f+h.text.slice(c.ch),p,s)),n(h,h.text.slice(0,l.ch)+d[0],r(0)),e.insert(l.line+1,a)):1==d.length?(n(h,h.text.slice(0,l.ch)+d[0]+u.text.slice(c.ch),r(0)),e.remove(l.line+1,g)):(n(h,h.text.slice(0,l.ch)+d[0],r(0)),n(u,f+u.text.slice(c.ch),p),p=i(1,d.length-1),1<g&&e.remove(l.line+1,g-1),e.insert(l.line+1,p)),sn(e,"change",e,o)}function mr(e,a,l){!function e(t,n,i){if(t.linked)for(var r=0;r<t.linked.length;++r){var o,s=t.linked[r];s.doc!=n&&(o=i&&s.sharedHist,l&&!o||(a(s.doc,o),e(s.doc,t,o)))}}(e,null,!0)}function vr(e,t){if(t.cm)throw new Error("This document is already in use.");Qn((e.doc=t).cm=e),ur(e),yr(e),e.options.lineWrapping||Vt(e),e.options.mode=t.modeOption,ti(e)}function yr(e){("rtl"==e.doc.direction?O:w)(e.display.lineDiv,"CodeMirror-rtl")}function _r(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function xr(e,t){var n={from:st(t.from),to:lr(t),text:Je(e,t.from,t.to)};return Sr(e,n,t.from.line,t.to.line+1),mr(e,function(e){return Sr(e,n,t.from.line,t.to.line+1),0},!0),n}function br(e){for(;e.length;){if(!G(e).ranges)break;e.pop()}}function kr(e,t,n,i){var r=e.history;r.undone.length=0;var o,s,a=+new Date;if((r.lastOp==i||r.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&r.lastModTime>a-(e.cm?e.cm.options.historyEventDelay:500)||"*"==t.origin.charAt(0)))&&(o=(l=r).lastOp==i?(br(l.done),G(l.done)):l.done.length&&!G(l.done).ranges?G(l.done):1<l.done.length&&!l.done[l.done.length-2].ranges?(l.done.pop(),G(l.done)):void 0))s=G(o.changes),0==rt(t.from,t.to)&&0==rt(t.from,s.to)?s.to=lr(t):o.changes.push(xr(e,t));else{var l=G(r.done);for(l&&l.ranges||wr(e.sel,r.done),o={changes:[xr(e,t)],generation:r.generation},r.done.push(o);r.done.length>r.undoDepth;)r.done.shift(),r.done[0].ranges||r.done.shift()}r.done.push(n),r.generation=++r.maxGeneration,r.lastModTime=r.lastSelTime=a,r.lastOp=r.lastSelOp=i,r.lastOrigin=r.lastSelOrigin=t.origin,s||be(e,"historyAdded")}function Cr(e,t,n,i){var r,o,s,a=e.history,l=i&&i.origin;n==a.lastSelOp||l&&a.lastSelOrigin==l&&(a.lastModTime==a.lastSelTime&&a.lastOrigin==l||(r=e,o=l,s=G(a.done),e=t,"*"==(o=o.charAt(0))||"+"==o&&s.ranges.length==e.ranges.length&&s.somethingSelected()==e.somethingSelected()&&new Date-r.history.lastSelTime<=(r.cm?r.cm.options.historyEventDelay:500)))?a.done[a.done.length-1]=t:wr(t,a.done),a.lastSelTime=+new Date,a.lastSelOrigin=l,a.lastSelOp=n,i&&!1!==i.clearRedo&&br(a.undone)}function wr(e,t){var n=G(t);n&&n.ranges&&n.equals(e)||t.push(e)}function Sr(t,n,e,i){var r=n["spans_"+t.id],o=0;t.iter(Math.max(t.first,e),Math.min(t.first+t.size,i),function(e){e.markedSpans&&((r=r||(n["spans_"+t.id]={}))[o]=e.markedSpans),++o})}function Tr(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var i=[],r=0;r<t.text.length;++r)i.push(function(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t=t||e.slice(0,n):t&&t.push(e[n]);return t?t.length?t:null:e}(n[r]));return i}function Lr(e,t){var n=Tr(e,t),i=jt(e,t);if(!n)return i;if(!i)return n;for(var r=0;r<n.length;++r){var o=n[r],s=i[r];if(o&&s)e:for(var a=0;a<s.length;++a){for(var l=s[a],c=0;c<o.length;++c)if(o[c].marker==l.marker)continue e;o.push(l)}else s&&(n[r]=s)}return n}function jr(e,t,n){for(var i=[],r=0;r<e.length;++r){var o=e[r];if(o.ranges)i.push(n?rr.prototype.deepCopy.call(o):o);else{var s=o.changes,a=[];i.push({changes:a});for(var l=0;l<s.length;++l){var c,d=s[l];if(a.push({from:d.from,to:d.to,text:d.text}),t)for(var h in d)(c=h.match(/^spans_(\d+)$/))&&-1<R(t,Number(c[1]))&&(G(a)[h]=d[h],delete d[h])}}}return i}function Ar(e,t,n,i){if(i){i=e.anchor;return n&&((e=rt(t,i)<0)!=rt(n,i)<0?(i=t,t=n):e!=rt(t,n)<0&&(t=n)),new or(i,t)}return new or(n||t,t)}function Mr(e,t,n,i,r){null==r&&(r=e.cm&&(e.cm.display.shift||e.extend)),Fr(e,new rr([Ar(e.sel.primary(),t,n,r)],0),i)}function Or(e,t,n){for(var i=[],r=e.cm&&(e.cm.display.shift||e.extend),o=0;o<e.sel.ranges.length;o++)i[o]=Ar(e.sel.ranges[o],t[o],null,r);Fr(e,sr(e.cm,i,e.sel.primIndex),n)}function Er(e,t,n,i){var r=e.sel.ranges.slice(0);r[t]=n,Fr(e,sr(e.cm,r,e.sel.primIndex),i)}function Nr(e,t,n,i){Fr(e,ar(t,n),i)}function Pr(e,t,n){var i=e.history.done,r=G(i);r&&r.ranges?Dr(e,i[i.length-1]=t,n):Fr(e,t,n)}function Fr(e,t,n){Dr(e,t,n),Cr(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function Dr(e,t,n){var i,r;(we(e,"beforeSelectionChange")||e.cm&&we(e.cm,"beforeSelectionChange"))&&(i=e,r=n,r={ranges:(o=t).ranges,update:function(e){this.ranges=[];for(var t=0;t<e.length;t++)this.ranges[t]=new or(dt(i,e[t].anchor),dt(i,e[t].head))},origin:r&&r.origin},be(i,"beforeSelectionChange",i,r),i.cm&&be(i.cm,"beforeSelectionChange",i.cm,r),t=r.ranges!=o.ranges?sr(i.cm,r.ranges,r.ranges.length-1):o);var o=n&&n.bias||(rt(t.primary().head,e.sel.primary().head)<0?-1:1);Ir(e,Hr(e,t,o,!0)),n&&!1===n.scroll||!e.cm||xi(e.cm)}function Ir(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=1,e.cm.curOp.selectionChanged=!0,Ce(e.cm)),sn(e,"cursorActivity",e))}function Rr(e){Ir(e,Hr(e,e.sel,null,!1))}function Hr(e,t,n,i){for(var r,o=0;o<t.ranges.length;o++){var s=t.ranges[o],a=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[o],l=Wr(e,s.anchor,a&&a.anchor,n,i),a=Wr(e,s.head,a&&a.head,n,i);!r&&l==s.anchor&&a==s.head||((r=r||t.ranges.slice(0,o))[o]=new or(l,a))}return r?sr(e.cm,r,t.primIndex):t}function Br(e,t,n,i,r){var o=Xe(e,t.line);if(o.markedSpans)for(var s=0;s<o.markedSpans.length;++s){var a=o.markedSpans[s],l=a.marker;if((null==a.from||(l.inclusiveLeft?a.from<=t.ch:a.from<t.ch))&&(null==a.to||(l.inclusiveRight?a.to>=t.ch:a.to>t.ch))){if(r&&(be(l,"beforeCursorEnter"),l.explicitlyCleared)){if(o.markedSpans){--s;continue}break}if(l.atomic){if(n){var c=l.find(i<0?1:-1),a=void 0;if((i<0?l.inclusiveRight:l.inclusiveLeft)&&(c=Kr(e,c,-i,c&&c.line==t.line?o:null)),c&&c.line==t.line&&(a=rt(c,n))&&(i<0?a<0:0<a))return Br(e,c,t,i,r)}c=l.find(i<0?-1:1);return(i<0?l.inclusiveLeft:l.inclusiveRight)&&(c=Kr(e,c,i,c.line==t.line?o:null)),c?Br(e,c,t,i,r):null}}}return t}function Wr(e,t,n,i,r){i=i||1,i=Br(e,t,n,i,r)||!r&&Br(e,t,n,i,!0)||Br(e,t,n,-i,r)||!r&&Br(e,t,n,-i,!0);return i||(e.cantEdit=!0,it(e.first,0))}function Kr(e,t,n,i){return n<0&&0==t.ch?t.line>e.first?dt(e,it(t.line-1)):null:0<n&&t.ch==(i||Xe(e,t.line)).text.length?t.line<e.first+e.size-1?it(t.line+1,0):null:new it(t.line,t.ch+n)}function Ur(e){e.setSelection(it(e.firstLine(),0),it(e.lastLine()),W)}function zr(r,e,t){var o={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return o.canceled=!0}};return t&&(o.update=function(e,t,n,i){e&&(o.from=dt(r,e)),t&&(o.to=dt(r,t)),n&&(o.text=n),void 0!==i&&(o.origin=i)}),be(r,"beforeChange",r,o),r.cm&&be(r.cm,"beforeChange",r.cm,o),o.canceled?(r.cm&&(r.cm.curOp.updateInput=2),null):{from:o.from,to:o.to,text:o.text,origin:o.origin}}function Vr(e,t,n){if(e.cm){if(!e.cm.curOp)return Di(e.cm,Vr)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(we(e,"beforeChange")||e.cm&&we(e.cm,"beforeChange"))||(t=zr(e,t,!0))){var i=wt&&!n&&function(e,t,n){var i=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||i&&-1!=R(i,n)||(i=i||[]).push(n)}}),!i)return null;for(var r=[{from:t,to:n}],o=0;o<i.length;++o)for(var s=i[o],a=s.find(0),l=0;l<r.length;++l){var c,d,h,u=r[l];rt(u.to,a.from)<0||0<rt(u.from,a.to)||(c=[l,1],d=rt(u.from,a.from),h=rt(u.to,a.to),(d<0||!s.inclusiveLeft&&!d)&&c.push({from:u.from,to:a.from}),(0<h||!s.inclusiveRight&&!h)&&c.push({from:a.to,to:u.to}),r.splice.apply(r,c),l+=c.length-3)}return r}(e,t.from,t.to);if(i)for(var r=i.length-1;0<=r;--r)qr(e,{from:i[r].from,to:i[r].to,text:r?[""]:t.text,origin:t.origin});else qr(e,t)}}function qr(e,n){var t,i;1==n.text.length&&""==n.text[0]&&0==rt(n.from,n.to)||(t=dr(e,n),kr(e,n,t,e.cm?e.cm.curOp.id:NaN),Xr(e,n,t,jt(e,n)),i=[],mr(e,function(e,t){t||-1!=R(i,e.history)||(Zr(e.history,n),i.push(e.history)),Xr(e,n,null,jt(e,n))}))}function Gr(r,o,e){var t=r.cm&&r.cm.state.suppressEdits;if(!t||e){for(var s,n=r.history,i=r.sel,a="undo"==o?n.done:n.undone,l="undo"==o?n.undone:n.done,c=0;c<a.length&&(s=a[c],e?!s.ranges||s.equals(r.sel):s.ranges);c++);if(c!=a.length){for(n.lastOrigin=n.lastSelOrigin=null;;){if(!(s=a.pop()).ranges){if(t)return void a.push(s);break}if(wr(s,l),e&&!s.equals(r.sel))return void Fr(r,s,{clearRedo:!1});i=s}var d=[];wr(i,l),l.push({changes:d,generation:n.generation}),n.generation=s.generation||++n.maxGeneration;for(var h=we(r,"beforeChange")||r.cm&&we(r.cm,"beforeChange"),u=s.changes.length-1;0<=u;--u){var f=function(e){var n=s.changes[e];if(n.origin=o,h&&!zr(r,n,!1))return a.length=0,{};d.push(xr(r,n));var t=e?dr(r,n):G(a);Xr(r,n,t,Lr(r,n)),!e&&r.cm&&r.cm.scrollIntoView({from:n.from,to:lr(n)});var i=[];mr(r,function(e,t){t||-1!=R(i,e.history)||(Zr(e.history,n),i.push(e.history)),Xr(e,n,null,Lr(e,n))})}(u);if(f)return f.v}}}}function $r(e,t){if(0!=t&&(e.first+=t,e.sel=new rr($(e.sel.ranges,function(e){return new or(it(e.anchor.line+t,e.anchor.ch),it(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){ti(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,i=n.viewFrom;i<n.viewTo;i++)ni(e.cm,i,"gutter")}}function Xr(e,t,n,i){if(e.cm&&!e.cm.curOp)return Di(e.cm,Xr)(e,t,n,i);var r;t.to.line<e.first?$r(e,t.text.length-1-(t.to.line-t.from.line)):t.from.line>e.lastLine()||(t.from.line<e.first&&($r(e,r=t.text.length-1-(e.first-t.from.line)),t={from:it(e.first,0),to:it(t.to.line+r,t.to.ch),text:[G(t.text)],origin:t.origin}),r=e.lastLine(),t.to.line>r&&(t={from:t.from,to:it(r,Xe(e,r).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Je(e,t.from,t.to),n=n||dr(e,t),e.cm?function(e,t,n){var i=e.doc,r=e.display,o=t.from,s=t.to,a=!1,l=o.line;e.options.lineWrapping||(l=Ze(Ht(Xe(i,o.line))),i.iter(l,s.line+1,function(e){if(e==r.maxLine)return a=!0}));-1<i.sel.contains(t.from,t.to)&&Ce(e);gr(i,t,n,Yn(e)),e.options.lineWrapping||(i.iter(l,o.line+t.text.length,function(e){var t=zt(e);t>r.maxLineLength&&(r.maxLine=e,r.maxLineLength=t,r.maxLineChanged=!0,a=!1)}),a&&(e.curOp.updateMaxLine=!0));(function(e,t){if(e.modeFrontier=Math.min(e.modeFrontier,t),!(e.highlightFrontier<t-10)){for(var n=e.first,i=t-1;n<i;i--){var r=Xe(e,i).stateAfter;if(r&&(!(r instanceof ut)||i+r.lookAhead<t)){n=i+1;break}}e.highlightFrontier=Math.min(e.highlightFrontier,n)}})(i,o.line),Hi(e,400);l=t.text.length-(s.line-o.line)-1;t.full?ti(e):o.line!=s.line||1!=t.text.length||pr(e.doc,t)?ti(e,o.line,s.line+1,l):ni(e,o.line,"text");i=we(e,"changes"),l=we(e,"change");(l||i)&&(t={from:o,to:s,text:t.text,removed:t.removed,origin:t.origin},l&&sn(e,"change",e,t),i&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(t));e.display.selForContextMenu=null}(e.cm,t,i):gr(e,t,i),Dr(e,n,W))}function Jr(e,t,n,i,r){var o;rt(i=i||n,n)<0&&(n=(o=[i,n])[0],i=o[1]),"string"==typeof t&&(t=e.splitLines(t)),Vr(e,{from:n,to:i,text:t,origin:r})}function Yr(e,t,n,i){n<e.line?e.line+=i:t<e.line&&(e.line=t,e.ch=0)}function Qr(e,t,n,i){for(var r=0;r<e.length;++r){var o=e[r],s=!0;if(o.ranges){o.copied||((o=e[r]=o.deepCopy()).copied=!0);for(var a=0;a<o.ranges.length;a++)Yr(o.ranges[a].anchor,t,n,i),Yr(o.ranges[a].head,t,n,i)}else{for(var l=0;l<o.changes.length;++l){var c=o.changes[l];if(n<c.from.line)c.from=it(c.from.line+i,c.from.ch),c.to=it(c.to.line+i,c.to.ch);else if(t<=c.to.line){s=!1;break}}s||(e.splice(0,r+1),r=0)}}}function Zr(e,t){var n=t.from.line,i=t.to.line,t=t.text.length-(i-n)-1;Qr(e.done,n,i,t),Qr(e.undone,n,i,t)}function eo(e,t,n,i){var r=t,o=t;return"number"==typeof t?o=Xe(e,ct(e,t)):r=Ze(t),null==r?null:(i(o,r)&&e.cm&&ni(e.cm,r,n),o)}function to(e){this.lines=e,this.parent=null;for(var t=0,n=0;n<e.length;++n)e[n].parent=this,t+=e[n].height;this.height=t}function no(e){this.children=e;for(var t=0,n=0,i=0;i<e.length;++i){var r=e[i];t+=r.chunkSize(),n+=r.height,r.parent=this}this.size=t,this.height=n,this.parent=null}or.prototype.from=function(){return lt(this.anchor,this.head)},or.prototype.to=function(){return at(this.anchor,this.head)},or.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},to.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n,i=e,r=e+t;i<r;++i){var o=this.lines[i];this.height-=o.height,(n=o).parent=null,Mt(n),sn(o,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var i=0;i<t.length;++i)t[i].parent=this},iterN:function(e,t,n){for(var i=e+t;e<i;++e)if(n(this.lines[e]))return!0}},no.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n,i=0;i<this.children.length;++i){var r=this.children[i],o=r.chunkSize();if(e<o){var s=Math.min(t,o-e),a=r.height;if(r.removeInner(e,s),this.height-=a-r.height,o==s&&(this.children.splice(i--,1),r.parent=null),0==(t-=s))break;e=0}else e-=o}this.size-t<25&&(1<this.children.length||!(this.children[0]instanceof to))&&(n=[],this.collapse(n),this.children=[new to(n)],this.children[0].parent=this)},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var i=0;i<this.children.length;++i){var r=this.children[i],o=r.chunkSize();if(e<=o){if(r.insertInner(e,t,n),r.lines&&50<r.lines.length){for(var s=r.lines.length%25+25,a=s;a<r.lines.length;){var l=new to(r.lines.slice(a,a+=25));r.height-=l.height,this.children.splice(++i,0,l),l.parent=this}r.lines=r.lines.slice(0,s),this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t,n=new no(e.children.splice(e.children.length-5,5))}while(e.parent?(e.size-=n.size,e.height-=n.height,t=R(e.parent.children,e),e.parent.children.splice(t+1,0,n)):(((t=new no(e.children)).parent=e).children=[t,n],e=t),n.parent=e.parent,10<e.children.length);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var i=0;i<this.children.length;++i){var r=this.children[i],o=r.chunkSize();if(e<o){var s=Math.min(t,o-e);if(r.iterN(e,s,n))return!0;if(0==(t-=s))break;e=0}else e-=o}}};function io(e,t,n){if(n)for(var i in n)n.hasOwnProperty(i)&&(this[i]=n[i]);this.doc=e,this.node=t}function ro(e,t,n){Ut(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&_i(e,n)}io.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,n=this.line,i=Ze(n);if(null!=i&&t){for(var r=0;r<t.length;++r)t[r]==this&&t.splice(r--,1);t.length||(n.widgets=null);var o=gn(this);Qe(n,Math.max(0,n.height-o)),e&&(Fi(e,function(){ro(e,n,-o),ni(e,i,"widget")}),sn(e,"lineWidgetCleared",e,this,i))}},io.prototype.changed=function(){var e=this,t=this.height,n=this.doc.cm,i=this.line;this.height=null;var r=gn(this)-t;r&&(Kt(this.doc,i)||Qe(i,i.height+r),n&&Fi(n,function(){n.curOp.forceUpdate=!0,ro(n,i,r),sn(n,"lineWidgetChanged",n,e,Ze(i))}))},Se(io);var oo=0,so=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++oo};function ao(t,n,i,e,r){if(e&&e.shared)return function(e,n,i,r,o){(r=F(r)).shared=!1;var s=[ao(e,n,i,r,o)],a=s[0],l=r.widgetNode;return mr(e,function(e){l&&(r.widgetNode=l.cloneNode(!0)),s.push(ao(e,dt(e,n),dt(e,i),r,o));for(var t=0;t<e.linked.length;++t)if(e.linked[t].isParent)return;a=G(s)}),new lo(s,a)}(t,n,i,e,r);if(t.cm&&!t.cm.curOp)return Di(t.cm,ao)(t,n,i,e,r);var o=new so(t,r),r=rt(n,i);if(e&&F(e,o,!1),0<r||0==r&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=j("span",[o.replacedWith],"CodeMirror-widget"),e.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),e.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(Rt(t,n.line,n,i,o)||n.line!=i.line&&Rt(t,i.line,n,i,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");St=!0}o.addToHistory&&kr(t,{from:n,to:i,origin:"markText"},t.sel,NaN);var s,a=n.line,l=t.cm;if(t.iter(a,i.line+1,function(e){var t;l&&o.collapsed&&!l.options.lineWrapping&&Ht(e)==l.display.maxLine&&(s=!0),o.collapsed&&a!=n.line&&Qe(e,0),t=e,e=new Tt(o,a==n.line?n.ch:null,a==i.line?i.ch:null),t.markedSpans=t.markedSpans?t.markedSpans.concat([e]):[e],e.marker.attachLine(t),++a}),o.collapsed&&t.iter(n.line,i.line+1,function(e){Kt(t,e)&&Qe(e,0)}),o.clearOnEnter&&ye(o,"beforeCursorEnter",function(){return o.clear()}),o.readOnly&&(wt=!0,(t.history.done.length||t.history.undone.length)&&t.clearHistory()),o.collapsed&&(o.id=++oo,o.atomic=!0),l){if(s&&(l.curOp.updateMaxLine=!0),o.collapsed)ti(l,n.line,i.line+1);else if(o.className||o.startStyle||o.endStyle||o.css||o.attributes||o.title)for(var c=n.line;c<=i.line;c++)ni(l,c,"text");o.atomic&&Rr(l.doc),sn(l,"markerAdded",l,o)}return o}so.prototype.clear=function(){var e=this;if(!this.explicitlyCleared){var t,n=this.doc.cm,i=n&&!n.curOp;i&&Ni(n),!we(this,"clear")||(t=this.find())&&sn(this,"clear",t.from,t.to);for(var r=null,o=null,s=0;s<this.lines.length;++s){var a=e.lines[s],l=Lt(a.markedSpans,e);n&&!e.collapsed?ni(n,Ze(a),"text"):n&&(null!=l.to&&(o=Ze(a)),null!=l.from&&(r=Ze(a))),a.markedSpans=function(e,t){for(var n,i=0;i<e.length;++i)e[i]!=t&&(n=n||[]).push(e[i]);return n}(a.markedSpans,l),null==l.from&&e.collapsed&&!Kt(e.doc,a)&&n&&Qe(a,Gn(n.display))}if(n&&this.collapsed&&!n.options.lineWrapping)for(var c=0;c<this.lines.length;++c){var d=Ht(e.lines[c]),h=zt(d);h>n.display.maxLineLength&&(n.display.maxLine=d,n.display.maxLineLength=h,n.display.maxLineChanged=!0)}null!=r&&n&&this.collapsed&&ti(n,r,o+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,n&&Rr(n.doc)),n&&sn(n,"markerCleared",n,this,r,o),i&&Pi(n),this.parent&&this.parent.clear()}},so.prototype.find=function(e,t){var n,i;null==e&&"bookmark"==this.type&&(e=1);for(var r=0;r<this.lines.length;++r){var o=this.lines[r],s=Lt(o.markedSpans,this);if(null!=s.from&&(n=it(t?o:Ze(o),s.from),-1==e))return n;if(null!=s.to&&(i=it(t?o:Ze(o),s.to),1==e))return i}return n&&{from:n,to:i}},so.prototype.changed=function(){var n=this,i=this.find(-1,!0),r=this,o=this.doc.cm;i&&o&&Fi(o,function(){var e=i.line,t=Ze(i.line),t=Sn(o,t);t&&(On(t),o.curOp.selectionChanged=o.curOp.forceUpdate=!0),o.curOp.updateMaxLine=!0,Kt(r.doc,e)||null==r.height||(t=r.height,r.height=null,(t=gn(r)-t)&&Qe(e,e.height+t)),sn(o,"markerChanged",o,n)})},so.prototype.attachLine=function(e){var t;!this.lines.length&&this.doc.cm&&((t=this.doc.cm.curOp).maybeHiddenMarkers&&-1!=R(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)),this.lines.push(e)},so.prototype.detachLine=function(e){this.lines.splice(R(this.lines,e),1),!this.lines.length&&this.doc.cm&&((e=this.doc.cm.curOp).maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)},Se(so);var lo=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};function co(e){return e.findMarks(it(e.first,0),e.clipPos(it(e.lastLine())),function(e){return e.parent})}lo.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();sn(this,"clear")}},lo.prototype.find=function(e,t){return this.primary.find(e,t)},Se(lo);var ho=0,uo=function(e,t,n,i,r){if(!(this instanceof uo))return new uo(e,t,n,i,r);null==n&&(n=0),no.call(this,[new to([new qt("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1;n=it(this.modeFrontier=this.highlightFrontier=n,0);this.sel=ar(n),this.history=new _r(null),this.id=++ho,this.modeOption=t,this.lineSep=i,this.direction="rtl"==r?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),gr(this,{from:n,to:n,text:e}),Fr(this,ar(n),W)};uo.prototype=J(no.prototype,{constructor:uo,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,i=0;i<t.length;++i)n+=t[i].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Ye(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:Ri(function(e){var t=it(this.first,0),n=this.first+this.size-1;Vr(this,{from:t,to:it(n,Xe(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&bi(this.cm,0,0),Fr(this,ar(t),W)}),replaceRange:function(e,t,n,i){Jr(this,e,t=dt(this,t),n=n?dt(this,n):t,i)},getRange:function(e,t,n){t=Je(this,dt(this,e),dt(this,t));return!1===n?t:t.join(n||this.lineSeparator())},getLine:function(e){e=this.getLineHandle(e);return e&&e.text},getLineHandle:function(e){if(tt(this,e))return Xe(this,e)},getLineNumber:Ze,getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=Xe(this,e)),Ht(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return dt(this,e)},getCursor:function(e){var t=this.sel.primary(),t=null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from();return t},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Ri(function(e,t,n){Nr(this,dt(this,"number"==typeof e?it(e,t||0):e),null,n)}),setSelection:Ri(function(e,t,n){Nr(this,dt(this,e),dt(this,t||e),n)}),extendSelection:Ri(function(e,t,n){Mr(this,dt(this,e),t&&dt(this,t),n)}),extendSelections:Ri(function(e,t){Or(this,ht(this,e),t)}),extendSelectionsBy:Ri(function(e,t){Or(this,ht(this,$(this.sel.ranges,e)),t)}),setSelections:Ri(function(e,t,n){if(e.length){for(var i=[],r=0;r<e.length;r++)i[r]=new or(dt(this,e[r].anchor),dt(this,e[r].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),Fr(this,sr(this.cm,i,t),n)}}),addSelection:Ri(function(e,t,n){var i=this.sel.ranges.slice(0);i.push(new or(dt(this,e),dt(this,t||e))),Fr(this,sr(this.cm,i,i.length-1),n)}),getSelection:function(e){for(var t=this.sel.ranges,n=0;n<t.length;n++)var i=Je(this,t[n].from(),t[n].to()),r=r?r.concat(i):i;return!1===e?r:r.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],n=this.sel.ranges,i=0;i<n.length;i++){var r=Je(this,n[i].from(),n[i].to());!1!==e&&(r=r.join(e||this.lineSeparator())),t[i]=r}return t},replaceSelection:function(e,t,n){for(var i=[],r=0;r<this.sel.ranges.length;r++)i[r]=e;this.replaceSelections(i,t,n||"+input")},replaceSelections:Ri(function(e,t,n){for(var i=[],r=this.sel,o=0;o<r.ranges.length;o++){var s=r.ranges[o];i[o]={from:s.from(),to:s.to(),text:this.splitLines(e[o]),origin:n}}for(var t=t&&"end"!=t&&function(e,t,n){for(var i=[],r=c=it(e.first,0),o=0;o<t.length;o++){var s=t[o],a=hr(s.from,c,r),l=hr(lr(s),c,r),c=s.to,r=l;"around"==n?(s=rt((s=e.sel.ranges[o]).head,s.anchor)<0,i[o]=new or(s?l:a,s?a:l)):i[o]=new or(a,a)}return new rr(i,e.sel.primIndex)}(this,i,t),a=i.length-1;0<=a;a--)Vr(this,i[a]);t?Pr(this,t):this.cm&&xi(this.cm)}),undo:Ri(function(){Gr(this,"undo")}),redo:Ri(function(){Gr(this,"redo")}),undoSelection:Ri(function(){Gr(this,"undo",!0)}),redoSelection:Ri(function(){Gr(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,i=0;i<e.done.length;i++)e.done[i].ranges||++t;for(var r=0;r<e.undone.length;r++)e.undone[r].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new _r(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:jr(this.history.done),undone:jr(this.history.undone)}},setHistory:function(e){var t=this.history=new _r(this.history.maxGeneration);t.done=jr(e.done.slice(0),null,!0),t.undone=jr(e.undone.slice(0),null,!0)},setGutterMarker:Ri(function(e,n,i){return eo(this,e,"gutter",function(e){var t=e.gutterMarkers||(e.gutterMarkers={});return!(t[n]=i)&&ee(t)&&(e.gutterMarkers=null),1})}),clearGutter:Ri(function(t){var n=this;this.iter(function(e){e.gutterMarkers&&e.gutterMarkers[t]&&eo(n,e,"gutter",function(){return e.gutterMarkers[t]=null,ee(e.gutterMarkers)&&(e.gutterMarkers=null),1})})}),lineInfo:function(e){var t;if("number"==typeof e){if(!tt(this,e))return null;if(!(e=Xe(this,t=e)))return null}else if(null==(t=Ze(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:Ri(function(e,n,i){return eo(this,e,"gutter"==n?"gutter":"class",function(e){var t="text"==n?"textClass":"background"==n?"bgClass":"gutter"==n?"gutterClass":"wrapClass";if(e[t]){if(k(i).test(e[t]))return;e[t]+=" "+i}else e[t]=i;return 1})}),removeLineClass:Ri(function(e,o,s){return eo(this,e,"gutter"==o?"gutter":"class",function(e){var t="text"==o?"textClass":"background"==o?"bgClass":"gutter"==o?"gutterClass":"wrapClass",n=e[t];if(n){if(null==s)e[t]=null;else{var i=n.match(k(s));if(!i)return;var r=i.index+i[0].length;e[t]=n.slice(0,i.index)+(i.index&&r!=n.length?" ":"")+n.slice(r)||null}return 1}})}),addLineWidget:Ri(function(e,t,n){return e=e,r=new io(i=this,t,n),(o=i.cm)&&r.noHScroll&&(o.display.alignWidgets=!0),eo(i,e,"widget",function(e){var t=e.widgets||(e.widgets=[]);return null==r.insertAt?t.push(r):t.splice(Math.min(t.length-1,Math.max(0,r.insertAt)),0,r),r.line=e,o&&!Kt(i,e)&&(t=Ut(e)<i.scrollTop,Qe(e,e.height+gn(r)),t&&_i(o,r.height),o.curOp.forceUpdate=!0),1}),o&&sn(o,"lineWidgetAdded",o,r,"number"==typeof e?e:Ze(e)),r;var i,r,o}),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return ao(this,dt(this,e),dt(this,t),n,n&&n.type||"range")},setBookmark:function(e,t){t={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return ao(this,e=dt(this,e),e,t,"bookmark")},findMarksAt:function(e){var t=[],n=Xe(this,(e=dt(this,e)).line).markedSpans;if(n)for(var i=0;i<n.length;++i){var r=n[i];(null==r.from||r.from<=e.ch)&&(null==r.to||r.to>=e.ch)&&t.push(r.marker.parent||r.marker)}return t},findMarks:function(r,o,s){r=dt(this,r),o=dt(this,o);var a=[],l=r.line;return this.iter(r.line,o.line+1,function(e){var t=e.markedSpans;if(t)for(var n=0;n<t.length;n++){var i=t[n];null!=i.to&&l==r.line&&r.ch>=i.to||null==i.from&&l!=r.line||null!=i.from&&l==o.line&&i.from>=o.ch||s&&!s(i.marker)||a.push(i.marker.parent||i.marker)}++l}),a},getAllMarks:function(){var i=[];return this.iter(function(e){var t=e.markedSpans;if(t)for(var n=0;n<t.length;++n)null!=t[n].from&&i.push(t[n].marker)}),i},posFromIndex:function(t){var n,i=this.first,r=this.lineSeparator().length;return this.iter(function(e){e=e.text.length+r;if(t<e)return n=t,!0;t-=e,++i}),dt(this,it(i,n))},indexFromPos:function(e){var t=(e=dt(this,e)).ch;if(e.line<this.first||e.ch<0)return 0;var n=this.lineSeparator().length;return this.iter(this.first,e.line,function(e){t+=e.text.length+n}),t},copy:function(e){var t=new uo(Ye(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e=e||{};var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);t=new uo(Ye(this,t,n),e.mode||this.modeOption,t,this.lineSep,this.direction);return e.sharedHist&&(t.history=this.history),(this.linked||(this.linked=[])).push({doc:t,sharedHist:e.sharedHist}),t.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],function(e,t){for(var n=0;n<t.length;n++){var i=t[n],r=i.find(),o=e.clipPos(r.from),r=e.clipPos(r.to);rt(o,r)&&(r=ao(e,o,r,i.primary,i.primary.type),i.markers.push(r),r.parent=i)}}(t,co(this)),t},unlinkDoc:function(e){var t;if(e instanceof cs&&(e=e.doc),this.linked)for(var n=0;n<this.linked.length;++n)if(this.linked[n].doc==e){this.linked.splice(n,1),e.unlinkDoc(this),function(o){for(var e=0;e<o.length;e++)!function(e){var t=o[e],n=[t.primary.doc];mr(t.primary.doc,function(e){return n.push(e)});for(var i=0;i<t.markers.length;i++){var r=t.markers[i];-1==R(n,r.doc)&&(r.parent=null,t.markers.splice(i--,1))}}(e)}(co(this));break}e.history==this.history&&(t=[e.id],mr(e,function(e){return t.push(e.id)},!0),e.history=new _r(null),e.history.done=jr(this.history.done,t),e.history.undone=jr(this.history.undone,t))},iterLinkedDocs:function(e){mr(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):Fe(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:Ri(function(e){var t;"rtl"!=e&&(e="ltr"),e!=this.direction&&(this.direction=e,this.iter(function(e){return e.order=null}),this.cm&&Fi(t=this.cm,function(){yr(t),ti(t)}))})}),uo.prototype.eachLine=uo.prototype.iter;var fo=0;function po(e){var i=this;if(go(i),!ke(i,e)&&!mn(i.display,e)){Te(e),v&&(fo=+new Date);var r=Zn(i,e,!0),t=e.dataTransfer.files;if(r&&!i.isReadOnly())if(t&&t.length&&window.FileReader&&window.File)for(var o=t.length,s=Array(o),a=0,n=0;n<o;++n)!function(e,t){var n;i.options.allowDropFileTypes&&-1==R(i.options.allowDropFileTypes,e.type)||((n=new FileReader).onload=Di(i,function(){var e=n.result;/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),s[t]=e,++a==o&&(e={from:r=dt(i.doc,r),to:r,text:i.doc.splitLines(s.join(i.doc.lineSeparator())),origin:"paste"},Vr(i.doc,e),Pr(i.doc,ar(r,lr(e))))}),n.readAsText(e))}(t[n],n);else{if(i.state.draggingText&&-1<i.doc.sel.contains(r))return i.state.draggingText(e),void setTimeout(function(){return i.display.input.focus()},20);try{var l,c=e.dataTransfer.getData("Text");if(c){if(i.state.draggingText&&!i.state.draggingText.copy&&(l=i.listSelections()),Dr(i.doc,ar(r,r)),l)for(var d=0;d<l.length;++d)Jr(i.doc,"",l[d].anchor,l[d].head,"drag");i.replaceSelection(c,"around","paste"),i.display.input.focus()}}catch(e){}}}}function go(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function mo(t){if(document.getElementsByClassName){for(var e=document.getElementsByClassName("CodeMirror"),n=[],i=0;i<e.length;i++){var r=e[i].CodeMirror;r&&n.push(r)}n.length&&n[0].operation(function(){for(var e=0;e<n.length;e++)t(n[e])})}}var vo=!1;function yo(){var e;vo||(ye(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,mo(_o)},100))}),ye(window,"blur",function(){return mo(pi)}),vo=!0)}function _o(e){var t=e.display;t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize()}for(var xo={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},bo=0;bo<10;bo++)xo[bo+48]=xo[bo+96]=String(bo);for(var ko=65;ko<=90;ko++)xo[ko]=String.fromCharCode(ko);for(var Co=1;Co<=12;Co++)xo[Co+111]=xo[Co+63235]="F"+Co;var wo={};function So(e){var t,n,i,r,o=e.split(/-(?!$)/);e=o[o.length-1];for(var s=0;s<o.length-1;s++){var a=o[s];if(/^(cmd|meta|m)$/i.test(a))r=!0;else if(/^a(lt)?$/i.test(a))t=!0;else if(/^(c|ctrl|control)$/i.test(a))n=!0;else{if(!/^s(hift)?$/i.test(a))throw new Error("Unrecognized modifier name: "+a);i=!0}}return t&&(e="Alt-"+e),n&&(e="Ctrl-"+e),r&&(e="Cmd-"+e),i&&(e="Shift-"+e),e}function To(e){var t,n,i={};for(t in e)if(e.hasOwnProperty(t)){var r=e[t];if(!/^(name|fallthrough|(de|at)tach)$/.test(t))if("..."!=r){for(var o=$(t.split(" "),So),s=0;s<o.length;s++){var a=void 0,l=void 0,a=s==o.length-1?(l=o.join(" "),r):(l=o.slice(0,s+1).join(" "),"..."),c=i[l];if(c){if(c!=a)throw new Error("Inconsistent bindings for "+l)}else i[l]=a}delete e[t]}else delete e[t]}for(n in i)e[n]=i[n];return e}function Lo(e,t,n,i){var r=(t=Oo(t)).call?t.call(e,i):t[e];if(!1===r)return"nothing";if("..."===r)return"multi";if(null!=r&&n(r))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return Lo(e,t.fallthrough,n,i);for(var o=0;o<t.fallthrough.length;o++){var s=Lo(e,t.fallthrough[o],n,i);if(s)return s}}}function jo(e){e="string"==typeof e?e:xo[e.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function Ao(e,t,n){var i=e;return t.altKey&&"Alt"!=i&&(e="Alt-"+e),(x?t.metaKey:t.ctrlKey)&&"Ctrl"!=i&&(e="Ctrl-"+e),(x?t.ctrlKey:t.metaKey)&&"Cmd"!=i&&(e="Cmd-"+e),!n&&t.shiftKey&&"Shift"!=i&&(e="Shift-"+e),e}function Mo(e,t){if(p&&34==e.keyCode&&e.char)return!1;var n=xo[e.keyCode];return null!=n&&!e.altGraphKey&&(3==e.keyCode&&e.code&&(n=e.code),Ao(n,e,t))}function Oo(e){return"string"==typeof e?wo[e]:e}function Eo(t,e){for(var n=t.doc.sel.ranges,i=[],r=0;r<n.length;r++){for(var o=e(n[r]);i.length&&rt(o.from,G(i).to)<=0;){var s=i.pop();if(rt(s.from,o.from)<0){o.from=s.from;break}}i.push(o)}Fi(t,function(){for(var e=i.length-1;0<=e;e--)Jr(t.doc,"",i[e].from,i[e].to,"+delete");xi(t)})}function No(e,t,n){n=ie(e.text,t+n,n);return n<0||n>e.text.length?null:n}function Po(e,t,n){e=No(e,t.ch,n);return null==e?null:new it(t.line,e,n<0?"after":"before")}function Fo(e,t,n,i,r){if(e){var o=me(n,t.doc.direction);if(o){var s,a,l,e=r<0?G(o):o[0],o=r<0==(1==e.level)?"after":"before";return 0<e.level||"rtl"==t.doc.direction?(s=Tn(t,n),a=r<0?n.text.length-1:0,l=Ln(t,s,a).top,a=re(function(e){return Ln(t,s,e).top==l},r<0==(1==e.level)?e.from:e.to-1,a),"before"==o&&(a=No(n,a,1))):a=r<0?e.to:e.from,new it(i,a,o)}}return new it(i,r<0?n.text.length:0,r<0?"before":"after")}function Do(t,n,a,e){var l=me(n,t.doc.direction);if(!l)return Po(n,a,e);a.ch>=n.text.length?(a.ch=n.text.length,a.sticky="before"):a.ch<=0&&(a.ch=0,a.sticky="after");var i=se(l,a.ch,a.sticky),r=l[i];if("ltr"==t.doc.direction&&r.level%2==0&&(0<e?r.to>a.ch:r.from<a.ch))return Po(n,a,e);function c(e,t){return No(n,e instanceof it?e.ch:e,t)}function o(e){return t.options.lineWrapping?(s=s||Tn(t,n),Vn(t,n,s,e)):{begin:0,end:n.text.length}}var s,d=o("before"==a.sticky?c(a,-1):a.ch);if("rtl"==t.doc.direction||1==r.level){var h=1==r.level==e<0,u=c(a,h?1:-1);if(null!=u&&(h?u<=r.to&&u<=d.end:u>=r.from&&u>=d.begin)){var f=h?"before":"after";return new it(a.line,u,f)}}f=function(e,t,n){for(var i=function(e,t){return t?new it(a.line,c(e,1),"before"):new it(a.line,e,"after")};0<=e&&e<l.length;e+=t){var r=l[e],o=0<t==(1!=r.level),s=o?n.begin:c(n.end,-1);if(r.from<=s&&s<r.to)return i(s,o);if(s=o?r.from:c(r.to,-1),n.begin<=s&&s<n.end)return i(s,o)}},i=f(i+e,e,d);if(i)return i;d=0<e?d.end:c(d.begin,-1);return null==d||0<e&&d==n.text.length||!(i=f(0<e?0:l.length-1,e,o(d)))?null:i}wo.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},wo.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},wo.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},wo.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},wo.default=g?wo.macDefault:wo.pcDefault;var Io={selectAll:Ur,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),W)},killLine:function(n){return Eo(n,function(e){if(e.empty()){var t=Xe(n.doc,e.head.line).text.length;return e.head.ch==t&&e.head.line<n.lastLine()?{from:e.head,to:it(e.head.line+1,0)}:{from:e.head,to:it(e.head.line,t)}}return{from:e.from(),to:e.to()}})},deleteLine:function(t){return Eo(t,function(e){return{from:it(e.from().line,0),to:dt(t.doc,it(e.to().line+1,0))}})},delLineLeft:function(e){return Eo(e,function(e){return{from:it(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(n){return Eo(n,function(e){var t=n.charCoords(e.head,"div").top+5;return{from:n.coordsChar({left:0,top:t},"div"),to:e.from()}})},delWrappedLineRight:function(n){return Eo(n,function(e){var t=n.charCoords(e.head,"div").top+5,t=n.coordsChar({left:n.display.lineDiv.offsetWidth+100,top:t},"div");return{from:e.from(),to:t}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(it(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(it(e.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(e){return Ro(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(e){return Ho(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy(function(e){return function(e,t){var n=Xe(e.doc,t),i=function(e){for(var t;t=It(e);)e=t.find(1,!0).line;return e}(n);i!=n&&(t=Ze(i));return Fo(!0,e,n,t,-1)}(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:e},"div")},U)},goLineLeft:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:e},"div")},U)},goLineLeftSmart:function(n){return n.extendSelectionsBy(function(e){var t=n.cursorCoords(e.head,"div").top+5,t=n.coordsChar({left:0,top:t},"div");return t.ch<n.getLine(t.line).search(/\S/)?Ho(n,e.head):t},U)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"char")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),i=e.options.tabSize,r=0;r<n.length;r++){var o=n[r].from(),o=D(e.getLine(o.line),o.ch,i);t.push(q(i-o%i))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(s){return Fi(s,function(){for(var e,t,n,i=s.listSelections(),r=[],o=0;o<i.length;o++)i[o].empty()&&(e=i[o].head,(t=Xe(s.doc,e.line).text)&&(e.ch==t.length&&(e=new it(e.line,e.ch-1)),0<e.ch?(e=new it(e.line,e.ch+1),s.replaceRange(t.charAt(e.ch-1)+t.charAt(e.ch-2),it(e.line,e.ch-2),e,"+transpose")):e.line>s.doc.first&&((n=Xe(s.doc,e.line-1).text)&&(e=new it(e.line,1),s.replaceRange(t.charAt(0)+s.doc.lineSeparator()+n.charAt(n.length-1),it(e.line-1,n.length-1),e,"+transpose")))),r.push(new or(e,e)));s.setSelections(r)})},newlineAndIndent:function(i){return Fi(i,function(){for(var e=i.listSelections(),t=e.length-1;0<=t;t--)i.replaceRange(i.doc.lineSeparator(),e[t].anchor,e[t].head,"+input");e=i.listSelections();for(var n=0;n<e.length;n++)i.indentLine(e[n].from().line,null,!0);xi(i)})},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}};function Ro(e,t){var n=Xe(e.doc,t),i=Ht(n);return i!=n&&(t=Ze(i)),Fo(!0,e,i,t,1)}function Ho(e,t){var n=Ro(e,t.line),i=Xe(e.doc,n.line),e=me(i,e.doc.direction);if(e&&0!=e[0].level)return n;i=Math.max(0,i.text.search(/\S/)),t=t.line==n.line&&t.ch<=i&&t.ch;return it(n.line,t?0:i,n.sticky)}function Bo(e,t,n){if("string"==typeof t&&!(t=Io[t]))return!1;e.display.input.ensurePolled();var i=e.display.shift,r=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),r=t(e)!=B}finally{e.display.shift=i,e.state.suppressEdits=!1}return r}var Wo=new I;function Ko(e,t,n,i){var r=e.state.keySeq;if(r){if(jo(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:Wo.set(50,function(){e.state.keySeq==r&&(e.state.keySeq=null,e.display.input.reset())}),Uo(e,r+" "+t,n,i))return!0}return Uo(e,t,n,i)}function Uo(e,t,n,i){i=function(e,t,n){for(var i=0;i<e.state.keyMaps.length;i++){var r=Lo(t,e.state.keyMaps[i],n,e);if(r)return r}return e.options.extraKeys&&Lo(t,e.options.extraKeys,n,e)||Lo(t,e.options.keyMap,n,e)}(e,t,i);return"multi"==i&&(e.state.keySeq=t),"handled"==i&&sn(e,"keyHandled",e,t,n),"handled"!=i&&"multi"!=i||(Te(n),di(e)),!!i}function zo(t,e){var n=Mo(e,!0);return!!n&&(e.shiftKey&&!t.state.keySeq?Ko(t,"Shift-"+n,e,function(e){return Bo(t,e,!0)})||Ko(t,n,e,function(e){if("string"==typeof e?/^go[A-Z]/.test(e):e.motion)return Bo(t,e)}):Ko(t,n,e,function(e){return Bo(t,e)}))}var Vo=null;function qo(e){var t,n,i,r=this;function o(e){18!=e.keyCode&&e.altKey||(w(i,"CodeMirror-crosshair"),xe(document,"keyup",o),xe(document,"mouseover",o))}r.curOp.focus=M(),ke(r,e)||(v&&y<11&&27==e.keyCode&&(e.returnValue=!1),t=e.keyCode,r.display.shift=16==t||e.shiftKey,n=zo(r,e),p&&(Vo=n?t:null,!n&&88==t&&!Ie&&(g?e.metaKey:e.ctrlKey)&&r.replaceSelection("",null,"cut")),18!=t||/\bCodeMirror-crosshair\b/.test(r.display.lineDiv.className)||(O(i=r.display.lineDiv,"CodeMirror-crosshair"),ye(document,"keyup",o),ye(document,"mouseover",o)))}function Go(e){16==e.keyCode&&(this.doc.sel.shift=!1),ke(this,e)}function $o(e){var t=this;if(!(mn(t.display,e)||ke(t,e)||e.ctrlKey&&!e.altKey||g&&e.metaKey)){var n,i=e.keyCode,r=e.charCode;if(p&&i==Vo)return Vo=null,void Te(e);p&&(!e.which||e.which<10)&&zo(t,e)||"\b"!=(r=String.fromCharCode(null==r?i:r))&&(Ko(n=t,"'"+r+"'",e,function(e){return Bo(n,e,!0)})||t.display.input.onKeyPress(e))}}var Xo,Jo,Yo=function(e,t,n){this.time=e,this.pos=t,this.button=n};function Qo(e){var t,n,i,r,o,s=this,a=s.display;ke(s,e)||a.activeTouch&&a.input.supportsTouch()||(a.input.ensurePolled(),a.shift=e.shiftKey,mn(a,e)?f||(a.scroller.draggable=!1,setTimeout(function(){return a.scroller.draggable=!0},100)):ts(s,e)||(t=Zn(s,e),n=Oe(e),r=t?(i=t,r=n,o=+new Date,Jo&&Jo.compare(o,i,r)?(Xo=Jo=null,"triple"):Xo&&Xo.compare(o,i,r)?(Jo=new Yo(o,i,r),Xo=null,"double"):(Xo=new Yo(o,i,r),Jo=null,"single")):"single",window.focus(),1==n&&s.state.selectingText&&s.state.selectingText(e),t&&function(n,e,i,t,r){var o="Click";"double"==t?o="Double"+o:"triple"==t&&(o="Triple"+o);return Ko(n,Ao(o=(1==e?"Left":2==e?"Middle":"Right")+o,r),r,function(e){if("string"==typeof e&&(e=Io[e]),!e)return!1;var t=!1;try{n.isReadOnly()&&(n.state.suppressEdits=!0),t=e(n,i)!=B}finally{n.state.suppressEdits=!1}return t})}(s,n,t,r,e)||(1==n?t?function(e,t,n,i){v?setTimeout(P(hi,e),0):e.curOp.focus=M();var r,o=function(e,t,n){var i=e.getOption("configureMouse"),r=i?i(e,t,n):{};null==r.unit&&(i=m?n.shiftKey&&n.metaKey:n.altKey,r.unit=i?"rectangle":"single"==t?"char":"double"==t?"word":"line");null!=r.extend&&!e.doc.extend||(r.extend=e.doc.extend||n.shiftKey);null==r.addNew&&(r.addNew=g?n.metaKey:n.ctrlKey);null==r.moveOnDrag&&(r.moveOnDrag=!(g?n.altKey:n.ctrlKey));return r}(e,n,i),s=e.doc.sel;(e.options.dragDrop&&Pe&&!e.isReadOnly()&&"single"==n&&-1<(r=s.contains(t))&&(rt((r=s.ranges[r]).from(),t)<0||0<t.xRel)&&(0<rt(r.to(),t)||t.xRel<0)?function(t,n,i,r){var o=t.display,s=!1,a=Di(t,function(e){f&&(o.scroller.draggable=!1),t.state.draggingText=!1,xe(o.wrapper.ownerDocument,"mouseup",a),xe(o.wrapper.ownerDocument,"mousemove",l),xe(o.scroller,"dragstart",c),xe(o.scroller,"drop",a),s||(Te(e),r.addNew||Mr(t.doc,i,null,null,r.extend),f||v&&9==y?setTimeout(function(){o.wrapper.ownerDocument.body.focus(),o.input.focus()},20):o.input.focus())}),l=function(e){s=s||10<=Math.abs(n.clientX-e.clientX)+Math.abs(n.clientY-e.clientY)},c=function(){return s=!0};f&&(o.scroller.draggable=!0);(t.state.draggingText=a).copy=!r.moveOnDrag,o.scroller.dragDrop&&o.scroller.dragDrop();ye(o.wrapper.ownerDocument,"mouseup",a),ye(o.wrapper.ownerDocument,"mousemove",l),ye(o.scroller,"dragstart",c),ye(o.scroller,"drop",a),ui(t),setTimeout(function(){return o.input.focus()},20)}:function(u,e,f,p){var s=u.display,g=u.doc;Te(e);var m,v,y=g.sel,t=y.ranges;p.addNew&&!p.extend?(v=g.sel.contains(f),m=-1<v?t[v]:new or(f,f)):(m=g.sel.primary(),v=g.sel.primIndex);"rectangle"==p.unit?(p.addNew||(m=new or(f,f)),f=Zn(u,e,!0,!0),v=-1):(e=Zo(u,f,p.unit),m=p.extend?Ar(m,e.anchor,e.head,p.extend):e);p.addNew?-1==v?(v=t.length,Fr(g,sr(u,t.concat([m]),v),{scroll:!1,origin:"*mouse"})):1<t.length&&t[v].empty()&&"char"==p.unit&&!p.extend?(Fr(g,sr(u,t.slice(0,v).concat(t.slice(v+1)),0),{scroll:!1,origin:"*mouse"}),y=g.sel):Er(g,v,m,K):(Fr(g,new rr([m],v=0),K),y=g.sel);var _=f;function a(e){if(0!=rt(_,e))if(_=e,"rectangle"==p.unit){for(var t=[],n=u.options.tabSize,i=D(Xe(g,f.line).text,f.ch,n),r=D(Xe(g,e.line).text,e.ch,n),o=Math.min(i,r),s=Math.max(i,r),a=Math.min(f.line,e.line),l=Math.min(u.lastLine(),Math.max(f.line,e.line));a<=l;a++){var c=Xe(g,a).text,d=z(c,o,n);o==s?t.push(new or(it(a,d),it(a,d))):c.length>d&&t.push(new or(it(a,d),it(a,z(c,s,n))))}t.length||t.push(new or(f,f)),Fr(g,sr(u,y.ranges.slice(0,v).concat(t),v),{origin:"*mouse",scroll:!1}),u.scrollIntoView(e)}else{var h,i=m,r=Zo(u,e,p.unit),e=i.anchor,e=0<rt(r.anchor,e)?(h=r.head,lt(i.from(),r.anchor)):(h=r.anchor,at(i.to(),r.head)),r=y.ranges.slice(0);r[v]=function(e,t){var n=t.anchor,i=t.head,r=Xe(e.doc,n.line);if(0==rt(n,i)&&n.sticky==i.sticky)return t;var o=me(r);if(!o)return t;var s=se(o,n.ch,n.sticky),a=o[s];if(a.from!=n.ch&&a.to!=n.ch)return t;r=s+(a.from==n.ch==(1!=a.level)?0:1);if(0==r||r==o.length)return t;l=i.line!=n.line?0<(i.line-n.line)*("ltr"==e.doc.direction?1:-1):(e=se(o,i.ch,i.sticky),l=e-s||(i.ch-n.ch)*(1==a.level?-1:1),e==r-1||e==r?l<0:0<l);var r=o[r+(l?-1:0)],l=l==(1==r.level),r=l?r.from:r.to,l=l?"after":"before";return n.ch==r&&n.sticky==l?t:new or(new it(n.line,r,l),i)}(u,new or(dt(g,e),h)),Fr(g,sr(u,r,v),K)}}var l=s.wrapper.getBoundingClientRect(),c=0;function n(e){u.state.selectingText=!1,c=1/0,e&&(Te(e),s.input.focus()),xe(s.wrapper.ownerDocument,"mousemove",i),xe(s.wrapper.ownerDocument,"mouseup",r),g.history.lastSelOrigin=null}var i=Di(u,function(e){(0!==e.buttons&&Oe(e)?function e(t){var n,i,r=++c,o=Zn(u,t,!0,"rectangle"==p.unit);o&&(0!=rt(o,_)?(u.curOp.focus=M(),a(o),n=vi(s,g),(o.line>=n.to||o.line<n.from)&&setTimeout(Di(u,function(){c==r&&e(t)}),150)):(i=t.clientY<l.top?-20:t.clientY>l.bottom?20:0)&&setTimeout(Di(u,function(){c==r&&(s.scroller.scrollTop+=i,e(t))}),50))}:n)(e)}),r=Di(u,n);u.state.selectingText=r,ye(s.wrapper.ownerDocument,"mousemove",i),ye(s.wrapper.ownerDocument,"mouseup",r)})(e,i,t,o)}(s,t,r,e):Me(e)==a.scroller&&Te(e):2==n?(t&&Mr(s.doc,t),setTimeout(function(){return a.input.focus()},20)):3==n&&(b?s.display.input.onContextMenu(e):ui(s)))))}function Zo(e,t,n){if("char"==n)return new or(t,t);if("word"==n)return e.findWordAt(t);if("line"==n)return new or(it(t.line,0),dt(e.doc,it(t.line+1,0)));t=n(e,t);return new or(t.from,t.to)}function es(e,t,n,i){var r,o;if(t.touches)r=t.touches[0].clientX,o=t.touches[0].clientY;else try{r=t.clientX,o=t.clientY}catch(t){return!1}if(r>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;i&&Te(t);var s=e.display,i=s.lineDiv.getBoundingClientRect();if(o>i.bottom||!we(e,n))return je(t);o-=i.top-s.viewOffset;for(var a=0;a<e.display.gutterSpecs.length;++a){var l=s.gutters.childNodes[a];if(l&&l.getBoundingClientRect().right>=r)return be(e,n,e,et(e.doc,o),e.display.gutterSpecs[a].className,t),je(t)}}function ts(e,t){return es(e,t,"gutterClick",!0)}function ns(e,t){var n,i;mn(e.display,t)||(i=t,we(n=e,"gutterContextMenu")&&es(n,i,"gutterContextMenu",!1))||ke(e,t,"contextmenu")||b||e.display.input.onContextMenu(t)}function is(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Nn(e)}Yo.prototype.compare=function(e,t,n){return this.time+400>e&&0==rt(t,this.pos)&&n==this.button};var rs={toString:function(){return"CodeMirror.Init"}},os={},ss={};function as(e,t,n){!t!=!(n&&n!=rs)&&(n=e.display.dragFunctions,(t=t?ye:xe)(e.display.scroller,"dragstart",n.start),t(e.display.scroller,"dragenter",n.enter),t(e.display.scroller,"dragover",n.over),t(e.display.scroller,"dragleave",n.leave),t(e.display.scroller,"drop",n.drop))}function ls(e){e.options.lineWrapping?(O(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(w(e.display.wrapper,"CodeMirror-wrap"),Vt(e)),Qn(e),ti(e),Nn(e),setTimeout(function(){return ji(e)},100)}function cs(e,t){var n=this;if(!(this instanceof cs))return new cs(e,t);this.options=t=t?F(t):{},F(os,t,!1);var i=t.value;"string"==typeof i?i=new uo(i,t.mode,null,t.lineSeparator,t.direction):t.mode&&(i.modeOption=t.mode),this.doc=i;var r,o=new cs.inputStyles[t.inputStyle](this),o=this.display=new Qi(e,i,o,t);for(r in is(o.wrapper.CodeMirror=this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Oi(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new I,keySeq:null,specialChars:null},t.autofocus&&!h&&o.input.focus(),v&&y<11&&setTimeout(function(){return n.display.input.reset(!0)},20),function(i){var r=i.display;ye(r.scroller,"mousedown",Di(i,Qo)),ye(r.scroller,"dblclick",v&&y<11?Di(i,function(e){var t;ke(i,e)||(!(t=Zn(i,e))||ts(i,e)||mn(i.display,e)||(Te(e),t=i.findWordAt(t),Mr(i.doc,t.anchor,t.head)))}):function(e){return ke(i,e)||Te(e)});ye(r.scroller,"contextmenu",function(e){return ns(i,e)});var n,o={end:0};function s(){r.activeTouch&&(n=setTimeout(function(){return r.activeTouch=null},1e3),(o=r.activeTouch).end=+new Date)}function a(e,t){if(null==t.left)return 1;var n=t.left-e.left,e=t.top-e.top;return 400<n*n+e*e}ye(r.scroller,"touchstart",function(e){var t;ke(i,e)||function(e){if(1==e.touches.length){e=e.touches[0];return e.radiusX<=1&&e.radiusY<=1}}(e)||ts(i,e)||(r.input.ensurePolled(),clearTimeout(n),t=+new Date,r.activeTouch={start:t,moved:!1,prev:t-o.end<=300?o:null},1==e.touches.length&&(r.activeTouch.left=e.touches[0].pageX,r.activeTouch.top=e.touches[0].pageY))}),ye(r.scroller,"touchmove",function(){r.activeTouch&&(r.activeTouch.moved=!0)}),ye(r.scroller,"touchend",function(e){var t,n=r.activeTouch;n&&!mn(r,e)&&null!=n.left&&!n.moved&&new Date-n.start<300&&(t=i.coordsChar(r.activeTouch,"page"),t=!n.prev||a(n,n.prev)?new or(t,t):!n.prev.prev||a(n,n.prev.prev)?i.findWordAt(t):new or(it(t.line,0),dt(i.doc,it(t.line+1,0))),i.setSelection(t.anchor,t.head),i.focus(),Te(e)),s()}),ye(r.scroller,"touchcancel",s),ye(r.scroller,"scroll",function(){r.scroller.clientHeight&&(wi(i,r.scroller.scrollTop),Ti(i,r.scroller.scrollLeft,!0),be(i,"scroll",i))}),ye(r.scroller,"mousewheel",function(e){return ir(i,e)}),ye(r.scroller,"DOMMouseScroll",function(e){return ir(i,e)}),ye(r.wrapper,"scroll",function(){return r.wrapper.scrollTop=r.wrapper.scrollLeft=0}),r.dragFunctions={enter:function(e){ke(i,e)||Ae(e)},over:function(e){var t,n;ke(i,e)||((n=Zn(t=i,n=e))&&(li(t,n,n=document.createDocumentFragment()),t.display.dragCursor||(t.display.dragCursor=L("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),T(t.display.dragCursor,n)),Ae(e))},start:function(e){return t=i,n=e,void(v&&(!t.state.draggingText||+new Date-fo<100)?Ae(n):ke(t,n)||mn(t.display,n)||(n.dataTransfer.setData("Text",t.getSelection()),n.dataTransfer.effectAllowed="copyMove",n.dataTransfer.setDragImage&&!l&&((e=L("img",null,null,"position: fixed; left: 0; top: 0;")).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",p&&(e.width=e.height=1,t.display.wrapper.appendChild(e),e._top=e.offsetTop),n.dataTransfer.setDragImage(e,0,0),p&&e.parentNode.removeChild(e))));var t,n},drop:Di(i,po),leave:function(e){ke(i,e)||go(i)}};var e=r.input.getField();ye(e,"keyup",function(e){return Go.call(i,e)}),ye(e,"keydown",Di(i,qo)),ye(e,"keypress",Di(i,$o)),ye(e,"focus",function(e){return fi(i,e)}),ye(e,"blur",function(e){return pi(i,e)})}(this),yo(),Ni(this),this.curOp.forceUpdate=!0,vr(this,i),t.autofocus&&!h||this.hasFocus()?setTimeout(P(fi,this),20):pi(this),ss)ss.hasOwnProperty(r)&&ss[r](n,t[r],rs);$i(this),t.finishInit&&t.finishInit(this);for(var s=0;s<ds.length;++s)ds[s](n);Pi(this),f&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(o.lineDiv).textRendering&&(o.lineDiv.style.textRendering="auto")}cs.defaults=os,cs.optionHandlers=ss;var ds=[];function hs(e,t,n,i){var r,o=e.doc;null==n&&(n="add"),"smart"==n&&(o.mode.indent?r=mt(e,t).state:n="prev");var s=e.options.tabSize,a=Xe(o,t),l=D(a.text,null,s);a.stateAfter&&(a.stateAfter=null);var c,d=a.text.match(/^\s*/)[0];if(i||/\S/.test(a.text)){if("smart"==n&&((c=o.mode.indent(r,a.text.slice(d.length),a.text))==B||150<c)){if(!i)return;n="prev"}}else c=0,n="not";"prev"==n?c=t>o.first?D(Xe(o,t-1).text,null,s):0:"add"==n?c=l+e.options.indentUnit:"subtract"==n?c=l-e.options.indentUnit:"number"==typeof n&&(c=l+n),c=Math.max(0,c);var h="",u=0;if(e.options.indentWithTabs)for(var f=Math.floor(c/s);f;--f)u+=s,h+="\t";if(u<c&&(h+=q(c-u)),h!=d)return Jr(o,h,it(t,0),it(t,d.length),"+input"),!(a.stateAfter=null);for(var p=0;p<o.sel.ranges.length;p++){var g=o.sel.ranges[p];if(g.head.line==t&&g.head.ch<d.length){g=it(t,d.length);Er(o,p,new or(g,g));break}}}cs.defineInitHook=function(e){return ds.push(e)};var us=null;function fs(e){us=e}function ps(e,t,n,i,r){var o=e.doc;e.display.shift=!1,i=i||o.sel;var s=+new Date-200,a="paste"==r||e.state.pasteIncoming>s,l=Fe(t),c=null;if(a&&1<i.ranges.length)if(us&&us.text.join("\n")==t){if(i.ranges.length%us.text.length==0){c=[];for(var d=0;d<us.text.length;d++)c.push(o.splitLines(us.text[d]))}}else l.length==i.ranges.length&&e.options.pasteLinesPerSelection&&(c=$(l,function(e){return[e]}));for(var h=e.curOp.updateInput,u=i.ranges.length-1;0<=u;u--){var f=i.ranges[u],p=f.from(),g=f.to();f.empty()&&(n&&0<n?p=it(p.line,p.ch-n):e.state.overwrite&&!a?g=it(g.line,Math.min(Xe(o,g.line).text.length,g.ch+G(l).length)):a&&us&&us.lineWise&&us.text.join("\n")==t&&(p=g=it(p.line,0)));g={from:p,to:g,text:c?c[u%c.length]:l,origin:r||(a?"paste":e.state.cutIncoming>s?"cut":"+input")};Vr(e.doc,g),sn(e,"inputRead",e,g)}t&&!a&&ms(e,t),xi(e),e.curOp.updateInput<2&&(e.curOp.updateInput=h),e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=-1}function gs(e,t){var n=e.clipboardData&&e.clipboardData.getData("Text");return n&&(e.preventDefault(),t.isReadOnly()||t.options.disableInput||Fi(t,function(){return ps(t,n,0,null,"paste")}),1)}function ms(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var n=e.doc.sel,i=n.ranges.length-1;0<=i;i--){var r=n.ranges[i];if(!(100<r.head.ch||i&&n.ranges[i-1].head.line==r.head.line)){var o=e.getModeAt(r.head),s=!1;if(o.electricChars){for(var a=0;a<o.electricChars.length;a++)if(-1<t.indexOf(o.electricChars.charAt(a))){s=hs(e,r.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(Xe(e.doc,r.head.line).text.slice(0,r.head.ch))&&(s=hs(e,r.head.line,"smart"));s&&sn(e,"electricInput",e,r.head.line)}}}function vs(e){for(var t=[],n=[],i=0;i<e.doc.sel.ranges.length;i++){var r=e.doc.sel.ranges[i].head.line,r={anchor:it(r,0),head:it(r+1,0)};n.push(r),t.push(e.getRange(r.anchor,r.head))}return{text:t,ranges:n}}function ys(e,t,n,i){e.setAttribute("autocorrect",n?"":"off"),e.setAttribute("autocapitalize",i?"":"off"),e.setAttribute("spellcheck",!!t)}function _s(){var e=L("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=L("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return f?e.style.width="1000px":e.setAttribute("wrap","off"),a&&(e.style.border="1px solid black"),ys(e),t}function xs(i,r,o,e,s){var t=r,n=o,a=Xe(i,r.line);function l(e){var t,n=s?Do(i.cm,a,r,o):Po(a,r,o);if(null==n){if(e||(t=r.line+o)<i.first||t>=i.first+i.size||(r=new it(t,r.ch,r.sticky),!(a=Xe(i,t))))return;r=Fo(s,i.cm,a,r.line,o)}else r=n;return 1}if("char"==e)l();else if("column"==e)l(!0);else if("word"==e||"group"==e)for(var c=null,d="group"==e,h=i.cm&&i.cm.getHelper(r,"wordChars"),u=!0;!(o<0)||l(!u);u=!1){var f=a.text.charAt(r.ch)||"\n",f=Z(f,h)?"w":d&&"\n"==f?"n":!d||/\s/.test(f)?null:"p";if(!d||u||f||(f="s"),c&&c!=f){o<0&&(o=1,l(),r.sticky="after");break}if(f&&(c=f),0<o&&!l(!u))break}n=Wr(i,r,t,n,!0);return ot(t,n)&&(n.hitSide=!0),n}function bs(e,t,n,i){var r,o,s,a=e.doc,l=t.left;for("page"==i?(r=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),r=Math.max(r-.5*Gn(e.display),3),o=(0<n?t.bottom:t.top)+n*r):"line"==i&&(o=0<n?t.bottom+3:t.top-3);(s=Un(e,l,o)).outside;){if(n<0?o<=0:o>=a.height){s.hitSide=!0;break}o+=5*n}return s}e=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new I,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function ks(e,t){var n=Sn(e,t.line);if(!n||n.hidden)return null;var i=Xe(e.doc,t.line),n=Cn(n,i,t.line),i=me(i,e.doc.direction),e="left";i&&(e=se(i,t.ch)%2?"right":"left");e=Mn(n.map,t.ch,e);return e.offset="right"==e.collapse?e.end:e.start,e}function Cs(e,t){return t&&(e.bad=!0),e}function ws(e,t,n){var i;if(t==e.display.lineDiv){if(!(i=e.display.lineDiv.childNodes[n]))return Cs(e.clipPos(it(e.display.viewTo-1)),!0);t=null,n=0}else for(i=t;;i=i.parentNode){if(!i||i==e.display.lineDiv)return null;if(i.parentNode&&i.parentNode==e.display.lineDiv)break}for(var r=0;r<e.display.view.length;r++){var o=e.display.view[r];if(o.node==i)return function(c,e,t){var n=c.text.firstChild,i=!1;if(!e||!A(n,e))return Cs(it(Ze(c.line),0),!0);if(e==n&&(i=!0,e=n.childNodes[t],t=0,!e)){var r=c.rest?G(c.rest):c.line;return Cs(it(Ze(r),r.text.length),i)}var r=3==e.nodeType?e:null,o=e;r||1!=e.childNodes.length||3!=e.firstChild.nodeType||(r=e.firstChild,t=t&&r.nodeValue.length);for(;o.parentNode!=n;)o=o.parentNode;var d=c.measure,h=d.maps;function s(e,t,n){for(var i=-1;i<(h?h.length:0);i++)for(var r=i<0?d.map:h[i],o=0;o<r.length;o+=3){var s=r[o+2];if(s==e||s==t){var a=Ze(i<0?c.line:c.rest[i]),l=r[o]+n;return(n<0||s!=e)&&(l=r[o+(n?1:0)]),it(a,l)}}}var a=s(r,o,t);if(a)return Cs(a,i);for(var l=o.nextSibling,u=r?r.nodeValue.length-t:0;l;l=l.nextSibling){if(a=s(l,l.firstChild,0))return Cs(it(a.line,a.ch-u),i);u+=l.textContent.length}for(var f=o.previousSibling,p=t;f;f=f.previousSibling){if(a=s(f,f.firstChild,-1))return Cs(it(a.line,a.ch+p),i);p+=f.textContent.length}}(o,t,n)}}e.prototype.init=function(e){var t=this,o=this,s=o.cm,a=o.div=e.lineDiv;function n(e){if(!ke(s,e)){if(s.somethingSelected())fs({lineWise:!1,text:s.getSelections()}),"cut"==e.type&&s.replaceSelection("",null,"cut");else{if(!s.options.lineWiseCopyCut)return;var t=vs(s);fs({lineWise:!0,text:t.text}),"cut"==e.type&&s.operation(function(){s.setSelections(t.ranges,0,W),s.replaceSelection("",null,"cut")})}if(e.clipboardData){e.clipboardData.clearData();var n=us.text.join("\n");if(e.clipboardData.setData("Text",n),e.clipboardData.getData("Text")==n)return void e.preventDefault()}var i=_s(),e=i.firstChild;s.display.lineSpace.insertBefore(i,s.display.lineSpace.firstChild),e.value=us.text.join("\n");var r=document.activeElement;N(e),setTimeout(function(){s.display.lineSpace.removeChild(i),r.focus(),r==a&&o.showPrimarySelection()},50)}}ys(a,s.options.spellcheck,s.options.autocorrect,s.options.autocapitalize),ye(a,"paste",function(e){ke(s,e)||gs(e,s)||y<=11&&setTimeout(Di(s,function(){return t.updateFromDOM()}),20)}),ye(a,"compositionstart",function(e){t.composing={data:e.data,done:!1}}),ye(a,"compositionupdate",function(e){t.composing||(t.composing={data:e.data,done:!1})}),ye(a,"compositionend",function(e){t.composing&&(e.data!=t.composing.data&&t.readFromDOMSoon(),t.composing.done=!0)}),ye(a,"touchstart",function(){return o.forceCompositionEnd()}),ye(a,"input",function(){t.composing||t.readFromDOMSoon()}),ye(a,"copy",n),ye(a,"cut",n)},e.prototype.prepareSelection=function(){var e=ai(this.cm,!1);return e.focus=this.cm.state.focused,e},e.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},e.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},e.prototype.showPrimarySelection=function(){var e=this.getSelection(),t=this.cm,n=t.doc.sel.primary(),i=n.from(),r=n.to();if(t.display.viewTo==t.display.viewFrom||i.line>=t.display.viewTo||r.line<t.display.viewFrom)e.removeAllRanges();else{var o=ws(t,e.anchorNode,e.anchorOffset),n=ws(t,e.focusNode,e.focusOffset);if(!o||o.bad||!n||n.bad||0!=rt(lt(o,n),i)||0!=rt(at(o,n),r)){var n=t.display.view,s=i.line>=t.display.viewFrom&&ks(t,i)||{node:n[0].measure.map[2],offset:0},a=r.line<t.display.viewTo&&ks(t,r);if(a||(a={node:(c=(c=n[n.length-1].measure).maps?c.maps[c.maps.length-1]:c.map)[c.length-1],offset:c[c.length-2]-c[c.length-3]}),s&&a){var l,c=e.rangeCount&&e.getRangeAt(0);try{l=C(s.node,s.offset,a.offset,a.node)}catch(e){}l&&(!u&&t.state.focused?(e.collapse(s.node,s.offset),l.collapsed||(e.removeAllRanges(),e.addRange(l))):(e.removeAllRanges(),e.addRange(l)),c&&null==e.anchorNode?e.addRange(c):u&&this.startGracePeriod()),this.rememberSelection()}else e.removeAllRanges()}}},e.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},e.prototype.showMultipleSelections=function(e){T(this.cm.display.cursorDiv,e.cursors),T(this.cm.display.selectionDiv,e.selection)},e.prototype.rememberSelection=function(){var e=this.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},e.prototype.selectionInEditor=function(){var e=this.getSelection();if(!e.rangeCount)return!1;e=e.getRangeAt(0).commonAncestorContainer;return A(this.div,e)},e.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},e.prototype.blur=function(){this.div.blur()},e.prototype.getField=function(){return this.div},e.prototype.supportsTouch=function(){return!0},e.prototype.receivedFocus=function(){var t=this;this.selectionInEditor()?this.pollSelection():Fi(this.cm,function(){return t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))})},e.prototype.selectionChanged=function(){var e=this.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},e.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var e,t,n=this.getSelection(),i=this.cm;if(d&&o&&this.cm.display.gutterSpecs.length&&function(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}(n.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();this.composing||(this.rememberSelection(),e=ws(i,n.anchorNode,n.anchorOffset),t=ws(i,n.focusNode,n.focusOffset),e&&t&&Fi(i,function(){Fr(i.doc,ar(e,t),W),(e.bad||t.bad)&&(i.curOp.selectionChanged=!0)}))}},e.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e,t=this.cm,n=t.display,i=t.doc.sel.primary(),r=i.from(),i=i.to();if(0==r.ch&&r.line>t.firstLine()&&(r=it(r.line-1,Xe(t.doc,r.line-1).length)),i.ch==Xe(t.doc,i.line).text.length&&i.line<t.lastLine()&&(i=it(i.line+1,0)),r.line<n.viewFrom||i.line>n.viewTo-1)return!1;m=r.line==n.viewFrom||0==(m=ei(t,r.line))?(e=Ze(n.view[0].line),n.view[0].node):(e=Ze(n.view[m].line),n.view[m-1].node.nextSibling);var o,i=ei(t,i.line),i=i==n.view.length-1?(o=n.viewTo-1,n.lineDiv.lastChild):(o=Ze(n.view[i+1].line)-1,n.view[i+1].node.previousSibling);if(!m)return!1;for(var s=t.doc.splitLines(function(s,e,t,a,l){var n="",c=!1,d=s.doc.lineSeparator(),h=!1;function u(){c&&(n+=d,h&&(n+=d),c=h=!1)}function f(e){e&&(u(),n+=e)}for(;!function e(t){if(1==t.nodeType){var n=t.getAttribute("cm-text");if(n)f(n);else if(n=t.getAttribute("cm-marker"))(n=s.findMarks(it(a,0),it(l+1,0),(o=+n,function(e){return e.id==o}))).length&&(i=n[0].find(0))&&f(Je(s.doc,i.from,i.to).join(d));else if("false"!=t.getAttribute("contenteditable")){var i=/^(pre|div|p|li|table|br)$/i.test(t.nodeName);if(/^br$/i.test(t.nodeName)||0!=t.textContent.length){i&&u();for(var r=0;r<t.childNodes.length;r++)e(t.childNodes[r]);/^(pre|p)$/i.test(t.nodeName)&&(h=!0),i&&(c=!0)}}}else 3==t.nodeType&&f(t.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "));var o}(e),e!=t;)e=e.nextSibling,h=!1;return n}(t,m,i,e,o)),a=Je(t.doc,it(e,0),it(o,Xe(t.doc,o).text.length));1<s.length&&1<a.length;)if(G(s)==G(a))s.pop(),a.pop(),o--;else{if(s[0]!=a[0])break;s.shift(),a.shift(),e++}for(var l=0,c=0,d=s[0],h=a[0],u=Math.min(d.length,h.length);l<u&&d.charCodeAt(l)==h.charCodeAt(l);)++l;for(var f=G(s),p=G(a),g=Math.min(f.length-(1==s.length?l:0),p.length-(1==a.length?l:0));c<g&&f.charCodeAt(f.length-c-1)==p.charCodeAt(p.length-c-1);)++c;if(1==s.length&&1==a.length&&e==r.line)for(;l&&l>r.ch&&f.charCodeAt(f.length-c-1)==p.charCodeAt(p.length-c-1);)l--,c++;s[s.length-1]=f.slice(0,f.length-c).replace(/^\u200b+/,""),s[0]=s[0].slice(l).replace(/\u200b+$/,"");var m=it(e,l),i=it(o,a.length?G(a).length-c:0);return 1<s.length||s[0]||rt(m,i)?(Jr(t.doc,s,m,i,"+input"),!0):void 0},e.prototype.ensurePolled=function(){this.forceCompositionEnd()},e.prototype.reset=function(){this.forceCompositionEnd()},e.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},e.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()},80))},e.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||Fi(this.cm,function(){return ti(e.cm)})},e.prototype.setUneditable=function(e){e.contentEditable="false"},e.prototype.onKeyPress=function(e){0==e.charCode||this.composing||(e.preventDefault(),this.cm.isReadOnly()||Di(this.cm,ps)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0))},e.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},e.prototype.onContextMenu=function(){},e.prototype.resetPosition=function(){},e.prototype.needsContentAttribute=!0;var Ss,Ts,Ls,js,As,i=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new I,this.hasSelection=!1,this.composing=null};function Ms(e,t,i,n){Ss.defaults[e]=t,i&&(Ts[e]=n?function(e,t,n){n!=rs&&i(e,t,n)}:i)}i.prototype.init=function(n){var e=this,i=this,r=this.cm;this.createField(n);var o=this.textarea;function t(e){if(!ke(r,e)){if(r.somethingSelected())fs({lineWise:!1,text:r.getSelections()});else{if(!r.options.lineWiseCopyCut)return;var t=vs(r);fs({lineWise:!0,text:t.text}),"cut"==e.type?r.setSelections(t.ranges,null,W):(i.prevInput="",o.value=t.text.join("\n"),N(o))}"cut"==e.type&&(r.state.cutIncoming=+new Date)}}n.wrapper.insertBefore(this.wrapper,n.wrapper.firstChild),a&&(o.style.width="0px"),ye(o,"input",function(){v&&9<=y&&e.hasSelection&&(e.hasSelection=null),i.poll()}),ye(o,"paste",function(e){ke(r,e)||gs(e,r)||(r.state.pasteIncoming=+new Date,i.fastPoll())}),ye(o,"cut",t),ye(o,"copy",t),ye(n.scroller,"paste",function(e){if(!mn(n,e)&&!ke(r,e)){if(!o.dispatchEvent)return r.state.pasteIncoming=+new Date,void i.focus();var t=new Event("paste");t.clipboardData=e.clipboardData,o.dispatchEvent(t)}}),ye(n.lineSpace,"selectstart",function(e){mn(n,e)||Te(e)}),ye(o,"compositionstart",function(){var e=r.getCursor("from");i.composing&&i.composing.range.clear(),i.composing={start:e,range:r.markText(e,r.getCursor("to"),{className:"CodeMirror-composing"})}}),ye(o,"compositionend",function(){i.composing&&(i.poll(),i.composing.range.clear(),i.composing=null)})},i.prototype.createField=function(e){this.wrapper=_s(),this.textarea=this.wrapper.firstChild},i.prototype.prepareSelection=function(){var e,t=this.cm,n=t.display,i=t.doc,r=ai(t);return t.options.moveInputWithCursor&&(e=Bn(t,i.sel.primary().head,"div"),t=n.wrapper.getBoundingClientRect(),i=n.lineDiv.getBoundingClientRect(),r.teTop=Math.max(0,Math.min(n.wrapper.clientHeight-10,e.top+i.top-t.top)),r.teLeft=Math.max(0,Math.min(n.wrapper.clientWidth-10,e.left+i.left-t.left))),r},i.prototype.showSelection=function(e){var t=this.cm.display;T(t.cursorDiv,e.cursors),T(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},i.prototype.reset=function(e){var t,n;this.contextMenuPending||this.composing||((t=this.cm).somethingSelected()?(this.prevInput="",n=t.getSelection(),this.textarea.value=n,t.state.focused&&N(this.textarea),v&&9<=y&&(this.hasSelection=n)):e||(this.prevInput=this.textarea.value="",v&&9<=y&&(this.hasSelection=null)))},i.prototype.getField=function(){return this.textarea},i.prototype.supportsTouch=function(){return!1},i.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!h||M()!=this.textarea))try{this.textarea.focus()}catch(e){}},i.prototype.blur=function(){this.textarea.blur()},i.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},i.prototype.receivedFocus=function(){this.slowPoll()},i.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},i.prototype.fastPoll=function(){var t=!1,n=this;n.pollingFast=!0,n.polling.set(20,function e(){n.poll()||t?(n.pollingFast=!1,n.slowPoll()):(t=!0,n.polling.set(60,e))})},i.prototype.poll=function(){var e=this,t=this.cm,n=this.textarea,i=this.prevInput;if(this.contextMenuPending||!t.state.focused||De(n)&&!i&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var r=n.value;if(r==i&&!t.somethingSelected())return!1;if(v&&9<=y&&this.hasSelection===r||g&&/[\uf700-\uf7ff]/.test(r))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var o=r.charCodeAt(0);if(8203!=o||i||(i="​"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var s=0,a=Math.min(i.length,r.length);s<a&&i.charCodeAt(s)==r.charCodeAt(s);)++s;return Fi(t,function(){ps(t,r.slice(s),i.length-s,null,e.composing?"*compose":null),1e3<r.length||-1<r.indexOf("\n")?n.value=e.prevInput="":e.prevInput=r,e.composing&&(e.composing.range.clear(),e.composing.range=t.markText(e.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},i.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},i.prototype.onKeyPress=function(){v&&9<=y&&(this.hasSelection=null),this.fastPoll()},i.prototype.onContextMenu=function(e){var n=this,i=n.cm,r=i.display,o=n.textarea;n.contextMenuPending&&n.contextMenuPending();var s,a,t,l,c=Zn(i,e),d=r.scroller.scrollTop;function h(){var e,t;null!=o.selectionStart&&(t="​"+((e=i.somethingSelected())?o.value:""),o.value="⇚",o.value=t,n.prevInput=e?"":"​",o.selectionStart=1,o.selectionEnd=t.length,r.selForContextMenu=i.doc.sel)}function u(){var e,t;n.contextMenuPending==u&&(n.contextMenuPending=!1,n.wrapper.style.cssText=a,o.style.cssText=s,v&&y<9&&r.scrollbars.setScrollTop(r.scroller.scrollTop=d),null!=o.selectionStart&&((!v||v&&y<9)&&h(),e=0,t=function(){r.selForContextMenu==i.doc.sel&&0==o.selectionStart&&0<o.selectionEnd&&"​"==n.prevInput?Di(i,Ur)(i):e++<10?r.detectingSelectAll=setTimeout(t,500):(r.selForContextMenu=null,r.input.reset())},r.detectingSelectAll=setTimeout(t,200)))}c&&!p&&(i.options.resetSelectionOnContextMenu&&-1==i.doc.sel.contains(c)&&Di(i,Fr)(i.doc,ar(c),W),s=o.style.cssText,a=n.wrapper.style.cssText,c=n.wrapper.offsetParent.getBoundingClientRect(),n.wrapper.style.cssText="position: static",o.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-c.top-5)+"px; left: "+(e.clientX-c.left-5)+"px;\n      z-index: 1000; background: "+(v?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",f&&(t=window.scrollY),r.input.focus(),f&&window.scrollTo(null,t),r.input.reset(),i.somethingSelected()||(o.value=n.prevInput=" "),n.contextMenuPending=u,r.selForContextMenu=i.doc.sel,clearTimeout(r.detectingSelectAll),v&&9<=y&&h(),b?(Ae(e),l=function(){xe(window,"mouseup",l),setTimeout(u,20)},ye(window,"mouseup",l)):setTimeout(u,50))},i.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e},i.prototype.setUneditable=function(){},i.prototype.needsContentAttribute=!1,Ts=(Ss=cs).optionHandlers,Ss.defineOption=Ms,Ss.Init=rs,Ms("value","",function(e,t){return e.setValue(t)},!0),Ms("mode",null,function(e,t){e.doc.modeOption=t,ur(e)},!0),Ms("indentUnit",2,ur,!0),Ms("indentWithTabs",!1),Ms("smartIndent",!0),Ms("tabSize",4,function(e){fr(e),Nn(e),ti(e)},!0),Ms("lineSeparator",null,function(e,i){if(e.doc.lineSep=i){var r=[],o=e.doc.first;e.doc.iter(function(e){for(var t=0;;){var n=e.text.indexOf(i,t);if(-1==n)break;t=n+i.length,r.push(it(o,n))}o++});for(var t=r.length-1;0<=t;t--)Jr(e.doc,i,r[t],it(r[t].line,r[t].ch+i.length))}}),Ms("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(e,t,n){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),n!=rs&&e.refresh()}),Ms("specialCharPlaceholder",Yt,function(e){return e.refresh()},!0),Ms("electricChars",!0),Ms("inputStyle",h?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),Ms("spellcheck",!1,function(e,t){return e.getInputField().spellcheck=t},!0),Ms("autocorrect",!1,function(e,t){return e.getInputField().autocorrect=t},!0),Ms("autocapitalize",!1,function(e,t){return e.getInputField().autocapitalize=t},!0),Ms("rtlMoveVisually",!_),Ms("wholeLineUpdateBefore",!0),Ms("theme","default",function(e){is(e),Yi(e)},!0),Ms("keyMap","default",function(e,t,n){t=Oo(t),n=n!=rs&&Oo(n);n&&n.detach&&n.detach(e,t),t.attach&&t.attach(e,n||null)}),Ms("extraKeys",null),Ms("configureMouse",null),Ms("lineWrapping",!1,ls,!0),Ms("gutters",[],function(e,t){e.display.gutterSpecs=Xi(t,e.options.lineNumbers),Yi(e)},!0),Ms("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?Jn(e.display)+"px":"0",e.refresh()},!0),Ms("coverGutterNextToScrollbar",!1,function(e){return ji(e)},!0),Ms("scrollbarStyle","native",function(e){Oi(e),ji(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),Ms("lineNumbers",!1,function(e,t){e.display.gutterSpecs=Xi(e.options.gutters,t),Yi(e)},!0),Ms("firstLineNumber",1,Yi,!0),Ms("lineNumberFormatter",function(e){return e},Yi,!0),Ms("showCursorWhenSelecting",!1,si,!0),Ms("resetSelectionOnContextMenu",!0),Ms("lineWiseCopyCut",!0),Ms("pasteLinesPerSelection",!0),Ms("selectionsMayTouch",!1),Ms("readOnly",!1,function(e,t){"nocursor"==t&&(pi(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)}),Ms("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),Ms("dragDrop",!0,as),Ms("allowDropFileTypes",null),Ms("cursorBlinkRate",530),Ms("cursorScrollMargin",0),Ms("cursorHeight",1,si,!0),Ms("singleCursorHeightPerLine",!0,si,!0),Ms("workTime",100),Ms("workDelay",100),Ms("flattenSpans",!0,fr,!0),Ms("addModeClass",!1,fr,!0),Ms("pollInterval",100),Ms("undoDepth",200,function(e,t){return e.doc.history.undoDepth=t}),Ms("historyEventDelay",1250),Ms("viewportMargin",10,function(e){return e.refresh()},!0),Ms("maxHighlightLength",1e4,fr,!0),Ms("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),Ms("tabindex",null,function(e,t){return e.display.input.getField().tabIndex=t||""}),Ms("autofocus",null),Ms("direction","ltr",function(e,t){return e.doc.setDirection(t)},!0),Ms("phrases",null),js=(Ls=cs).optionHandlers,As=Ls.helpers={},Ls.prototype={constructor:Ls,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var n=this.options,i=n[e];n[e]==t&&"mode"!=e||(n[e]=t,js.hasOwnProperty(e)&&Di(this,js[e])(this,t,i),be(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Oo(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:Ii(function(e,t){var n=e.token?e:Ls.getMode(this.options,e);if(n.startState)throw new Error("Overlays may not be stateful.");!function(e,t,n){for(var i=0,r=n(t);i<e.length&&n(e[i])<=r;)i++;e.splice(i,0,t)}(this.state.overlays,{mode:n,modeSpec:e,opaque:t&&t.opaque,priority:t&&t.priority||0},function(e){return e.priority}),this.state.modeGen++,ti(this)}),removeOverlay:Ii(function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var i=t[n].modeSpec;if(i==e||"string"==typeof e&&i.name==e)return t.splice(n,1),this.state.modeGen++,void ti(this)}}),indentLine:Ii(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),tt(this.doc,e)&&hs(this,e,t,n)}),indentSelection:Ii(function(e){for(var t=this,n=this.doc.sel.ranges,i=-1,r=0;r<n.length;r++){var o=n[r];if(o.empty())o.head.line>i&&(hs(t,o.head.line,e,!0),i=o.head.line,r==t.doc.sel.primIndex&&xi(t));else{for(var s=o.from(),a=o.to(),o=Math.max(i,s.line),i=Math.min(t.lastLine(),a.line-(a.ch?0:1))+1,l=o;l<i;++l)hs(t,l,e);o=t.doc.sel.ranges;0==s.ch&&n.length==o.length&&0<o[r].from().ch&&Er(t.doc,r,new or(s,o[r].to()),W)}}}),getTokenAt:function(e,t){return bt(this,e,t)},getLineTokens:function(e,t){return bt(this,it(e),t,!0)},getTokenTypeAt:function(e){e=dt(this.doc,e);var t,n=gt(this,Xe(this.doc,e.line)),i=0,r=(n.length-1)/2,o=e.ch;if(0==o)t=n[2];else for(;;){var s=i+r>>1;if((s?n[2*s-1]:0)>=o)r=s;else{if(!(n[2*s+1]<o)){t=n[2*s+2];break}i=1+s}}e=t?t.indexOf("overlay "):-1;return e<0?t:0==e?null:t.slice(0,e-1)},getModeAt:function(e){var t=this.doc.mode;return t.innerMode?Ls.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!As.hasOwnProperty(t))return n;var i=As[t],r=this.getModeAt(e);if("string"==typeof r[t])i[r[t]]&&n.push(i[r[t]]);else if(r[t])for(var o=0;o<r[t].length;o++){var s=i[r[t][o]];s&&n.push(s)}else r.helperType&&i[r.helperType]?n.push(i[r.helperType]):i[r.name]&&n.push(i[r.name]);for(var a=0;a<i._global.length;a++){var l=i._global[a];l.pred(r,this)&&-1==R(n,l.val)&&n.push(l.val)}return n},getStateAfter:function(e,t){var n=this.doc;return mt(this,(e=ct(n,null==e?n.first+n.size-1:e))+1,t).state},cursorCoords:function(e,t){var n=this.doc.sel.primary(),n=null==e?n.head:"object"==typeof e?dt(this.doc,e):e?n.from():n.to();return Bn(this,n,t||"page")},charCoords:function(e,t){return Hn(this,dt(this.doc,e),t||"page")},coordsChar:function(e,t){return Un(this,(e=Rn(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=Rn(this,{top:e,left:0},t||"page").top,et(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,n){var i,r=!1,e="number"==typeof e?(i=this.doc.first+this.doc.size-1,e<this.doc.first?e=this.doc.first:i<e&&(e=i,r=!0),Xe(this.doc,e)):e;return In(this,e,{top:0,left:0},t||"page",n||r).top+(r?this.doc.height-Ut(e):0)},defaultTextHeight:function(){return Gn(this.display)},defaultCharWidth:function(){return $n(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,i,r){var o,s,a=this.display,l=(e=Bn(this,dt(this.doc,e))).bottom,c=e.left;t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),a.sizer.appendChild(t),"over"==i?l=e.top:"above"!=i&&"near"!=i||(o=Math.max(a.wrapper.clientHeight,this.doc.height),s=Math.max(a.sizer.clientWidth,a.lineSpace.clientWidth),("above"==i||e.bottom+t.offsetHeight>o)&&e.top>t.offsetHeight?l=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=o&&(l=e.bottom),c+t.offsetWidth>s&&(c=s-t.offsetWidth)),t.style.top=l+"px",t.style.left=t.style.right="","right"==r?(c=a.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==r?c=0:"middle"==r&&(c=(a.sizer.clientWidth-t.offsetWidth)/2),t.style.left=c+"px"),n&&(n=this,t={left:c,top:l,right:c+t.offsetWidth,bottom:l+t.offsetHeight},null!=(t=yi(n,t)).scrollTop&&wi(n,t.scrollTop),null!=t.scrollLeft&&Ti(n,t.scrollLeft))},triggerOnKeyDown:Ii(qo),triggerOnKeyPress:Ii($o),triggerOnKeyUp:Go,triggerOnMouseDown:Ii(Qo),execCommand:function(e){if(Io.hasOwnProperty(e))return Io[e].call(null,this)},triggerElectric:Ii(function(e){ms(this,e)}),findPosH:function(e,t,n,i){var r=1;t<0&&(r=-1,t=-t);for(var o=dt(this.doc,e),s=0;s<t&&!(o=xs(this.doc,o,r,n,i)).hitSide;++s);return o},moveH:Ii(function(t,n){var i=this;this.extendSelectionsBy(function(e){return i.display.shift||i.doc.extend||e.empty()?xs(i.doc,e.head,t,n,i.options.rtlMoveVisually):t<0?e.from():e.to()},U)}),deleteH:Ii(function(n,i){var e=this.doc.sel,r=this.doc;e.somethingSelected()?r.replaceSelection("",null,"+delete"):Eo(this,function(e){var t=xs(r,e.head,n,i,!1);return n<0?{from:t,to:e.head}:{from:e.head,to:t}})}),findPosV:function(e,t,n,i){var r=1,o=i;t<0&&(r=-1,t=-t);for(var s=dt(this.doc,e),a=0;a<t;++a){var l=Bn(this,s,"div");if(null==o?o=l.left:l.left=o,(s=bs(this,l,r,n)).hitSide)break}return s},moveV:Ii(function(i,r){var o=this,s=this.doc,a=[],l=!this.display.shift&&!s.extend&&s.sel.somethingSelected();if(s.extendSelectionsBy(function(e){if(l)return i<0?e.from():e.to();var t=Bn(o,e.head,"div");null!=e.goalColumn&&(t.left=e.goalColumn),a.push(t.left);var n=bs(o,t,i,r);return"page"==r&&e==s.sel.primary()&&_i(o,Hn(o,n,"div").top-t.top),n},U),a.length)for(var e=0;e<s.sel.ranges.length;e++)s.sel.ranges[e].goalColumn=a[e]}),findWordAt:function(e){var t=Xe(this.doc,e.line).text,n=e.ch,i=e.ch;if(t){var r=this.getHelper(e,"wordChars");"before"!=e.sticky&&i!=t.length||!n?++i:--n;for(var o=t.charAt(n),s=Z(o,r)?function(e){return Z(e,r)}:/\s/.test(o)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!Z(e)};0<n&&s(t.charAt(n-1));)--n;for(;i<t.length&&s(t.charAt(i));)++i}return new or(it(e.line,n),it(e.line,i))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||(((this.state.overwrite=!this.state.overwrite)?O:w)(this.display.cursorDiv,"CodeMirror-overwrite"),be(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==M()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:Ii(function(e,t){bi(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-xn(this)-this.display.barHeight,width:e.scrollWidth-xn(this)-this.display.barWidth,clientHeight:kn(this),clientWidth:bn(this)}},scrollIntoView:Ii(function(e,t){var n;null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:it(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?(n=e,ki(t=this),t.curOp.scrollToPos=n):Ci(this,e.from,e.to,e.margin)}),setSize:Ii(function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var i=this;null!=e&&(this.display.wrapper.style.width=n(e)),null!=t&&(this.display.wrapper.style.height=n(t)),this.options.lineWrapping&&En(this);var r=this.display.viewFrom;this.doc.iter(r,this.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){ni(i,r,"widget");break}++r}),this.curOp.forceUpdate=!0,be(this,"refresh",this)}),operation:function(e){return Fi(this,e)},startOperation:function(){return Ni(this)},endOperation:function(){return Pi(this)},refresh:Ii(function(){var e=this.display.cachedTextHeight;ti(this),this.curOp.forceUpdate=!0,Nn(this),bi(this,this.doc.scrollLeft,this.doc.scrollTop),Vi(this.display),(null==e||.5<Math.abs(e-Gn(this.display)))&&Qn(this),be(this,"refresh",this)}),swapDoc:Ii(function(e){var t=this.doc;return t.cm=null,this.state.selectingText&&this.state.selectingText(),vr(this,e),Nn(this),this.display.input.reset(),bi(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,sn(this,"swapDoc",this,t),t}),phrase:function(e){var t=this.options.phrases;return t&&Object.prototype.hasOwnProperty.call(t,e)?t[e]:e},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Se(Ls),Ls.registerHelper=function(e,t,n){As.hasOwnProperty(e)||(As[e]=Ls[e]={_global:[]}),As[e][t]=n},Ls.registerGlobalHelper=function(e,t,n,i){Ls.registerHelper(e,t,i),As[e]._global.push({pred:n,val:i})};var Os,Es,Ns="iter insert remove copy getEditor constructor".split(" ");for(Os in uo.prototype)uo.prototype.hasOwnProperty(Os)&&R(Ns,Os)<0&&(cs.prototype[Os]=function(e){return function(){return e.apply(this.doc,arguments)}}(uo.prototype[Os]));return Se(uo),cs.inputStyles={textarea:i,contenteditable:e},cs.defineMode=function(e){cs.defaults.mode||"null"==e||(cs.defaults.mode=e),function(e,t){2<arguments.length&&(t.dependencies=Array.prototype.slice.call(arguments,2)),He[e]=t}.apply(this,arguments)},cs.defineMIME=function(e,t){Be[e]=t},cs.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),cs.defineMIME("text/plain","null"),cs.defineExtension=function(e,t){cs.prototype[e]=t},cs.defineDocExtension=function(e,t){uo.prototype[e]=t},cs.fromTextArea=function(t,e){var n;function i(){t.value=a.getValue()}if(e=e?F(e):{},e.value=t.value,!e.tabindex&&t.tabIndex&&(e.tabindex=t.tabIndex),!e.placeholder&&t.placeholder&&(e.placeholder=t.placeholder),null==e.autofocus&&(n=M(),e.autofocus=n==t||null!=t.getAttribute("autofocus")&&n==document.body),t.form&&(ye(t.form,"submit",i),!e.leaveSubmitMethodAlone)){var r=t.form,o=r.submit;try{var s=r.submit=function(){i(),r.submit=o,r.submit(),r.submit=s}}catch(e){}}e.finishInit=function(e){e.save=i,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,i(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(xe(t.form,"submit",i),"function"==typeof t.form.submit&&(t.form.submit=o))}},t.style.display="none";var a=cs(function(e){return t.parentNode.insertBefore(e,t.nextSibling)},e);return a},(Es=cs).off=xe,Es.on=ye,Es.wheelEventPixels=nr,Es.Doc=uo,Es.splitLines=Fe,Es.countColumn=D,Es.findColumn=z,Es.isWordChar=Q,Es.Pass=B,Es.signal=be,Es.Line=qt,Es.changeEnd=lr,Es.scrollbarModel=Mi,Es.Pos=it,Es.cmpPos=rt,Es.modes=He,Es.mimeModes=Be,Es.resolveMode=We,Es.getMode=Ke,Es.modeExtensions=Ue,Es.extendMode=ze,Es.copyState=Ve,Es.startState=Ge,Es.innerMode=qe,Es.commands=Io,Es.keyMap=wo,Es.keyName=Mo,Es.isModifierKey=jo,Es.lookupKey=Lo,Es.normalizeKeyMap=To,Es.StringStream=$e,Es.SharedTextMarker=lo,Es.TextMarker=so,Es.LineWidget=io,Es.e_preventDefault=Te,Es.e_stopPropagation=Le,Es.e_stop=Ae,Es.addClass=O,Es.contains=A,Es.rmClass=w,Es.keyNames=xo,cs.version="5.46.0",cs}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/dialog/dialog"),require("../addon/edit/matchbrackets.js")):"function"==typeof define&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/dialog/dialog","../addon/edit/matchbrackets"],e):e(CodeMirror)}(function(Ve){"use strict";var qe=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h",context:"normal"},{keys:"<Del>",type:"keyToKey",toKeys:"x",context:"normal"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B",context:"normal"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b",context:"normal"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"c",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"VdO",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"<Ins>",type:"action",action:"toggleOverwrite",context:"insert"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:"(",type:"motion",motion:"moveBySentence",motionArgs:{forward:!1}},{keys:")",type:"motion",motion:"moveBySentence",motionArgs:{forward:!0}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:"'<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0,linewise:!0}},{keys:"`<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:"]p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0,matchIndent:!0}},{keys:"[p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0,matchIndent:!0}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:!0},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:"=",type:"operator",operator:"indentAuto"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:"g~",type:"operator",operator:"changeCase"},{keys:"gu",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},isEdit:!0},{keys:"gU",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},isEdit:!0},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"D",type:"operator",operator:"delete",operatorArgs:{linewise:!0},context:"visual"},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"expandToLine",motionArgs:{linewise:!0},context:"normal"},{keys:"Y",type:"operator",operator:"yank",operatorArgs:{linewise:!0},context:"visual"},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},context:"normal"},{keys:"C",type:"operator",operator:"change",operatorArgs:{linewise:!0},context:"visual"},{keys:"~",type:"operatorMotion",operator:"changeCase",motion:"moveByCharacters",motionArgs:{forward:!0},operatorArgs:{shouldMoveCursor:!0},context:"normal"},{keys:"~",type:"operator",operator:"changeCase",context:"visual"},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1},context:"insert"},{keys:"<C-w>",type:"idle",context:"normal"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:!0,linewise:!0}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:!1,linewise:!0}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"startOfSelectedArea"},context:"visual"},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"<C-q>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:!0}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:!0},{keys:"p",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:"P",type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:"r<character>",type:"action",action:"replace",isEdit:!0},{keys:"@<character>",type:"action",action:"replayMacro"},{keys:"q<character>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"operator",operator:"changeCase",operatorArgs:{toLower:!0},context:"visual",isEdit:!0},{keys:"U",type:"operator",operator:"changeCase",operatorArgs:{toLower:!1},context:"visual",isEdit:!0},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<character>",type:"action",action:"setMark"},{keys:'"<character>',type:"action",action:"setRegister"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:"<C-t>",type:"action",action:"indent",actionArgs:{indentRight:!0},context:"insert"},{keys:"<C-d>",type:"action",action:"indent",actionArgs:{indentRight:!1},context:"insert"},{keys:"a<character>",type:"motion",motion:"textObjectManipulation"},{keys:"i<character>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:"/",type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:"?",type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:"*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",wholeWordOnly:!0,toJumplist:!0}},{keys:"g*",type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:"g#",type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:":",type:"ex"}],Ge=qe.length,$e=[{name:"colorscheme",shortName:"colo"},{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"se"},{name:"set",shortName:"se"},{name:"setlocal",shortName:"setl"},{name:"setglobal",shortName:"setg"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:!0},{name:"nohlsearch",shortName:"noh"},{name:"yank",shortName:"y"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:!0},{name:"global",shortName:"g"}],Xe=Ve.Pos;Ve.Vim=function(){function e(e,t){this==Ve.keyMap.vim&&(Ve.rmClass(e.getWrapperElement(),"cm-fat-cursor"),"contenteditable"==e.getOption("inputStyle")&&null!=document.body.style.caretColor&&(function(e){var t=e.state.fatCursorMarks;if(t)for(var n=0;n<t.length;n++)t[n].clear();e.state.fatCursorMarks=null,e.off("cursorActivity",o)}(e),e.getInputField().style.caretColor="")),t&&t.attach==i||((e=e).setOption("disableInput",!1),e.off("cursorActivity",He),Ve.off(e.getInputField(),"paste",l(e)),e.state.vim=null)}function i(e,t){var n;this==Ve.keyMap.vim&&(Ve.addClass(e.getWrapperElement(),"cm-fat-cursor"),"contenteditable"==e.getOption("inputStyle")&&null!=document.body.style.caretColor&&((n=e).state.fatCursorMarks=r(n),n.on("cursorActivity",o),e.getInputField().style.caretColor="transparent")),t&&t.attach==i||((e=e).setOption("disableInput",!0),e.setOption("showCursorWhenSelecting",!1),Ve.signal(e,"vim-mode-change",{mode:"normal"}),e.on("cursorActivity",He),E(e),Ve.on(e.getInputField(),"paste",l(e)))}function r(e){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++){var r,o=t[i];o.empty()&&(o.anchor.ch<e.getLine(o.anchor.line).length?n.push(e.markText(o.anchor,Xe(o.anchor.line,o.anchor.ch+1),{className:"cm-fat-cursor-mark"})):((r=document.createElement("span")).textContent=" ",r.className="cm-fat-cursor-mark",n.push(e.setBookmark(o.anchor,{widget:r}))))}return n}function o(e){var t=e.state.fatCursorMarks;if(t)for(var n=0;n<t.length;n++)t[n].clear();e.state.fatCursorMarks=r(e)}function t(e,t){if(t){if(this[e])return this[e];var n=function(e){if("'"==e.charAt(0))return e.charAt(1);var t=e.split(/-(?!$)/),e=t[t.length-1];{if(1==t.length&&1==t[0].length)return!1;if(2==t.length&&"Shift"==t[0]&&1==e.length)return!1}for(var n=!1,i=0;i<t.length;i++){var r=t[i];r in s?t[i]=s[r]:n=!0,r in a&&(t[i]=a[r])}if(!n)return!1;_(e)&&(t[t.length-1]=e.toLowerCase());return"<"+t.join("-")+">"}(e);if(!n)return!1;e=Ve.Vim.findKey(t,n);return"function"==typeof e&&Ve.signal(t,"vim-keypress",n),e}}Ve.defineOption("vimMode",!1,function(e,t,n){t&&"vim"!=e.getOption("keyMap")?e.setOption("keyMap","vim"):!t&&n!=Ve.Init&&/^vim/.test(e.getOption("keyMap"))&&e.setOption("keyMap","default")});var s={Shift:"S",Ctrl:"C",Alt:"A",Cmd:"D",Mod:"A"},a={Enter:"CR",Backspace:"BS",Delete:"Del",Insert:"Ins"};function l(e){var t=e.state.vim;return t.onPasteFn||(t.onPasteFn=function(){t.insertMode||(e.setCursor(q(e.getCursor(),0,1)),U.enterInsertMode(e,{},t))}),t.onPasteFn}var c=/[\d]/,g=[Ve.isWordChar,function(e){return e&&!Ve.isWordChar(e)&&!/\s/.test(e)}],m=[function(e){return/\S/.test(e)}];function n(e,t){for(var n=[],i=e;i<e+t;i++)n.push(String.fromCharCode(i));return n}var d=n(65,26),h=n(97,26),u=n(48,10),f=[].concat(d,h,u,["<",">"]),p=[].concat(d,h,u,["-",'"',".",":","/"]);function v(e,t){return t>=e.firstLine()&&t<=e.lastLine()}function y(e){return/^[a-z]$/.test(e)}function _(e){return/^[A-Z]$/.test(e)}function S(e){return/^\s*$/.test(e)}function x(e){return-1!=".?!".indexOf(e)}function b(e,t){for(var n=0;n<t.length;n++)if(t[n]==e)return!0;return!1}var k={};function C(e,t,n,i,r){if(void 0===t&&!r)throw Error("defaultValue is required unless callback is provided");if(n=n||"string",k[e]={type:n,defaultValue:t,callback:r},i)for(var o=0;o<i.length;o++)k[i[o]]=k[e];t&&w(e,t)}function w(e,t,n,i){var r=k[e],i=(i=i||{}).scope;if(!r)return new Error("Unknown option: "+e);if("boolean"==r.type){if(t&&!0!==t)return new Error("Invalid argument: "+e+"="+t);!1!==t&&(t=!0)}r.callback?("local"!==i&&r.callback(t,void 0),"global"!==i&&n&&r.callback(t,n)):("local"!==i&&(r.value="boolean"==r.type?!!t:t),"global"!==i&&n&&(n.state.vim.options[e]={value:t}))}function T(e,t,n){var i=k[e],n=(n=n||{}).scope;if(!i)return new Error("Unknown option: "+e);if(i.callback){var r=t&&i.callback(void 0,t);return"global"!==n&&void 0!==r?r:"local"!==n?i.callback():void 0}return((r="global"!==n&&t&&t.state.vim.options[e])||"local"!==n&&i||{}).value}C("filetype",void 0,"string",["ft"],function(e,t){if(void 0!==t){if(void 0===e)return"null"==(n=t.getOption("mode"))?"":n;var n=""==e?"null":e;t.setOption("mode",n)}});function L(){var s=-1,a=0,l=0,c=new Array(100);return{cachedCursor:void 0,add:function(i,e,t){var n=c[s%100];function r(e){var t=++s%100,n=c[t];n&&n.clear(),c[t]=i.setBookmark(e)}n&&(!(n=n.find())||X(n,e))||r(e),r(t),(l=(a=s)-100+1)<0&&(l=0)},move:function(e,t){a<(s+=t)?s=a:s<l&&(s=l);var n=c[(100+s)%100];if(n&&!n.find()){var i,r=0<t?1:-1,o=e.getCursor();do{if((n=c[(100+(s+=r))%100])&&(i=n.find())&&!X(o,i))break}while(s<a&&l<s)}return n}}}var j,A,M=function(e){return e?{changes:e.changes,expectCursorActivityForChange:e.expectCursorActivityForChange}:{changes:[],expectCursorActivityForChange:!1}};function O(){this.latestRegister=void 0,this.isPlaying=!1,this.isRecording=!1,this.replaySearchQueries=[],this.onRecordingDone=void 0,this.lastInsertModeChanges=M()}function E(e){return e.state.vim||(e.state.vim={inputState:new P,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},fakeCursor:null,insertMode:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1,visualBlock:!1,lastSelection:null,lastPastedText:null,sel:{},options:{}}),e.state.vim}function N(){for(var e in j={searchQuery:null,searchIsReversed:!1,lastSubstituteReplacePart:void 0,jumpList:L(),macroModeState:new O,lastCharacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new I({}),searchHistoryController:new R,exCommandHistoryController:new R},k){var t=k[e];t.value=t.defaultValue}}h={buildKeyMap:function(){},getRegisterController:function(){return j.registerController},resetVimGlobalState_:N,getVimGlobalState_:function(){return j},maybeInitVimState_:E,suppressErrorLogging:!(O.prototype={exitMacroRecordMode:function(){var e=j.macroModeState;e.onRecordingDone&&e.onRecordingDone(),e.onRecordingDone=void 0,e.isRecording=!1},enterMacroRecordMode:function(e,t){var n=j.registerController.getRegister(t);n&&(n.clear(),this.latestRegister=t,e.openDialog&&(this.onRecordingDone=e.openDialog("(recording)["+t+"]",null,{bottom:!0})),this.isRecording=!0)}}),InsertModeKey:We,map:function(e,t,n){Fe.map(e,t,n)},unmap:function(e,t){Fe.unmap(e,t)},noremap:function(e,t,n){function i(e){return e?[e]:["normal","insert","visual"]}for(var r=i(n),o=qe.length,s=o-Ge;s<o&&r.length;s++){var a=qe[s];if(!(a.keys!=t||n&&a.context&&a.context!==n||"ex"===a.type.substr(0,2)||"key"===a.type.substr(0,3))){var l,c={};for(l in a)c[l]=a[l];c.keys=e,n&&!c.context&&(c.context=n),this._mapCommand(c);var d=i(a.context),r=r.filter(function(e){return-1===d.indexOf(e)})}}},mapclear:function(e){var t=qe.length,n=Ge,i=qe.slice(0,t-n);if(qe=qe.slice(t-n),e)for(var r=i.length-1;0<=r;r--){var o=i[r];if(e!==o.context)if(o.context)this._mapCommand(o);else{var s,a=["normal","insert","visual"];for(s in a)if(a[s]!==e){var l,c={};for(l in o)c[l]=o[l];c.context=a[s],this._mapCommand(c)}}}},setOption:w,getOption:T,defineOption:C,defineEx:function(e,t,n){if(t){if(0!==e.indexOf(t))throw new Error('(Vim.defineEx) "'+t+'" is not a prefix of "'+e+'", command not registered')}else t=e;Pe[e]=n,Fe.commandMap_[t]={name:e,shortName:t,type:"api"}},handleKey:function(e,t,n){n=this.findKey(e,t,n);if("function"==typeof n)return n()},findKey:function(a,l,t){var e,c=E(a);function i(){var e=j.macroModeState;if(e.isRecording){if("q"==l)return e.exitMacroRecordMode(),F(a),1;"mapping"!=t&&function(e,t){if(e.isPlaying)return;e=e.latestRegister,e=j.registerController.getRegister(e);e&&e.pushText(t)}(e,l)}}function d(){return"<Esc>"==l&&(F(a),c.visualMode?ae(a):c.insertMode&&De(a),1)}return!1===(e=(c.insertMode?function(){if(d())return!0;for(var e=c.inputState.keyBuffer=c.inputState.keyBuffer+l,t=1==l.length,n=H.matchCommand(e,qe,c.inputState,"insert");1<e.length&&"full"!=n.type;){var e=c.inputState.keyBuffer=e.slice(1),i=H.matchCommand(e,qe,c.inputState,"insert");"none"!=i.type&&(n=i)}if("none"==n.type)return F(a),!1;if("partial"==n.type)return A&&window.clearTimeout(A),A=window.setTimeout(function(){c.insertMode&&c.inputState.keyBuffer&&F(a)},T("insertModeEscKeysTimeout")),!t;if(A&&window.clearTimeout(A),t){for(var r=a.listSelections(),o=0;o<r.length;o++){var s=r[o].head;a.replaceRange("",q(s,0,-(e.length-1)),s,"+input")}j.macroModeState.lastInsertModeChanges.changes.pop()}return F(a),n.command}:function(){if(i()||d())return!0;var e=c.inputState.keyBuffer=c.inputState.keyBuffer+l;if(/^[1-9]\d*$/.test(e))return!0;var t=/^(\d*)(.*)$/.exec(e);if(!t)return F(a),!1;var n=c.visualMode?"visual":"normal";return"none"==(n=H.matchCommand(t[2]||t[1],qe,c.inputState,n)).type?(F(a),!1):"partial"==n.type||(c.inputState.keyBuffer="",(t=/^(\d*)(.*)$/.exec(e))[1]&&"0"!=t[1]&&c.inputState.pushRepeatDigit(t[1]),n.command)})())?c.insertMode||1!==l.length?void 0:function(){return!0}:!0===e?function(){return!0}:function(){return a.operation(function(){a.curOp.isVimOp=!0;try{"keyToKey"==e.type?function(e){for(var t;e;)t=/<\w+-.+?>|<\w+>|./.exec(e),l=t[0],e=e.substring(t.index+l.length),Ve.Vim.handleKey(a,l,"mapping")}(e.toKeys):H.processCommand(a,c,e)}catch(e){throw a.state.vim=void 0,E(a),Ve.Vim.suppressErrorLogging||console.log(e),e}return!0})}},handleEx:function(e,t){Fe.processCommand(e,t)},defineMotion:function(e,t){B[e]=t},defineAction:function(e,t){U[e]=t},defineOperator:function(e,t){K[e]=t},mapCommand:function(e,t,n,i,r){var o,s={keys:e,type:t};for(o in s[t]=n,s[t+"Args"]=i,r)s[o]=r[o];Ie(s)},_mapCommand:Ie,defineRegister:function(e,t){var n=j.registerController.registers;if(!e||1!=e.length)throw Error("Register name must be 1 character");if(n[e])throw Error("Register already defined "+e);n[e]=t,p.push(e)},exitVisualMode:ae,exitInsertMode:De};function P(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=null}function F(e,t){e.state.vim.inputState=new P,Ve.signal(e,"vim-command-done",t)}function D(e,t,n){this.clear(),this.keyBuffer=[e||""],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!!t,this.blockwise=!!n}function I(e){this.registers=e,this.unnamedRegister=e['"']=new D,e["."]=new D,e[":"]=new D,e["/"]=new D}function R(){this.historyBuffer=[],this.iterator=0,this.initialPrefix=null}P.prototype.pushRepeatDigit=function(e){this.operator?this.motionRepeat=this.motionRepeat.concat(e):this.prefixRepeat=this.prefixRepeat.concat(e)},P.prototype.getRepeat=function(){var e=0;return(0<this.prefixRepeat.length||0<this.motionRepeat.length)&&(e=1,0<this.prefixRepeat.length&&(e*=parseInt(this.prefixRepeat.join(""),10)),0<this.motionRepeat.length&&(e*=parseInt(this.motionRepeat.join(""),10))),e},D.prototype={setText:function(e,t,n){this.keyBuffer=[e||""],this.linewise=!!t,this.blockwise=!!n},pushText:function(e,t){t&&(this.linewise||this.keyBuffer.push("\n"),this.linewise=!0),this.keyBuffer.push(e)},pushInsertModeChanges:function(e){this.insertModeChanges.push(M(e))},pushSearchQuery:function(e){this.searchQueries.push(e)},clear:function(){this.keyBuffer=[],this.insertModeChanges=[],this.searchQueries=[],this.linewise=!1},toString:function(){return this.keyBuffer.join("")}},I.prototype={pushText:function(e,t,n,i,r){i&&"\n"!==n.charAt(n.length-1)&&(n+="\n");var o=this.isValidRegister(e)?this.getRegister(e):null;if(o)_(e)?o.pushText(n,i):o.setText(n,i,r),this.unnamedRegister.setText(o.toString(),i);else{switch(t){case"yank":this.registers[0]=new D(n,i,r);break;case"delete":case"change":-1==n.indexOf("\n")?this.registers["-"]=new D(n,i):(this.shiftNumericRegisters_(),this.registers[1]=new D(n,i))}this.unnamedRegister.setText(n,i,r)}},getRegister:function(e){return this.isValidRegister(e)?(e=e.toLowerCase(),this.registers[e]||(this.registers[e]=new D),this.registers[e]):this.unnamedRegister},isValidRegister:function(e){return e&&b(e,p)},shiftNumericRegisters_:function(){for(var e=9;2<=e;e--)this.registers[e]=this.getRegister(""+(e-1))}},R.prototype={nextMatch:function(e,t){var n=this.historyBuffer,i=t?-1:1;null===this.initialPrefix&&(this.initialPrefix=e);for(var r=this.iterator+i;t?0<=r:r<n.length;r+=i)for(var o=n[r],s=0;s<=o.length;s++)if(this.initialPrefix==o.substring(0,s))return this.iterator=r,o;return r>=n.length?(this.iterator=n.length,this.initialPrefix):r<0?e:void 0},pushInput:function(e){var t=this.historyBuffer.indexOf(e);-1<t&&this.historyBuffer.splice(t,1),e.length&&this.historyBuffer.push(e)},reset:function(){this.initialPrefix=null,this.iterator=this.historyBuffer.length}};var H={matchCommand:function(e,t,n,i){var r=function(e,t,n,i){for(var r,o=[],s=[],a=0;a<t.length;a++){var l=t[a];"insert"==n&&"insert"!=l.context||l.context&&l.context!=n||i.operator&&"action"==l.type||!(r=function(e,t){{if("<character>"!=t.slice(-11))return e==t?"full":0==t.indexOf(e)&&"partial";var n=t.length-11,i=e.slice(0,n),t=t.slice(0,n);return i==t&&e.length>n?"full":0==t.indexOf(i)&&"partial"}}(e,l.keys))||("partial"==r&&o.push(l),"full"==r&&s.push(l))}return{partial:o.length&&o,full:s.length&&s}}(e,t,i,n);if(!r.full&&!r.partial)return{type:"none"};if(!r.full&&r.partial)return{type:"partial"};for(var o=0;o<r.full.length;o++)var s=r.full[o],a=a||s;if("<character>"==a.keys.slice(-11)){e=function(e){var t=/^.*(<[^>]+>)$/.exec(e),n=t?t[1]:e.slice(-1);if(1<n.length)switch(n){case"<CR>":n="\n";break;case"<Space>":n=" ";break;default:n=""}return n}(e);if(!e)return{type:"none"};n.selectedCharacter=e}return{type:"full",command:a}},processCommand:function(e,t,n){switch(t.inputState.repeatOverride=n.repeatOverride,n.type){case"motion":this.processMotion(e,t,n);break;case"operator":this.processOperator(e,t,n);break;case"operatorMotion":this.processOperatorMotion(e,t,n);break;case"action":this.processAction(e,t,n);break;case"search":this.processSearch(e,t,n);break;case"ex":case"keyToEx":this.processEx(e,t,n)}},processMotion:function(e,t,n){t.inputState.motion=n.motion,t.inputState.motionArgs=V(n.motionArgs),this.evalInput(e,t)},processOperator:function(e,t,n){var i=t.inputState;if(i.operator){if(i.operator==n.operator)return i.motion="expandToLine",i.motionArgs={linewise:!0},void this.evalInput(e,t);F(e)}i.operator=n.operator,i.operatorArgs=V(n.operatorArgs),t.visualMode&&this.evalInput(e,t)},processOperatorMotion:function(e,t,n){var i=t.visualMode,r=V(n.operatorMotionArgs);r&&i&&r.visualLine&&(t.visualLine=!0),this.processOperator(e,t,n),i||this.processMotion(e,t,n)},processAction:function(e,t,n){var i=t.inputState,r=i.getRepeat(),o=!!r,s=V(n.actionArgs)||{};i.selectedCharacter&&(s.selectedCharacter=i.selectedCharacter),n.operator&&this.processOperator(e,t,n),n.motion&&this.processMotion(e,t,n),(n.motion||n.operator)&&this.evalInput(e,t),s.repeat=r||1,s.repeatIsExplicit=o,s.registerName=i.registerName,F(e),t.lastMotion=null,n.isEdit&&this.recordLastEdit(t,i,n),U[n.action](e,s,t)},processSearch:function(a,i,r){if(a.getSearchCursor){var l=r.searchArgs.forward,e=r.searchArgs.wholeWordOnly;ye(a).setReversed(!l);var t=l?"/":"?",o=ye(a).getQuery(),c=a.getScrollInfo();switch(r.searchArgs.querySrc){case"prompt":var n=j.macroModeState;n.isPlaying?h(d=n.replaySearchQueries.shift(),!0,!1):Le(a,{onClose:function(e){a.scrollTo(c.left,c.top),h(e,!0,!0);var t=j.macroModeState;t.isRecording&&function(e,t){if(e.isPlaying)return;e=e.latestRegister,e=j.registerController.getRegister(e);e&&e.pushSearchQuery&&e.pushSearchQuery(t)}(t,e)},prefix:t,desc:Te,onKeyUp:function(e,t,n){var i,r,o,s=Ve.keyName(e);"Up"==s||"Down"==s?(i="Up"==s,r=e.target?e.target.selectionEnd:0,n(t=j.searchHistoryController.nextMatch(t,i)||""),r&&e.target&&(e.target.selectionEnd=e.target.selectionStart=Math.min(r,e.target.value.length))):"Left"!=s&&"Right"!=s&&"Ctrl"!=s&&"Alt"!=s&&"Shift"!=s&&j.searchHistoryController.reset();try{o=je(a,t,!0,!0)}catch(e){}o?a.scrollIntoView(Me(a,!l,o),30):(Oe(a),a.scrollTo(c.left,c.top))},onKeyDown:function(e,t,n){var i=Ve.keyName(e);"Esc"==i||"Ctrl-C"==i||"Ctrl-["==i||"Backspace"==i&&""==t?(j.searchHistoryController.pushInput(t),j.searchHistoryController.reset(),je(a,o),Oe(a),a.scrollTo(c.left,c.top),Ve.e_stop(e),F(a),n(),a.focus()):"Up"==i||"Down"==i?Ve.e_stop(e):"Ctrl-U"==i&&(Ve.e_stop(e),n(""))}});break;case"wordUnderCursor":var s=ce(a,!1,0,!1,!0),n=!0;if(s||(s=ce(a,!1,0,!1,!1),n=!1),!s)return;var d=a.getLine(s.start.line).substring(s.start.ch,s.end.ch);d=n&&e?"\\b"+d+"\\b":d.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1"),j.jumpList.cachedCursor=a.getCursor(),a.setCursor(s.start),h(d,!0,!1)}}function h(t,e,n){j.searchHistoryController.pushInput(t),j.searchHistoryController.reset();try{je(a,t,e,n)}catch(e){return Se(a,"Invalid regex: "+t),void F(a)}H.processMotion(a,i,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:r.searchArgs.toJumplist}})}},processEx:function(s,e,t){function n(e){j.exCommandHistoryController.pushInput(e),j.exCommandHistoryController.reset(),Fe.processCommand(s,e)}function i(e,t,n){var i,r,o=Ve.keyName(e);("Esc"==o||"Ctrl-C"==o||"Ctrl-["==o||"Backspace"==o&&""==t)&&(j.exCommandHistoryController.pushInput(t),j.exCommandHistoryController.reset(),Ve.e_stop(e),F(s),n(),s.focus()),"Up"==o||"Down"==o?(Ve.e_stop(e),i="Up"==o,r=e.target?e.target.selectionEnd:0,n(t=j.exCommandHistoryController.nextMatch(t,i)||""),r&&e.target&&(e.target.selectionEnd=e.target.selectionStart=Math.min(r,e.target.value.length))):"Ctrl-U"==o?(Ve.e_stop(e),n("")):"Left"!=o&&"Right"!=o&&"Ctrl"!=o&&"Alt"!=o&&"Shift"!=o&&j.exCommandHistoryController.reset()}"keyToEx"==t.type?Fe.processCommand(s,t.exArgs.input):e.visualMode?Le(s,{onClose:n,prefix:":",value:"'<,'>",onKeyDown:i,selectValueOnOpen:!1}):Le(s,{onClose:n,prefix:":",onKeyDown:i})},evalInput:function(e,t){var n,i,r,o,s,a,l=t.inputState,c=l.motion,d=l.motionArgs||{},h=l.operator,u=l.operatorArgs||{},f=l.registerName,p=t.sel,g=$(t.visualMode?z(e,p.head):e.getCursor("head")),m=$(t.visualMode?z(e,p.anchor):e.getCursor("anchor")),v=$(g),y=$(m);if(h&&this.recordLastEdit(t,l),0<(m=void 0!==l.repeatOverride?l.repeatOverride:l.getRepeat())&&d.explicitRepeat?d.repeatIsExplicit=!0:(d.noRepeat||!d.explicitRepeat&&0===m)&&(m=1,d.repeatIsExplicit=!1),l.selectedCharacter&&(d.selectedCharacter=u.selectedCharacter=l.selectedCharacter),d.repeat=m,F(e),c){var _,x=B[c](e,g,d,t);if(t.lastMotion=B[c],!x)return;d.toJumplist&&((w=(_=j.jumpList).cachedCursor)?(de(e,w,x),delete _.cachedCursor):de(e,g,x)),w=(w=x instanceof Array?(n=x[0],x[1]):x)||$(g),t.visualMode?(t.visualBlock&&w.ch===1/0||(w=z(e,w,t.visualBlock)),n=(n=n&&z(e,n,!0))||y,p.anchor=n,p.head=w,oe(e),ge(e,t,"<",J(n,w)?n:w),ge(e,t,">",J(n,w)?w:n)):h||(w=z(e,w),e.setCursor(w.line,w.ch))}if(h){if(u.lastSel?(n=y,_=u.lastSel,x=Math.abs(_.head.line-_.anchor.line),g=Math.abs(_.head.ch-_.anchor.ch),w=_.visualLine?Xe(y.line+x,y.ch):_.visualBlock?Xe(y.line+x,y.ch+g):_.head.line==_.anchor.line?Xe(y.line,y.ch+g):Xe(y.line+x,y.ch),t.visualMode=!0,t.visualLine=_.visualLine,t.visualBlock=_.visualBlock,p=t.sel={anchor:n,head:w},oe(e)):t.visualMode&&(u.lastSel={anchor:$(p.anchor),head:$(p.head),visualBlock:t.visualBlock,visualLine:t.visualLine}),t.visualMode){if(o=Y(p.head,p.anchor),s=Q(p.head,p.anchor),i=t.visualLine||u.linewise,C=se(e,{anchor:o,head:s},r=t.visualBlock?"block":i?"line":"char"),i){var b=C.ranges;if("block"==r)for(var k=0;k<b.length;k++)b[k].head.ch=ee(e,b[k].head.line);else"line"==r&&(b[0].head=Xe(b[0].head.line+1,0))}}else{o=$(n||y),J(s=$(w||v),o)&&(a=o,o=s,s=a),(i=d.linewise||u.linewise)?(a=s,o.ch=0,a.ch=0,a.line++):d.forward&&function(e,t,n){t=e.getRange(t,n);if(/\n\s*$/.test(t)){var i=t.split("\n");i.pop();for(var r=i.pop();0<i.length&&r&&S(r);r=i.pop())n.line--,n.ch=0;r?(n.line--,n.ch=ee(e,n.line)):n.ch=0}}(e,o,s);var C=se(e,{anchor:o,head:s},r="char",!d.inclusive||i)}e.setSelections(C.ranges,C.primary),t.lastMotion=null,u.repeat=m,u.registerName=f,u.linewise=i;var w=K[h](e,u,C.ranges,y,w);t.visualMode&&ae(e,null!=w),w&&e.setCursor(w)}},recordLastEdit:function(e,t,n){var i=j.macroModeState;i.isPlaying||(e.lastEditInputState=t,e.lastEditActionCommand=n,i.lastInsertModeChanges.changes=[],i.lastInsertModeChanges.expectCursorActivityForChange=!1)}},B={moveToTopLine:function(e,t,n){n=Ee(e).top+n.repeat-1;return Xe(n,le(e.getLine(n)))},moveToMiddleLine:function(e){var t=Ee(e),t=Math.floor(.5*(t.top+t.bottom));return Xe(t,le(e.getLine(t)))},moveToBottomLine:function(e,t,n){n=Ee(e).bottom-n.repeat+1;return Xe(n,le(e.getLine(n)))},expandToLine:function(e,t,n){return Xe(t.line+n.repeat-1,1/0)},findNext:function(e,t,n){var i=ye(e),r=i.getQuery();if(r){var o=!n.forward,o=i.isReversed()?!o:o;return Ae(e,r),Me(e,o,r,n.repeat)}},goToMark:function(e,t,n,i){i=Ne(e,i,n.selectedCharacter);return i?n.linewise?{line:i.line,ch:le(e.getLine(i.line))}:i:null},moveToOtherHighlightedEnd:function(e,t,n,i){if(i.visualBlock&&n.sameLine){n=i.sel;return[z(e,Xe(n.anchor.line,n.head.ch)),z(e,Xe(n.head.line,n.anchor.ch))]}return[i.sel.head,i.sel.anchor]},jumpToMark:function(e,t,n,i){for(var r=t,o=0;o<n.repeat;o++){var s,a,l,c,d=r;for(s in i.marks)y(s)&&(a=i.marks[s].find(),(n.forward?J(a,d):J(d,a))||n.linewise&&a.line==d.line||(l=X(d,r),c=n.forward?Z(d,a,r):Z(r,a,d),(l||c)&&(r=a)))}return n.linewise&&(r=Xe(r.line,le(e.getLine(r.line)))),r},moveByCharacters:function(e,t,n){var i=n.repeat,i=n.forward?t.ch+i:t.ch-i;return Xe(t.line,i)},moveByLines:function(e,t,n,i){var r=t,o=r.ch;switch(i.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:o=i.lastHPos;break;default:i.lastHPos=o}var s=n.repeat+(n.repeatOffset||0),a=n.forward?r.line+s:r.line-s,l=e.firstLine(),s=e.lastLine();return a<l&&r.line==l?this.moveToStartOfLine(e,t,n,i):s<a&&r.line==s?this.moveToEol(e,t,n,i):(n.toFirstChar&&(o=le(e.getLine(a)),i.lastHPos=o),i.lastHSPos=e.charCoords(Xe(a,o),"div").left,Xe(a,o))},moveByDisplayLines:function(e,t,n,i){var r=t;switch(i.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:i.lastHSPos=e.charCoords(r,"div").left}var o,t=n.repeat,t=e.findPosV(r,n.forward?t:-t,"line",i.lastHSPos);return t.hitSide&&(t=n.forward?(o={top:e.charCoords(t,"div").top+8,left:i.lastHSPos},e.coordsChar(o,"div")):((o=e.charCoords(Xe(e.firstLine(),0),"div")).left=i.lastHSPos,e.coordsChar(o,"div"))),i.lastHPos=t.ch,t},moveByPage:function(e,t,n){var i=n.repeat;return e.findPosV(t,n.forward?i:-i,"page")},moveByParagraph:function(e,t,n){var i=n.forward?1:-1;return me(e,t,n.repeat,i)},moveBySentence:function(e,t,n){var i=n.forward?1:-1;return function(e,t,n,i){function d(e,t){if(t.pos+t.dir<0||t.pos+t.dir>=t.line.length){if(t.ln+=t.dir,!v(e,t.ln))return t.line=null,t.ln=null,void(t.pos=null);t.line=e.getLine(t.ln),t.pos=0<t.dir?0:t.line.length-1}else t.pos+=t.dir}var r={ln:t.line,pos:t.ch};for(;0<n;)r=(i<0?function(e,t,n,i){var r={line:a=e.getLine(t),ln:t,pos:n,dir:i},o={ln:r.ln,pos:null},s=""===r.line;for(d(e,r);null!==r.line;){if(""===r.line&&!s)return null!==o.pos?o:{ln:r.ln,pos:r.pos};if(x(r.line[r.pos])&&null!==o.pos&&(r.ln!==o.ln||r.pos+1!==o.pos))return o;""===r.line||S(r.line[r.pos])||(s=!1,o={ln:r.ln,pos:r.pos}),d(e,r)}for(var a=e.getLine(o.ln),l=o.pos=0;l<a.length;++l)if(!S(a[l])){o.pos=l;break}return o}:function(e,t,n,i){var r=""===(l=e.getLine(t)),o={line:l,ln:t,pos:n,dir:i},s={ln:o.ln,pos:o.pos},a=""===o.line;for(d(e,o);null!==o.line;){if(s.ln=o.ln,s.pos=o.pos,""===o.line&&!a)return{ln:o.ln,pos:o.pos};if(r&&""!==o.line&&!S(o.line[o.pos]))return{ln:o.ln,pos:o.pos};!x(o.line[o.pos])||r||o.pos!==o.line.length-1&&!S(o.line[o.pos+1])||(r=!0),d(e,o)}var l=e.getLine(s.ln);s.pos=0;for(var c=l.length-1;0<=c;--c)if(!S(l[c])){s.pos=c;break}return s})(e,r.ln,r.pos,i),n--;return Xe(r.ln,r.pos)}(e,t,n.repeat,i)},moveByScroll:function(e,t,n,i){var r=e.getScrollInfo(),o=null,s=(s=n.repeat)||r.clientHeight/(2*e.defaultTextHeight()),a=e.charCoords(t,"local");if(n.repeat=s,!(o=B.moveByDisplayLines(e,t,n,i)))return null;i=e.charCoords(o,"local");return e.scrollTo(null,r.top+i.top-a.top),o},moveByWords:function(e,t,n){return function(e,t,n,i,r,o){var s=$(t),a=[];(i&&!r||!i&&r)&&n++;for(var l=!(i&&r),c=0;c<n;c++){var d=function(e,t,n,i,r){var o=t.line,s=t.ch,a=e.getLine(o),l=n?1:-1,c=i?m:g;if(r&&""==a){if(o+=l,a=e.getLine(o),!v(e,o))return null;s=n?0:a.length}for(;;){if(r&&""==a)return{from:0,to:0,line:o};for(var d=0<l?a.length:-1,h=d,u=d;s!=d;){for(var f=!1,p=0;p<c.length&&!f;++p)if(c[p](a.charAt(s))){for(h=s;s!=d&&c[p](a.charAt(s));)s+=l;if(f=h!=(u=s),h!=t.ch||o!=t.line||u!=h+l)return{from:Math.min(h,u+1),to:Math.max(h,u),line:o}}f||(s+=l)}if(!v(e,o+=l))return null;a=e.getLine(o),s=0<l?0:a.length}}(e,t,i,o,l);if(!d){var h=ee(e,e.lastLine());a.push(i?{line:e.lastLine(),from:h,to:h}:{line:0,from:0,to:0});break}a.push(d),t=Xe(d.line,i?d.to-1:d.from)}var u=a.length!=n,f=a[0],p=a.pop();return i&&!r?(u||f.from==s.ch&&f.line==s.line||(p=a.pop()),Xe(p.line,p.from)):i&&r?Xe(p.line,p.to-1):!i&&r?(u||f.to==s.ch&&f.line==s.line||(p=a.pop()),Xe(p.line,p.to)):Xe(p.line,p.from)}(e,t,n.repeat,!!n.forward,!!n.wordEnd,!!n.bigWord)},moveTillCharacter:function(e,t,n){var i=pe(e,n.repeat,n.forward,n.selectedCharacter),e=n.forward?-1:1;return he(e,n),i?(i.ch+=e,i):null},moveToCharacter:function(e,t,n){var i=n.repeat;return he(0,n),pe(e,i,n.forward,n.selectedCharacter)||t},moveToSymbol:function(e,t,n){return function(e,t,n,i){var r=$(e.getCursor()),o=n?1:-1,s=n?e.lineCount():-1,a=r.ch,l=r.line,c=e.getLine(l),d={lineText:c,nextCh:c.charAt(a),lastCh:null,index:a,symb:i,reverseSymb:(n?{")":"(","}":"{"}:{"(":")","{":"}"})[i],forward:n,depth:0,curMoveThrough:!1},n=ue[i];if(!n)return r;var i=fe[n].init,h=fe[n].isComplete;i&&i(d);for(;l!==s&&t;){var u;d.index+=o,d.nextCh=d.lineText.charAt(d.index),d.nextCh||(l+=o,d.lineText=e.getLine(l)||"",0<o?d.index=0:(u=d.lineText.length,d.index=0<u?u-1:0),d.nextCh=d.lineText.charAt(d.index)),h(d)&&(r.line=l,r.ch=d.index,t--)}if(d.nextCh||d.curMoveThrough)return Xe(l,d.index);return r}(e,n.repeat,n.forward,n.selectedCharacter)||t},moveToColumn:function(e,t,n,i){n=n.repeat;return i.lastHPos=n-1,i.lastHSPos=e.charCoords(t,"div").left,t=n,e=(n=e).getCursor().line,z(n,Xe(e,t-1))},moveToEol:function(e,t,n,i){i.lastHPos=1/0;t=Xe(t.line+n.repeat-1,1/0),n=e.clipPos(t);return n.ch--,i.lastHSPos=e.charCoords(n,"div").left,t},moveToFirstNonWhiteSpaceCharacter:function(e,t){return Xe(t.line,le(e.getLine(t.line)))},moveToMatchedSymbol:function(e,t){for(var n=t,i=n.line,r=n.ch,o=e.getLine(i);r<o.length;r++)if((s=o.charAt(r))&&-1!="()[]{}".indexOf(s)){var s=e.getTokenTypeAt(Xe(i,r+1));if("string"!==s&&"comment"!==s)break}if(r<o.length){t="<"===r||">"===r?/[(){}[\]<>]/:/[(){}[\]]/;return e.findMatchingBracket(Xe(i,r),{bracketRegex:t}).to}return n},moveToStartOfLine:function(e,t){return Xe(t.line,0)},moveToLineOrEdgeOfDocument:function(e,t,n){var i=n.forward?e.lastLine():e.firstLine();return n.repeatIsExplicit&&(i=n.repeat-e.getOption("firstLineNumber")),Xe(i,le(e.getLine(i)))},textObjectManipulation:function(e,t,n,i){var r=n.selectedCharacter;"b"==r?r="(":"B"==r&&(r="{");var o=!n.textObjectInner;if({"(":")",")":"(","{":"}","}":"{","[":"]","]":"[","<":">",">":"<"}[r])s=function(e,t,n,i){var r=t,o={"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/,"<":/[<>]/,">":/[<>]/}[n],t={"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{","<":"<",">":"<"}[n],n=e.getLine(r.line).charAt(r.ch)===t?1:0;if(t=e.scanForBracket(Xe(r.line,r.ch+n),-1,void 0,{bracketRegex:o}),o=e.scanForBracket(Xe(r.line,r.ch+n),1,void 0,{bracketRegex:o}),!t||!o)return{start:r,end:r};t=t.pos,o=o.pos,(t.line==o.line&&t.ch>o.ch||t.line>o.line)&&(r=t,t=o,o=r);i?o.ch+=1:t.ch+=1;return{start:t,end:o}}(e,t,r,o);else if({"'":!0,'"':!0}[r])s=function(e,t,n,i){var r,o,s,a,t=$(t),l=e.getLine(t.line).split(""),e=l.indexOf(n);t.ch<e?t.ch=e:e<t.ch&&l[t.ch]==n&&(o=t.ch,--t.ch);if(l[t.ch]!=n||o)for(s=t.ch;-1<s&&!r;s--)l[s]==n&&(r=s+1);else r=t.ch+1;if(r&&!o)for(s=r,a=l.length;s<a&&!o;s++)l[s]==n&&(o=s);if(!r||!o)return{start:t,end:t};i&&(--r,++o);return{start:Xe(t.line,r),end:Xe(t.line,o)}}(e,t,r,o);else if("W"===r)s=ce(e,o,0,!0);else if("w"===r)s=ce(e,o,0,!1);else{if("p"!==r)return null;var s=me(e,t,n.repeat,0,o);n.linewise=!0,i.visualMode?i.visualLine||(i.visualLine=!0):((i=i.inputState.operatorArgs)&&(i.linewise=!0),s.end.line--)}return e.state.vim.visualMode?function(e,t,n){var i=e.state.vim.sel,r=i.head,o=i.anchor;J(n,t)&&(i=n,n=t,t=i);J(r,o)?(r=Y(t,r),o=Q(o,n)):(o=Y(t,o),-1==(r=q(r=Q(r,n),0,-1)).ch&&r.line!=e.firstLine()&&(r=Xe(r.line-1,ee(e,r.line-1))));return[o,r]}(e,s.start,s.end):[s.start,s.end]},repeatLastCharacterSearch:function(e,t,n){var i=j.lastCharacterSearch,r=n.repeat,o=n.forward===i.forward,s=(i.increment?1:0)*(o?-1:1);e.moveH(-s,"char");i=pe(e,r,n.inclusive=o,i.selectedCharacter);return i?(i.ch+=s,i):(e.moveH(s,"char"),t)}};function W(e,t){for(var n=[],i=0;i<t;i++)n.push(e);return n}var K={change:function(e,t,n){var i,r,o,s,a=e.state.vim;j.macroModeState.lastInsertModeChanges.inVisualBlock=a.visualBlock,i=a.visualMode?(o=e.getSelection(),r=W("",n.length),e.replaceSelections(r),Y(n[0].head,n[0].anchor)):(i=n[0].anchor,r=n[0].head,o=e.getRange(i,r),"moveByWords"!=(a=a.lastEditInputState||{}).motion||S(o)||(s=/\s+$/.exec(o))&&a.motionArgs&&a.motionArgs.forward&&(r=q(r,0,-s[0].length),o=o.slice(0,-s[0].length)),a=new Xe(i.line-1,Number.MAX_VALUE),s=e.firstLine()==e.lastLine(),r.line>e.lastLine()&&t.linewise&&!s?e.replaceRange("",a,r):e.replaceRange("",i,r),t.linewise&&(s||(e.setCursor(a),Ve.commands.newlineAndIndent(e)),i.ch=Number.MAX_VALUE),i),j.registerController.pushText(t.registerName,"change",o,t.linewise,1<n.length),U.enterInsertMode(e,{head:i},e.state.vim)},delete:function(e,t,n){var i,r,o,s=e.state.vim;return s.visualBlock?(r=e.getSelection(),o=W("",n.length),e.replaceSelections(o),i=n[0].anchor):(o=n[0].anchor,n=n[0].head,t.linewise&&n.line!=e.firstLine()&&o.line==e.lastLine()&&o.line==n.line-1&&(o.line==e.firstLine()?o.ch=0:o=Xe(o.line-1,ee(e,o.line-1))),r=e.getRange(o,n),e.replaceRange("",o,n),i=o,t.linewise&&(i=B.moveToFirstNonWhiteSpaceCharacter(e,o))),j.registerController.pushText(t.registerName,"delete",r,t.linewise,s.visualBlock),z(e,i,s.insertMode)},indent:function(e,t,n){var i=e.state.vim,r=n[0].anchor.line,o=(i.visualBlock?n[n.length-1].anchor:n[0].head).line,s=i.visualMode?t.repeat:1;t.linewise&&o--;for(var a=r;a<=o;a++)for(var l=0;l<s;l++)e.indentLine(a,t.indentRight);return B.moveToFirstNonWhiteSpaceCharacter(e,n[0].anchor)},indentAuto:function(e,t,n){return e.execCommand("indentAuto"),B.moveToFirstNonWhiteSpaceCharacter(e,n[0].anchor)},changeCase:function(e,t,n,i,r){for(var o=e.getSelections(),s=[],a=t.toLower,l=0;l<o.length;l++){var c=o[l],d="";if(!0===a)d=c.toLowerCase();else if(!1===a)d=c.toUpperCase();else for(var h=0;h<c.length;h++){var u=c.charAt(h);d+=_(u)?u.toLowerCase():u.toUpperCase()}s.push(d)}return e.replaceSelections(s),t.shouldMoveCursor?r:!e.state.vim.visualMode&&t.linewise&&n[0].anchor.line+1==n[0].head.line?B.moveToFirstNonWhiteSpaceCharacter(e,i):t.linewise?i:Y(n[0].anchor,n[0].head)},yank:function(e,t,n,i){var r=e.state.vim,e=e.getSelection(),i=r.visualMode?Y(r.sel.anchor,r.sel.head,n[0].head,n[0].anchor):i;return j.registerController.pushText(t.registerName,"yank",e,t.linewise,r.visualBlock),i}};var U={jumpListWalk:function(e,t,n){n.visualMode||(n=t.repeat,t=t.forward,n=(n=(n=j.jumpList.move(e,t?n:-n))?n.find():void 0)||e.getCursor(),e.setCursor(n))},scroll:function(e,t,n){var i,r,o;n.visualMode||(r=t.repeat||1,i=e.defaultTextHeight(),o=e.getScrollInfo().top,n=i*r,r=t.forward?o+n:o-n,o=$(e.getCursor()),n=e.charCoords(o,"local"),t.forward?r>n.top?(o.line+=(r-n.top)/i,o.line=Math.ceil(o.line),e.setCursor(o),n=e.charCoords(o,"local"),e.scrollTo(null,n.top)):e.scrollTo(null,r):(t=r+e.getScrollInfo().clientHeight)<n.bottom?(o.line-=(n.bottom-t)/i,o.line=Math.floor(o.line),e.setCursor(o),n=e.charCoords(o,"local"),e.scrollTo(null,n.bottom-e.getScrollInfo().clientHeight)):e.scrollTo(null,r))},scrollToCursor:function(e,t){var n=e.getCursor().line,n=e.charCoords(Xe(n,0),"local"),i=e.getScrollInfo().clientHeight,r=n.top,o=n.bottom-r;switch(t.position){case"center":r=r-i/2+o;break;case"bottom":r=r-i+o}e.scrollTo(null,r)},replayMacro:function(e,t,n){var i=t.selectedCharacter,r=t.repeat,o=j.macroModeState;for("@"==i&&(i=o.latestRegister);r--;)!function(e,t,n,i){var r=j.registerController.getRegister(i);if(":"==i)return r.keyBuffer[0]&&Fe.processCommand(e,r.keyBuffer[0]),n.isPlaying=!1;var o=r.keyBuffer,s=0;n.isPlaying=!0,n.replaySearchQueries=r.searchQueries.slice(0);for(var a,l=0;l<o.length;l++)for(var c,d=o[l];d;)a=/<\w+-.+?>|<\w+>|./.exec(d),c=a[0],d=d.substring(a.index+c.length),Ve.Vim.handleKey(e,c,"macro"),t.insertMode&&(c=r.insertModeChanges[s++].changes,j.macroModeState.lastInsertModeChanges.changes=c,ze(e,c,1),De(e));n.isPlaying=!1}(e,n,o,i)},enterMacroRecordMode:function(e,t){var n=j.macroModeState,t=t.selectedCharacter;j.registerController.isValidRegister(t)&&n.enterMacroRecordMode(e,t)},toggleOverwrite:function(e){e.state.overwrite?(e.toggleOverwrite(!1),e.setOption("keyMap","vim-insert"),Ve.signal(e,"vim-mode-change",{mode:"insert"})):(e.toggleOverwrite(!0),e.setOption("keyMap","vim-replace"),Ve.signal(e,"vim-mode-change",{mode:"replace"}))},enterInsertMode:function(e,t,n){if(!e.getOption("readOnly")){n.insertMode=!0,n.insertModeRepeat=t&&t.repeat||1;var i=t?t.insertAt:null,r=n.sel,o=t.head||e.getCursor("head"),s=e.listSelections().length;if("eol"==i)o=Xe(o.line,ee(e,o.line));else if("charAfter"==i)o=q(o,0,1);else if("firstNonBlank"==i)o=B.moveToFirstNonWhiteSpaceCharacter(e,o);else if("startOfSelectedArea"==i)n.visualBlock?(o=Xe(Math.min(r.head.line,r.anchor.line),Math.min(r.head.ch,r.anchor.ch)),s=Math.abs(r.head.line-r.anchor.line)+1):o=r.head.line<r.anchor.line?r.head:Xe(r.anchor.line,0);else if("endOfSelectedArea"==i)n.visualBlock?(o=Xe(Math.min(r.head.line,r.anchor.line),Math.max(r.head.ch+1,r.anchor.ch)),s=Math.abs(r.head.line-r.anchor.line)+1):o=r.head.line>=r.anchor.line?q(r.head,0,1):Xe(r.anchor.line,0);else if("inplace"==i&&n.visualMode)return;e.setOption("disableInput",!1),t&&t.replace?(e.toggleOverwrite(!0),e.setOption("keyMap","vim-replace"),Ve.signal(e,"vim-mode-change",{mode:"replace"})):(e.toggleOverwrite(!1),e.setOption("keyMap","vim-insert"),Ve.signal(e,"vim-mode-change",{mode:"insert"})),j.macroModeState.isPlaying||(e.on("change",Re),Ve.on(e.getInputField(),"keydown",Ke)),n.visualMode&&ae(e),ie(e,o,s)}},toggleVisualMode:function(e,t,n){var i=t.repeat,r=e.getCursor();n.visualMode?n.visualLine^t.linewise||n.visualBlock^t.blockwise?(n.visualLine=!!t.linewise,n.visualBlock=!!t.blockwise,Ve.signal(e,"vim-mode-change",{mode:"visual",subMode:n.visualLine?"linewise":n.visualBlock?"blockwise":""}),oe(e)):ae(e):(n.visualMode=!0,n.visualLine=!!t.linewise,n.visualBlock=!!t.blockwise,i=z(e,Xe(r.line,r.ch+i-1),!0),n.sel={anchor:r,head:i},Ve.signal(e,"vim-mode-change",{mode:"visual",subMode:n.visualLine?"linewise":n.visualBlock?"blockwise":""}),oe(e),ge(e,n,"<",Y(r,i)),ge(e,n,">",Q(r,i)))},reselectLastSelection:function(e,t,n){var i,r,o=n.lastSelection;n.visualMode&&re(e,n),o&&(i=o.anchorMark.find(),r=o.headMark.find(),i&&r&&(n.sel={anchor:i,head:r},n.visualMode=!0,n.visualLine=o.visualLine,n.visualBlock=o.visualBlock,oe(e),ge(e,n,"<",Y(i,r)),ge(e,n,">",Q(i,r)),Ve.signal(e,"vim-mode-change",{mode:"visual",subMode:n.visualLine?"linewise":n.visualBlock?"blockwise":""})))},joinLines:function(e,t,n){var i,r;n.visualMode?(r=e.getCursor("anchor"),J(i=e.getCursor("head"),r)&&(a=i,i=r,r=a),i.ch=ee(e,i.line)-1):(c=Math.max(t.repeat,2),r=e.getCursor(),i=z(e,Xe(r.line+c-1,1/0)));for(var o=0,s=r.line;s<i.line;s++){o=ee(e,r.line);var a=Xe(r.line+1,ee(e,r.line+1)),l=(l=e.getRange(r,a)).replace(/\n\s*/g," ");e.replaceRange(l,r,a)}var c=Xe(r.line,o);n.visualMode&&ae(e,!1),e.setCursor(c)},newLineAndEnterInsertMode:function(e,t,n){n.insertMode=!0;var i=$(e.getCursor());i.line!==e.firstLine()||t.after?(i.line=t.after?i.line:i.line-1,i.ch=ee(e,i.line),e.setCursor(i),(Ve.commands.newlineAndIndentContinueComment||Ve.commands.newlineAndIndent)(e)):(e.replaceRange("\n",Xe(e.firstLine(),0)),e.setCursor(e.firstLine(),0)),this.enterInsertMode(e,{repeat:t.repeat},n)},paste:function(n,e,t){var i,r,o,s,a=$(n.getCursor()),l=j.registerController.getRegister(e.registerName),c=l.toString();if(c){e.matchIndent&&(i=n.getOption("tabSize"),r=function(e){var t=e.split("\t").length-1,e=e.split(" ").length-1;return t*i+e},y=n.getLine(n.getCursor().line),o=r(y.match(/^\s*/)[0]),k=c.replace(/\n$/,""),x=c!==k,s=r(c.match(/^\s*/)[0]),c=k.replace(/^\s*/gm,function(e){var t=o+(r(e)-s);if(t<0)return"";if(n.getOption("indentWithTabs")){e=Math.floor(t/i);return Array(e+1).join("\t")}return Array(t+1).join(" ")}),c+=x?"\n":""),1<e.repeat&&(c=Array(e.repeat+1).join(c));var d,h,u,f,p,g,m,v=l.linewise,y=l.blockwise;if(v)t.visualMode?c=t.visualLine?c.slice(0,-1):"\n"+c.slice(0,c.length-1)+"\n":e.after?(c="\n"+c.slice(0,c.length-1),a.ch=ee(n,a.line)):a.ch=0;else{if(y){c=c.split("\n");for(var _=0;_<c.length;_++)c[_]=""==c[_]?" ":c[_]}a.ch+=e.after?1:0}if(t.visualMode){t.lastPastedText=c;var x=(g=n,m=(k=t).lastSelection,(k.visualMode?function(){var e=g.listSelections(),t=e[0],e=e[e.length-1];return[J(t.anchor,t.head)?t.anchor:t.head,J(e.anchor,e.head)?e.head:e.anchor]}:function(){var e=g.getCursor(),t=g.getCursor(),n=m.visualBlock;if(n){for(var i=n.width,r=n.height,t=Xe(e.line+r,e.ch+i),o=[],s=e.line;s<t.line;s++){var a={anchor:Xe(s,e.ch),head:Xe(s,t.ch)};o.push(a)}g.setSelections(o)}else{n=m.anchorMark.find(),r=m.headMark.find(),i=r.line-n.line,n=r.ch-n.ch;t={line:t.line+i,ch:i?t.ch:n+t.ch},m.visualLine&&(e=Xe(e.line,0),t=Xe(t.line,ee(g,t.line))),g.setSelection(e,t)}return[e,t]})()),b=x[0],l=x[1],k=n.getSelection(),x=n.listSelections(),x=new Array(x.length).join("1").split("1");t.lastSelection&&(h=t.lastSelection.headMark.find()),j.registerController.unnamedRegister.setText(k),b=y?(n.replaceSelections(x),l=Xe(b.line+c.length-1,b.ch),n.setCursor(b),ne(n,l),n.replaceSelections(c),b):t.visualBlock?(n.replaceSelections(x),n.setCursor(b),n.replaceRange(c,b,b),b):(n.replaceRange(c,b,l),n.posFromIndex(n.indexFromPos(b)+c.length-1)),h&&(t.lastSelection.headMark=n.setBookmark(h)),v&&(b.ch=0)}else if(y){n.setCursor(a);for(_=0;_<c.length;_++){var C=a.line+_;C>n.lastLine()&&n.replaceRange("\n",Xe(C,0)),ee(n,C)<a.ch&&(u=n,f=C,p=a.ch,C=void 0,C=ee(u,f),p=new Array(p-C+1).join(" "),u.setCursor(Xe(f,C)),u.replaceRange(p,u.getCursor()))}n.setCursor(a),ne(n,Xe(a.line+c.length-1,a.ch)),n.replaceSelections(c),b=a}else n.replaceRange(c,a),b=v&&e.after?Xe(a.line+1,le(n.getLine(a.line+1))):v&&!e.after?Xe(a.line,le(n.getLine(a.line))):!v&&e.after?(d=n.indexFromPos(a),n.posFromIndex(d+c.length-1)):(d=n.indexFromPos(a),n.posFromIndex(d+c.length));t.visualMode&&ae(n,!1),n.setCursor(b)}},undo:function(e,t){e.operation(function(){G(e,Ve.commands.undo,t.repeat)(),e.setCursor(e.getCursor("anchor"))})},redo:function(e,t){G(e,Ve.commands.redo,t.repeat)()},setRegister:function(e,t,n){n.inputState.registerName=t.selectedCharacter},setMark:function(e,t,n){ge(e,n,t.selectedCharacter,e.getCursor())},replace:function(e,t,n){var i,r,o=t.selectedCharacter,s=e.getCursor(),a=e.listSelections(),t=n.visualMode?(s=e.getCursor("start"),e.getCursor("end")):(r=e.getLine(s.line),(i=s.ch+t.repeat)>r.length&&(i=r.length),Xe(s.line,i));"\n"==o?(n.visualMode||e.replaceRange("",s,t),(Ve.commands.newlineAndIndentContinueComment||Ve.commands.newlineAndIndent)(e)):(r=(r=e.getRange(s,t)).replace(/[^\n]/g,o),n.visualBlock?(i=new Array(e.getOption("tabSize")+1).join(" "),r=(r=e.getSelection()).replace(/\t/g,i).replace(/[^\n]/g,o).split("\n"),e.replaceSelections(r)):e.replaceRange(r,s,t),n.visualMode?(s=J(a[0].anchor,a[0].head)?a[0].anchor:a[0].head,e.setCursor(s),ae(e,!1)):e.setCursor(q(t,0,-1)))},incrementNumberToken:function(e,t){for(var n,i,r,o,s,a,l,c=e.getCursor(),d=e.getLine(c.line),h=/(-?)(?:(0x)([\da-f]+)|(0b|0|)(\d+))/gi;null!==(n=h.exec(d))&&(r=(i=n.index)+n[0].length,!(c.ch<r)););!t.backtrack&&r<=c.ch||n&&(a=n[2]||n[4],l=n[3]||n[5],o=t.increase?1:-1,s={"0b":2,0:8,"":10,"0x":16}[a.toLowerCase()],s=(parseInt(n[1]+l,s)+o*t.repeat).toString(s),l=a?new Array(l.length-s.length+1+n[1].length).join("0"):"",s="-"===s.charAt(0)?"-"+a+l+s.substr(1):a+l+s,a=Xe(c.line,i),l=Xe(c.line,r),e.replaceRange(s,a,l),e.setCursor(Xe(c.line,i+s.length-1)))},repeatLastEdit:function(e,t,n){var i;n.lastEditInputState&&((i=t.repeat)&&t.repeatIsExplicit?n.lastEditInputState.repeatOverride=i:i=n.lastEditInputState.repeatOverride||i,Ue(e,n,i,!1))},indent:function(e,t){e.indentLine(e.getCursor().line,t.indentRight)},exitInsertMode:De};function z(e,t,n){var i=Math.min(Math.max(e.firstLine(),t.line),e.lastLine()),e=ee(e,i)-1,e=n?e+1:e,e=Math.min(Math.max(0,t.ch),e);return Xe(i,e)}function V(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function q(e,t,n){return"object"==typeof t&&(n=t.ch,t=t.line),Xe(e.line+t,e.ch+n)}function G(t,n,i){return function(){for(var e=0;e<i;e++)n(t)}}function $(e){return Xe(e.line,e.ch)}function X(e,t){return e.ch==t.ch&&e.line==t.line}function J(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function Y(e,t){return 2<arguments.length&&(t=Y.apply(void 0,Array.prototype.slice.call(arguments,1))),J(e,t)?e:t}function Q(e,t){return 2<arguments.length&&(t=Q.apply(void 0,Array.prototype.slice.call(arguments,1))),J(e,t)?t:e}function Z(e,t,n){e=J(e,t),n=J(t,n);return e&&n}function ee(e,t){return e.getLine(t).length}function te(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function ne(e,t){var n=[],i=e.listSelections(),r=$(e.clipPos(t)),o=!X(t,r),s=function(e,t,n){for(var i=0;i<e.length;i++){var r="head"!=n&&X(e[i].anchor,t),o="anchor"!=n&&X(e[i].head,t);if(r||o)return i}return-1}(i,e.getCursor("head")),a=X(i[s].head,i[s].anchor),l=i.length-1,c=s<l-s?l:0,s=i[c].anchor,l=Math.min(s.line,r.line),d=Math.max(s.line,r.line),h=s.ch,u=r.ch,i=i[c].head.ch-h,c=u-h;0<i&&c<=0?(h++,o||u--):i<0&&0<=c?(h--,a||u++):i<0&&-1==c&&(h--,u++);for(var f=l;f<=d;f++){var p={anchor:new Xe(f,h),head:new Xe(f,u)};n.push(p)}return e.setSelections(n),t.ch=u,s.ch=h,s}function ie(e,t,n){for(var i=[],r=0;r<n;r++){var o=q(t,r,0);i.push({anchor:o,head:o})}e.setSelections(i,0)}function re(e,t){var n=t.sel.anchor,i=t.sel.head;t.lastPastedText&&(i=e.posFromIndex(e.indexFromPos(n)+t.lastPastedText.length),t.lastPastedText=null),t.lastSelection={anchorMark:e.setBookmark(n),headMark:e.setBookmark(i),anchor:$(n),head:$(i),visualMode:t.visualMode,visualLine:t.visualLine,visualBlock:t.visualBlock}}function oe(e,t,n){var i=e.state.vim,n=se(e,t=t||i.sel,n=n||i.visualLine?"line":i.visualBlock?"block":"char");e.setSelections(n.ranges,n.primary),Be(e)}function se(e,t,n,i){var r=$(t.head),o=$(t.anchor);if("char"==n){var s=i||J(t.head,t.anchor)?0:1,i=J(t.head,t.anchor)?1:0,r=q(t.head,0,s);return{ranges:[{anchor:o=q(t.anchor,0,i),head:r}],primary:0}}if("line"==n)return J(t.head,t.anchor)?(r.ch=0,o.ch=ee(e,o.line)):(o.ch=0,t=e.lastLine(),r.line>t&&(r.line=t),r.ch=ee(e,r.line)),{ranges:[{anchor:o,head:r}],primary:0};if("block"==n){for(var a=Math.min(o.line,r.line),l=Math.min(o.ch,r.ch),n=Math.max(o.line,r.line),c=Math.max(o.ch,r.ch)+1,d=n-a+1,r=r.line==a?0:d-1,h=[],u=0;u<d;u++)h.push({anchor:Xe(a+u,l),head:Xe(a+u,c)});return{ranges:h,primary:r}}}function ae(e,t){var n=e.state.vim;!1!==t&&e.setCursor(z(e,n.sel.head)),re(e,n),n.visualMode=!1,n.visualLine=!1,n.visualBlock=!1,Ve.signal(e,"vim-mode-change",{mode:"normal"}),n.fakeCursor&&n.fakeCursor.clear()}function le(e){if(!e)return 0;var t=e.search(/\S/);return-1==t?e.length:t}function ce(e,t,n,i,r){for(var o,s,s=(s=(o=e).getCursor("head"),1==o.getSelection().length&&(s=Y(s,o.getCursor("anchor"))),s),a=e.getLine(s.line),l=s.ch,c=(r?g:m)[0];!c(a.charAt(l));)if(++l>=a.length)return null;i?c=m[0]:(c=g[0])(a.charAt(l))||(c=g[1]);for(var d=l,h=l;c(a.charAt(d))&&d<a.length;)d++;for(;c(a.charAt(h))&&0<=h;)h--;if(h++,t){for(t=d;/\s/.test(a.charAt(d))&&d<a.length;)d++;if(t==d){for(t=h;/\s/.test(a.charAt(h-1))&&0<h;)h--;h=h||t}}return{start:Xe(s.line,h),end:Xe(s.line,d)}}function de(e,t,n){X(t,n)||j.jumpList.add(e,t,n)}function he(e,t){j.lastCharacterSearch.increment=e,j.lastCharacterSearch.forward=t.forward,j.lastCharacterSearch.selectedCharacter=t.selectedCharacter}var ue={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},fe={bracket:{isComplete:function(e){if(e.nextCh===e.symb){if(e.depth++,1<=e.depth)return!0}else e.nextCh===e.reverseSymb&&e.depth--;return!1}},section:{init:function(e){e.curMoveThrough=!0,e.symb=(e.forward?"]":"[")===e.symb?"{":"}"},isComplete:function(e){return 0===e.index&&e.nextCh===e.symb}},comment:{isComplete:function(e){var t="*"===e.lastCh&&"/"===e.nextCh;return e.lastCh=e.nextCh,t}},method:{init:function(e){e.symb="m"===e.symb?"{":"}",e.reverseSymb="{"===e.symb?"}":"{"},isComplete:function(e){return e.nextCh===e.symb}},preprocess:{init:function(e){e.index=0},isComplete:function(e){if("#"===e.nextCh){var t=e.lineText.match(/#(\w+)/)[1];if("endif"===t){if(e.forward&&0===e.depth)return!0;e.depth++}else if("if"===t){if(!e.forward&&0===e.depth)return!0;e.depth--}if("else"===t&&0===e.depth)return!0}return!1}}};function pe(e,t,n,i){for(var r,o=e.getCursor(),s=o.ch,a=0;a<t;a++){if(-1==(r=function(e,t,n,i,r){var o;i?-1==(o=t.indexOf(n,e+1))||r||--o:-1==(o=t.lastIndexOf(n,e-1))||r||(o+=1);return o}(s,e.getLine(o.line),i,n,!0)))return null;s=r}return Xe(e.getCursor().line,r)}function ge(e,t,n,i){b(n,f)&&(t.marks[n]&&t.marks[n].clear(),t.marks[n]=e.setBookmark(i))}function me(t,e,n,i,r){var o=e.line,s=t.firstLine(),a=t.lastLine(),l=o;function c(e){return!t.getLine(e)}function d(e,t,n){return n?c(e)!=c(e+t):!c(e)&&c(e+t)}if(i){for(;s<=l&&l<=a&&0<n;)d(l,i)&&n--,l+=i;return new Xe(l,0)}var h,e=t.state.vim;e.visualLine&&d(o,1,!0)&&(d((h=e.sel.anchor).line,-1,!0)&&(r&&h.line==o||(o+=1)));for(var u=c(o),l=o;l<=a&&n;l++)d(l,1,!0)&&(r&&c(l)==u||n--);for(h=new Xe(l,0),a<l&&!u?u=!0:r=!1,l=o;s<l&&(r&&c(l)!=u&&l!=o||!d(l,-1,!0));l--);return{start:new Xe(l,0),end:h}}function ve(){}function ye(e){e=e.state.vim;return e.searchState_||(e.searchState_=new ve)}function _e(e,t){var n=xe(e,t)||[];if(!n.length)return[];var i=[];if(0===n[0]){for(var r=0;r<n.length;r++)"number"==typeof n[r]&&i.push(e.substring(n[r]+1,n[r+1]));return i}}function xe(e,t){t=t||"/";for(var n=!1,i=[],r=0;r<e.length;r++){var o=e.charAt(r);n||o!=t||i.push(r),n=!n&&"\\"==o}return i}C("pcre",!0,"boolean"),ve.prototype={getQuery:function(){return j.query},setQuery:function(e){j.query=e},getOverlay:function(){return this.searchOverlay},setOverlay:function(e){this.searchOverlay=e},isReversed:function(){return j.isReversed},setReversed:function(e){j.isReversed=e},getScrollbarAnnotate:function(){return this.annotate},setScrollbarAnnotate:function(e){this.annotate=e}};var be={"\\n":"\n","\\r":"\r","\\t":"\t"};function ke(e){for(var t,n=!1,i=[],r=-1;r<e.length;r++){var o=e.charAt(r)||"",s=e.charAt(r+1)||"";be[o+s]?(i.push(be[o+s]),r++):n?(i.push(o),n=!1):"\\"===o?(n=!0,t=s,c.test(t)||"$"===s?i.push("$"):"/"!==s&&"\\"!==s&&i.push("\\")):("$"===o&&i.push("$"),i.push(o),"/"===s&&i.push("\\"))}return i.join("")}var Ce={"\\/":"/","\\\\":"\\","\\n":"\n","\\r":"\r","\\t":"\t"};function we(e,t,n){if(j.registerController.getRegister("/").setText(e),e instanceof RegExp)return e;var i,r,o=xe(e,"/");return o.length?(i=e.substring(0,o[0]),r=-1!=e.substring(o[0]).indexOf("i")):i=e,i?(T("pcre")||(i=function(e){for(var t=!1,n=[],i=-1;i<e.length;i++){var r=e.charAt(i)||"",o=e.charAt(i+1)||"",s=o&&-1!="|(){".indexOf(o);t?("\\"===r&&s||n.push(r),t=!1):"\\"===r?(t=!0,o&&-1!="}".indexOf(o)&&(s=!0),s&&"\\"!==o||n.push(r)):(n.push(r),s&&"\\"!==o&&n.push("\\"))}return n.join("")}(i)),n&&(t=/^[^A-Z]*$/.test(i)),new RegExp(i,t||r?"i":void 0)):null}function Se(e,t){e.openNotification?e.openNotification('<span style="color: red">'+t+"</span>",{bottom:!0,duration:5e3}):alert(t)}var Te="(Javascript regexp)";function Le(e,t){var n,i,r=(t.prefix||"")+" "+(t.desc||""),i=(n=t.prefix,i=t.desc,n='<span style="font-family: monospace; white-space: pre">'+(n||"")+'<input type="text"></span>',i&&(n+=' <span style="color: #888">'+i+"</span>"),n);n=e,e=i,i=r,r=t.onClose,t=t,n.openDialog?n.openDialog(e,r,{bottom:!0,value:t.value,onKeyDown:t.onKeyDown,onKeyUp:t.onKeyUp,selectValueOnOpen:!1}):r(prompt(i,""))}function je(e,t,n,i){if(t){var r=ye(e),i=we(t,!!n,!!i);if(i)return Ae(e,i),function(e,t){if(e instanceof RegExp&&t instanceof RegExp){for(var n=["global","multiline","ignoreCase","source"],i=0;i<n.length;i++){var r=n[i];if(e[r]!==t[r])return}return 1}}(i,r.getQuery())||r.setQuery(i),i}}function Ae(e,t){var n,i,r=ye(e),o=r.getOverlay();o&&t==o.query||(o&&e.removeOverlay(o),"^"==(n=t).source.charAt(0)&&(i=!0),o={token:function(e){if(!i||e.sol()){var t=e.match(n,!1);if(t)return 0==t[0].length?(e.next(),"searching"):e.sol()||(e.backUp(1),n.exec(e.next()+t[0]))?(e.match(n),"searching"):(e.next(),null);for(;!e.eol()&&(e.next(),!e.match(n,!1)););}else e.skipToEnd()},query:n},e.addOverlay(o),e.showMatchesOnScrollbar&&(r.getScrollbarAnnotate()&&r.getScrollbarAnnotate().clear(),r.setScrollbarAnnotate(e.showMatchesOnScrollbar(t))),r.setOverlay(o))}function Me(r,o,s,a){return void 0===a&&(a=1),r.operation(function(){for(var e=r.getCursor(),t=r.getSearchCursor(s,e),n=0;n<a;n++){var i=t.find(o);if(0==n&&i&&X(t.from(),e)&&(i=t.find(o)),!i&&!(t=r.getSearchCursor(s,o?Xe(r.lastLine()):Xe(r.firstLine(),0))).find(o))return}return t.from()})}function Oe(e){var t=ye(e);e.removeOverlay(ye(e).getOverlay()),t.setOverlay(null),t.getScrollbarAnnotate()&&(t.getScrollbarAnnotate().clear(),t.setScrollbarAnnotate(null))}function Ee(e){var t=e.getScrollInfo(),n=e.coordsChar({left:0,top:6+t.top},"local"),t=t.clientHeight-10+t.top,t=e.coordsChar({left:0,top:t},"local");return{top:n.line,bottom:t.line}}function Ne(e,t,n){if("'"==n){var i=e.doc.history.done,i=i[i.length-2];return i&&i.ranges&&i.ranges[0].head}if("."==n){if(0==e.doc.history.lastModTime)return;e=e.doc.history.done.filter(function(e){if(void 0!==e.changes)return e});return e.reverse(),e[0].changes[0].to}n=t.marks[n];return n&&n.find()}u=function(){this.buildCommandMap_()};u.prototype={processCommand:function(e,t,n){var i=this;e.operation(function(){e.curOp.isVimOp=!0,i._processCommand(e,t,n)})},_processCommand:function(t,e,n){var i=t.state.vim,r=j.registerController.getRegister(":"),o=r.toString();i.visualMode&&ae(t);var s=new Ve.StringStream(e);r.setText(e);var a,l,c=n||{};c.input=e;try{this.parseInput_(t,s,c)}catch(e){throw Se(t,e),e}if(c.commandName){if(a=this.matchCommand_(c.commandName)){if(l=a.name,a.excludeFromCommandHistory&&r.setText(o),this.parseCommandArgs_(s,c,a),"exToKey"==a.type){for(var d=0;d<a.toKeys.length;d++)Ve.Vim.handleKey(t,a.toKeys[d],"mapping");return}if("exToEx"==a.type)return void this.processCommand(t,a.toInput)}}else void 0!==c.line&&(l="move");if(l)try{Pe[l](t,c),a&&a.possiblyAsync||!c.callback||c.callback()}catch(e){throw Se(t,e),e}else Se(t,'Not an editor command ":'+e+'"')},parseInput_:function(e,t,n){t.eatWhile(":"),t.eat("%")?(n.line=e.firstLine(),n.lineEnd=e.lastLine()):(n.line=this.parseLineSpec_(e,t),void 0!==n.line&&t.eat(",")&&(n.lineEnd=this.parseLineSpec_(e,t)));e=t.match(/^(\w+)/);return n.commandName=e?e[1]:t.match(/.*/)[0],n},parseLineSpec_:function(e,t){var n=t.match(/^(\d+)/);if(n)return parseInt(n[1],10)-1;switch(t.next()){case".":return this.parseLineSpecOffset_(t,e.getCursor().line);case"$":return this.parseLineSpecOffset_(t,e.lastLine());case"'":var i=t.next(),i=Ne(e,e.state.vim,i);if(!i)throw new Error("Mark not set");return this.parseLineSpecOffset_(t,i.line);case"-":case"+":return t.backUp(1),this.parseLineSpecOffset_(t,e.getCursor().line);default:return void t.backUp(1)}},parseLineSpecOffset_:function(e,t){var n=e.match(/^([+-])?(\d+)/);return n&&(e=parseInt(n[2],10),"-"==n[1]?t-=e:t+=e),t},parseCommandArgs_:function(e,t,n){e.eol()||(t.argString=e.match(/.*/)[0],n=n.argDelimiter||/\s+/,(n=te(t.argString).split(n)).length&&n[0]&&(t.args=n))},matchCommand_:function(e){for(var t=e.length;0<t;t--){var n=e.substring(0,t);if(this.commandMap_[n]){n=this.commandMap_[n];if(0===n.name.indexOf(e))return n}}return null},buildCommandMap_:function(){this.commandMap_={};for(var e=0;e<$e.length;e++){var t=$e[e],n=t.shortName||t.name;this.commandMap_[n]=t}},map:function(e,t,n){if(":"!=e&&":"==e.charAt(0)){if(n)throw Error("Mode not supported for ex mappings");var i=e.substring(1);":"!=t&&":"==t.charAt(0)?this.commandMap_[i]={name:i,type:"exToEx",toInput:t.substring(1),user:!0}:this.commandMap_[i]={name:i,type:"exToKey",toKeys:t,user:!0}}else t=":"!=t&&":"==t.charAt(0)?{keys:e,type:"keyToEx",exArgs:{input:t.substring(1)}}:{keys:e,type:"keyToKey",toKeys:t},n&&(t.context=n),qe.unshift(t)},unmap:function(e,t){if(":"!=e&&":"==e.charAt(0)){if(t)throw Error("Mode not supported for ex mappings");var n=e.substring(1);if(this.commandMap_[n]&&this.commandMap_[n].user)return void delete this.commandMap_[n]}else for(var i=e,r=0;r<qe.length;r++)if(i==qe[r].keys&&qe[r].context===t)return void qe.splice(r,1);throw Error("No such mapping.")}};var Pe={colorscheme:function(e,t){!t.args||t.args.length<1?Se(e,e.getOption("theme")):e.setOption("theme",t.args[0])},map:function(e,t,n){var i=t.args;!i||i.length<2?e&&Se(e,"Invalid mapping: "+t.input):Fe.map(i[0],i[1],n)},imap:function(e,t){this.map(e,t,"insert")},nmap:function(e,t){this.map(e,t,"normal")},vmap:function(e,t){this.map(e,t,"visual")},unmap:function(e,t,n){var i=t.args;!i||i.length<1?e&&Se(e,"No such mapping: "+t.input):Fe.unmap(i[0],n)},move:function(e,t){H.processCommand(e,e.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:t.line+1})},set:function(e,t){var n=t.args,i=t.setCfg||{};if(!n||n.length<1)e&&Se(e,"Invalid mapping: "+t.input);else{var r=n[0].split("="),o=r[0],n=r[1],r=!1;if("?"==o.charAt(o.length-1)){if(n)throw Error("Trailing characters: "+t.argString);o=o.substring(0,o.length-1),r=!0}void 0===n&&"no"==o.substring(0,2)&&(o=o.substring(2),n=!1);t=k[o]&&"boolean"==k[o].type;t&&null==n&&(n=!0),!t&&void 0===n||r?(r=T(o,e,i))instanceof Error?Se(e,r.message):Se(e,!0===r||!1===r?" "+(r?"":"no")+o:"  "+o+"="+r):(i=w(o,n,e,i))instanceof Error&&Se(e,i.message)}},setlocal:function(e,t){t.setCfg={scope:"local"},this.set(e,t)},setglobal:function(e,t){t.setCfg={scope:"global"},this.set(e,t)},registers:function(e,t){var n=t.args,i=j.registerController.registers,r="----------Registers----------<br><br>";if(n)for(var n=n.join(""),o=0;o<n.length;o++)s=n.charAt(o),j.registerController.isValidRegister(s)&&(r+='"'+s+"    "+(i[s]||new D).toString()+"<br>");else for(var s in i){var a=i[s].toString();a.length&&(r+='"'+s+"    "+a+"<br>")}Se(e,r)},sort:function(e,r){var o,s,a,l,c;var t=function(){if(r.argString){var e=new Ve.StringStream(r.argString);if(e.eat("!")&&(o=!0),!e.eol()){if(!e.eatSpace())return"Invalid arguments";var t=e.match(/([dinuox]+)?\s*(\/.+\/)?\s*/);if(!t&&!e.eol())return"Invalid arguments";if(t[1]){s=-1!=t[1].indexOf("i"),a=-1!=t[1].indexOf("u");var n=-1!=t[1].indexOf("d")||-1!=t[1].indexOf("n")&&1,i=-1!=t[1].indexOf("x")&&1,e=-1!=t[1].indexOf("o")&&1;if(1<n+i+e)return"Invalid arguments";l=(n?"decimal":i&&"hex")||e&&"octal"}t[2]&&(c=new RegExp(t[2].substr(1,t[2].length-2),s?"i":""))}}}();if(t)Se(e,t+": "+r.argString);else{var n=r.line||e.firstLine(),t=r.lineEnd||r.line||e.lastLine();if(n!=t){var n=Xe(n,0),t=Xe(t,ee(e,t)),i=e.getRange(n,t).split("\n"),d=c||("decimal"==l?/(-?)([\d]+)/:"hex"==l?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==l?/([0-7]+)/:null),h="decimal"==l?10:"hex"==l?16:"octal"==l?8:null,u=[],f=[];if(l||c)for(var p=0;p<i.length;p++){var g=c?i[p].match(c):null;g&&""!=g[0]?u.push(g):(!c&&d.exec(i[p])?u:f).push(i[p])}else f=i;if(u.sort(c?function(e,t){var n;return o&&(n=e,e=t,t=n),s&&(e[0]=e[0].toLowerCase(),t[0]=t[0].toLowerCase()),e[0]<t[0]?-1:1}:y),c)for(p=0;p<u.length;p++)u[p]=u[p].input;else l||f.sort(y);if(i=o?u.concat(f):f.concat(u),a)for(var m,v=i,i=[],p=0;p<v.length;p++)v[p]!=m&&i.push(v[p]),m=v[p];e.replaceRange(i.join("\n"),n,t)}}function y(e,t){o&&(i=e,e=t,t=i),s&&(e=e.toLowerCase(),t=t.toLowerCase());var n=l&&d.exec(e),i=l&&d.exec(t);return n?parseInt((n[1]+n[2]).toLowerCase(),h)-(i=parseInt((i[1]+i[2]).toLowerCase(),h)):e<t?-1:1}},global:function(t,e){var n=e.argString;if(n){var i,r=void 0!==e.line?e.line:t.firstLine(),o=e.lineEnd||e.line||t.lastLine(),e=_e(n,"/"),s=n;if(e.length&&(s=e[0],i=e.slice(1,e.length).join("/")),s)try{je(t,s,!0,!0)}catch(e){return void Se(t,"Invalid regex: "+s)}for(var a,l,c=ye(t).getQuery(),d=[],h="",u=r;u<=o;u++)c.test(t.getLine(u))&&(d.push(u+1),h+=t.getLine(u)+"<br>");i?(a=0,(l=function(){var e;a<d.length&&(e=d[a]+i,Fe.processCommand(t,e,{callback:l})),a++})()):Se(t,h)}else Se(t,"Regular Expression missing from global")},substitute:function(t,e){if(!t.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var n,i,r,o,s=e.argString,a=s?_e(s,s[0]):[],l="",c=!1,d=!1;if(a.length)n=a[0],l=a[1],n&&"$"===n[n.length-1]&&(n=n.slice(0,n.length-1)+"\\n",l=l?l+"\n":"\n"),void 0!==l&&(l=(T("pcre")?function(e){for(var t=new Ve.StringStream(e),n=[];!t.eol();){for(;t.peek()&&"\\"!=t.peek();)n.push(t.next());var i,r=!1;for(i in Ce)if(t.match(i,!0)){r=!0,n.push(Ce[i]);break}r||n.push(t.next())}return n.join("")}:ke)(l),j.lastSubstituteReplacePart=l),i=a[2]?a[2].split(" "):[];else if(s&&s.length)return void Se(t,"Substitutions should be of the form :s/pattern/replace/");if(i&&(r=i[0],o=parseInt(i[1]),r&&(-1!=r.indexOf("c")&&(c=!0,r.replace("c","")),-1!=r.indexOf("g")&&(d=!0,r.replace("g","")),n=n.replace(/\//g,"\\/")+"/"+r)),n)try{je(t,n,!0,!0)}catch(e){return void Se(t,"Invalid regex: "+n)}void 0!==(l=l||j.lastSubstituteReplacePart)?(s=ye(t).getQuery(),i=(void 0!==e.line?e:t.getCursor()).line,r=e.lineEnd||i,i==t.firstLine()&&r==t.lastLine()&&(r=1/0),o&&(r=(i=r)+o-1),o=z(t,Xe(i,0)),o=t.getSearchCursor(s,o),function(r,e,i,o,s,a,t,n,l){r.state.vim.exMode=!0;var c=!1,d=a.from();function h(){r.operation(function(){for(;!c;)u(),f();p()})}function u(){var e=r.getRange(a.from(),a.to()).replace(t,n);a.replace(e)}function f(){for(;a.findNext()&&(e=a.from(),t=o,n=s,"number"!=typeof e&&(e=e.line),t instanceof Array?b(e,t):n?t<=e&&e<=n:e==t);)if(i||!d||a.from().line!=d.line)return r.scrollIntoView(a.from(),30),r.setSelection(a.from(),a.to()),d=a.from(),void(c=!1);var e,t,n;c=!0}function p(e){e&&e(),r.focus(),d&&(r.setCursor(d),(e=r.state.vim).exMode=!1,e.lastHPos=e.lastHSPos=d.ch),l&&l()}if(f(),c)return Se(r,"No matches for "+t.source);if(!e)return h(),l&&l();Le(r,{prefix:"replace with <strong>"+n+"</strong> (y/n/a/q/l)",onKeyDown:function(e,t,n){switch(Ve.e_stop(e),Ve.keyName(e)){case"Y":u(),f();break;case"N":f();break;case"A":var i=l;l=void 0,r.operation(h),l=i;break;case"L":u();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":p(n)}return c&&p(n),!0}})}(t,c,d,i,r,o,s,l,e.callback)):Se(t,"No previous substitute regular expression")},redo:Ve.commands.redo,undo:Ve.commands.undo,write:function(e){Ve.commands.save?Ve.commands.save(e):e.save&&e.save()},nohlsearch:function(e){Oe(e)},yank:function(e){var t=$(e.getCursor()).line,t=e.getLine(t);j.registerController.pushText("0","yank",t,!0,!0)},delmarks:function(e,t){if(t.argString&&te(t.argString))for(var n=e.state.vim,i=new Ve.StringStream(te(t.argString));!i.eol();){i.eatSpace();var r=i.pos;if(!i.match(/[a-zA-Z]/,!1))return void Se(e,"Invalid argument: "+t.argString.substring(r));var o=i.next();if(i.match("-",!0)){if(!i.match(/[a-zA-Z]/,!1))return void Se(e,"Invalid argument: "+t.argString.substring(r));var s=o,a=i.next();if(!(y(s)&&y(a)||_(s)&&_(a)))return void Se(e,"Invalid argument: "+s+"-");var l=s.charCodeAt(0),c=a.charCodeAt(0);if(c<=l)return void Se(e,"Invalid argument: "+t.argString.substring(r));for(var d=0;d<=c-l;d++){var h=String.fromCharCode(l+d);delete n.marks[h]}}else delete n.marks[o]}else Se(e,"Argument required")}},Fe=new u;function De(e){var t=e.state.vim,n=j.macroModeState,i=j.registerController.getRegister("."),r=n.isPlaying,o=n.lastInsertModeChanges;r||(e.off("change",Re),Ve.off(e.getInputField(),"keydown",Ke)),!r&&1<t.insertModeRepeat&&(Ue(e,t,t.insertModeRepeat-1,!0),t.lastEditInputState.repeatOverride=t.insertModeRepeat),delete t.insertModeRepeat,t.insertMode=!1,e.setCursor(e.getCursor().line,e.getCursor().ch-1),e.setOption("keyMap","vim"),e.setOption("disableInput",!0),e.toggleOverwrite(!1),i.setText(o.changes.join("")),Ve.signal(e,"vim-mode-change",{mode:"normal"}),n.isRecording&&function(e){if(e.isPlaying)return;var t=e.latestRegister,t=j.registerController.getRegister(t);t&&t.pushInsertModeChanges&&t.pushInsertModeChanges(e.lastInsertModeChanges)}(n)}function Ie(e){qe.unshift(e)}function Re(e,t){var n,i=j.macroModeState,r=i.lastInsertModeChanges;if(!i.isPlaying)for(;t;)r.expectCursorActivityForChange=!0,1<r.ignoreCount?r.ignoreCount--:"+input"!=t.origin&&"paste"!=t.origin&&void 0!==t.origin||(1<(n=e.listSelections().length)&&(r.ignoreCount=n),n=t.text.join("\n"),r.maybeReset&&(r.changes=[],r.maybeReset=!1),n&&(e.state.overwrite&&!/\n/.test(n)?r.changes.push([n]):r.changes.push(n))),t=t.next}function He(e){var t=e.state.vim;if(t.insertMode){var n=j.macroModeState;if(n.isPlaying)return;n=n.lastInsertModeChanges;n.expectCursorActivityForChange?n.expectCursorActivityForChange=!1:n.maybeReset=!0}else e.curOp.isVimOp||function(e,t){var n=e.getCursor("anchor"),i=e.getCursor("head");t.visualMode&&!e.somethingSelected()?ae(e,!1):t.visualMode||t.insertMode||!e.somethingSelected()||(t.visualMode=!0,t.visualLine=!1,Ve.signal(e,"vim-mode-change",{mode:"visual"}));{var r,o;t.visualMode?(r=J(i,n)?0:-1,o=J(i,n)?-1:0,i=q(i,0,r),n=q(n,0,o),t.sel={anchor:n,head:i},ge(e,t,"<",Y(i,n)),ge(e,t,">",Q(i,n))):t.insertMode||(t.lastHPos=e.getCursor().ch)}}(e,t);t.visualMode&&Be(e)}function Be(e){var t=e.state.vim,n=z(e,$(t.sel.head)),i=q(n,0,1);t.fakeCursor&&t.fakeCursor.clear(),t.fakeCursor=e.markText(n,i,{className:"cm-animate-fat-cursor"})}function We(e){this.keyName=e}function Ke(e){var t=j.macroModeState.lastInsertModeChanges,n=Ve.keyName(e);n&&(-1==n.indexOf("Delete")&&-1==n.indexOf("Backspace")||Ve.lookupKey(n,"vim-insert",function(){return t.maybeReset&&(t.changes=[],t.maybeReset=!1),t.changes.push(new We(n)),!0}))}function Ue(n,i,e,t){var r=j.macroModeState;r.isPlaying=!0;var o=!!i.lastEditActionCommand,s=i.inputState;function a(){o?H.processAction(n,i,i.lastEditActionCommand):H.evalInput(n,i)}function l(e){var t;0<r.lastInsertModeChanges.changes.length&&(e=i.lastEditActionCommand?e:1,t=r.lastInsertModeChanges,ze(n,t.changes,e))}if(i.inputState=i.lastEditInputState,o&&i.lastEditActionCommand.interlaceInsertRepeat)for(var c=0;c<e;c++)a(),l(1);else t||a(),l(e);i.inputState=s,i.insertMode&&!t&&De(n),r.isPlaying=!1}function ze(t,e,n){function i(e){return"string"==typeof e?Ve.commands[e](t):e(t),!0}var r,o,s=t.getCursor("head"),a=j.macroModeState.lastInsertModeChanges.inVisualBlock;a&&(o=t.state.vim.lastSelection,r=o.anchor,r={line:(o=o.head).line-r.line,ch:o.line-r.line},ie(t,s,r.line+1),n=t.listSelections().length,t.setCursor(s));for(var l=0;l<n;l++){a&&t.setCursor(q(s,l,0));for(var c=0;c<e.length;c++){var d,h,u=e[c];u instanceof We?Ve.lookupKey(u.keyName,"vim-insert",i):"string"==typeof u?(h=t.getCursor(),t.replaceRange(u,h,h)):(h=q(d=t.getCursor(),0,u[0].length),t.replaceRange(u[0],d,h))}}a&&t.setCursor(q(s,0,1))}return Ve.keyMap.vim={attach:i,detach:e,call:t},C("insertModeEscKeysTimeout",200,"number"),Ve.keyMap["vim-insert"]={fallthrough:["default"],attach:i,detach:e,call:t},Ve.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"],attach:i,detach:e,call:t},N(),h}()}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/edit/matchbrackets")):"function"==typeof define&&define.amd?define(["../lib/codemirror","../addon/search/searchcursor","../addon/edit/matchbrackets"],e):e(CodeMirror)}(function(d){"use strict";var e=d.commands,h=d.Pos;function t(t,n){t.extendSelectionsBy(function(e){return t.display.shift||t.doc.extend||e.empty()?function(e,t,n){if(n<0&&0==t.ch)return e.clipPos(h(t.line-1));var i=e.getLine(t.line);if(0<n&&t.ch>=i.length)return e.clipPos(h(t.line+1,0));for(var r,o="start",s=t.ch,a=n<0?0:i.length;s!=a;s+=n,0){var l=i.charAt(n<0?s-1:s),c="_"!=l&&d.isWordChar(l)?"w":"o";if("w"==c&&l.toUpperCase()==l&&(c="W"),"start"==o)"o"!=c&&(o="in",r=c);else if("in"==o&&r!=c){if("w"==r&&"W"==c&&n<0&&s--,!("W"==r&&"w"==c&&0<n))break;r="w"}}return h(t.line,s)}(t.doc,e.head,n):n<0?e.from():e.to()})}function n(s,a){if(s.isReadOnly())return d.Pass;s.operation(function(){for(var e=s.listSelections().length,t=[],n=-1,i=0;i<e;i++){var r,o=s.listSelections()[i].head;o.line<=n||(r=h(o.line+(a?0:1),0),s.replaceRange("\n",r,null,"+insertLine"),s.indentLine(r.line,null,!0),t.push({head:r,anchor:r}),n=o.line+1)}s.setSelections(t)}),s.execCommand("indentAuto")}function c(e,t){for(var n=t.ch,i=n,r=e.getLine(t.line);n&&d.isWordChar(r.charAt(n-1));)--n;for(;i<r.length&&d.isWordChar(r.charAt(i));)++i;return{from:h(t.line,n),to:h(t.line,i),word:r.slice(n,i)}}function i(e,t){for(var n=e.listSelections(),i=[],r=0;r<n.length;r++){var o=n[r],s=e.findPosV(o.anchor,t,"line",o.anchor.goalColumn),a=e.findPosV(o.head,t,"line",o.head.goalColumn);s.goalColumn=null!=o.anchor.goalColumn?o.anchor.goalColumn:e.cursorCoords(o.anchor,"div").left,a.goalColumn=null!=o.head.goalColumn?o.head.goalColumn:e.cursorCoords(o.head,"div").left;a={anchor:s,head:a};i.push(o),i.push(a)}e.setSelections(i)}e.goSubwordLeft=function(e){t(e,-1)},e.goSubwordRight=function(e){t(e,1)},e.scrollLineUp=function(e){var t,n=e.getScrollInfo();e.somethingSelected()||(t=e.lineAtHeight(n.top+n.clientHeight,"local"),e.getCursor().line>=t&&e.execCommand("goLineUp")),e.scrollTo(null,n.top-e.defaultTextHeight())},e.scrollLineDown=function(e){var t,n=e.getScrollInfo();e.somethingSelected()||(t=e.lineAtHeight(n.top,"local")+1,e.getCursor().line<=t&&e.execCommand("goLineDown")),e.scrollTo(null,n.top+e.defaultTextHeight())},e.splitSelectionByLine=function(e){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++)for(var r=t[i].from(),o=t[i].to(),s=r.line;s<=o.line;++s)o.line>r.line&&s==o.line&&0==o.ch||n.push({anchor:s==r.line?r:h(s,0),head:s==o.line?o:h(s)});e.setSelections(n,0)},e.singleSelectionTop=function(e){var t=e.listSelections()[0];e.setSelection(t.anchor,t.head,{scroll:!1})},e.selectLine=function(e){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++){var r=t[i];n.push({anchor:h(r.from().line,0),head:h(r.to().line+1,0)})}e.setSelections(n)},e.insertLineAfter=function(e){return n(e,!1)},e.insertLineBefore=function(e){return n(e,!0)},e.selectNextOccurrence=function(e){var t=e.getCursor("from"),n=e.getCursor("to"),i=e.state.sublimeFindFullWord==e.doc.sel;if(0==d.cmpPos(t,n)){var r=c(e,t);if(!r.word)return;e.setSelection(r.from,r.to),i=!0}else{t=e.getRange(t,n),t=i?new RegExp("\\b"+t+"\\b"):t,n=e.getSearchCursor(t,n);if(!(n.findNext()||(n=e.getSearchCursor(t,h(e.firstLine(),0))).findNext())||function(e,t,n){for(var i=0;i<e.length;i++)if(e[i].from()==t&&e[i].to()==n)return!0;return!1}(e.listSelections(),n.from(),n.to()))return d.Pass;e.addSelection(n.from(),n.to())}i&&(e.state.sublimeFindFullWord=e.doc.sel)},e.addCursorToPrevLine=function(e){i(e,-1)},e.addCursorToNextLine=function(e){i(e,1)};function r(e){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++){var r=t[i],o=r.head,s=e.scanForBracket(o,-1);if(!s)return;for(;;){var a=e.scanForBracket(o,1);if(!a)return;if(a.ch=="(){}[]".charAt("(){}[]".indexOf(s.ch)+1)){var l=h(s.pos.line,s.pos.ch+1);if(0!=d.cmpPos(l,r.from())||0!=d.cmpPos(a.pos,r.to())){n.push({anchor:l,head:a.pos});break}if(!(s=e.scanForBracket(s.pos,-1)))return}o=h(a.pos.line,a.pos.ch+1)}}return e.setSelections(n),1}function o(s,a){if(s.isReadOnly())return d.Pass;for(var l,e=s.listSelections(),c=[],t=0;t<e.length;t++){var n=e[t];if(!n.empty()){for(var i=n.from().line,r=n.to().line;t<e.length-1&&e[t+1].from().line==r;)r=e[++t].to().line;e[t].to().ch||r--,c.push(i,r)}}c.length?l=!0:c.push(s.firstLine(),s.lastLine()),s.operation(function(){for(var e=[],t=0;t<c.length;t+=2){var n=c[t],i=c[t+1],r=h(n,0),o=h(i),n=s.getRange(r,o,!1);a?n.sort():n.sort(function(e,t){var n=e.toUpperCase(),i=t.toUpperCase();return n!=i&&(e=n,t=i),e<t?-1:e==t?0:1}),s.replaceRange(n,r,o),l&&e.push({anchor:r,head:h(i+1,0)})}l&&s.setSelections(e,0)})}function s(a,l){a.operation(function(){for(var e=a.listSelections(),t=[],n=[],i=0;i<e.length;i++)(s=e[i]).empty()?(t.push(i),n.push("")):n.push(l(a.getRange(s.from(),s.to())));a.replaceSelections(n,"around","case");for(i=t.length-1;0<=i;i--){var r,o,s=e[t[i]];o&&0<d.cmpPos(s.head,o)||(o=(r=c(a,s.head)).from,a.replaceRange(l(r.word),r.from,r.to))}})}function a(e){var t=e.getCursor("from"),n=e.getCursor("to");if(0==d.cmpPos(t,n)){var i=c(e,t);if(!i.word)return;t=i.from,n=i.to}return{from:t,to:n,query:e.getRange(t,n),word:i}}function l(e,t){var n,i,r=a(e);r&&(n=r.query,i=e.getSearchCursor(n,t?r.to:r.from),(t?i.findNext():i.findPrevious())?e.setSelection(i.from(),i.to()):(i=e.getSearchCursor(n,t?h(e.firstLine(),0):e.clipPos(h(e.lastLine()))),(t?i.findNext():i.findPrevious())?e.setSelection(i.from(),i.to()):r.word&&e.setSelection(r.from,r.to)))}e.selectScope=function(e){r(e)||e.execCommand("selectAll")},e.selectBetweenBrackets=function(e){if(!r(e))return d.Pass},e.goToBracket=function(n){n.extendSelectionsBy(function(e){var t=n.scanForBracket(e.head,1);if(t&&0!=d.cmpPos(t.pos,e.head))return t.pos;t=n.scanForBracket(e.head,-1);return t&&h(t.pos.line,t.pos.ch+1)||e.head})},e.swapLineUp=function(r){if(r.isReadOnly())return d.Pass;for(var e=r.listSelections(),o=[],t=r.firstLine()-1,s=[],n=0;n<e.length;n++){var i=e[n],a=i.from().line-1,l=i.to().line;s.push({anchor:h(i.anchor.line-1,i.anchor.ch),head:h(i.head.line-1,i.head.ch)}),0!=i.to().ch||i.empty()||--l,t<a?o.push(a,l):o.length&&(o[o.length-1]=l),t=l}r.operation(function(){for(var e=0;e<o.length;e+=2){var t=o[e],n=o[e+1],i=r.getLine(t);r.replaceRange("",h(t,0),h(t+1,0),"+swapLine"),n>r.lastLine()?r.replaceRange("\n"+i,h(r.lastLine()),null,"+swapLine"):r.replaceRange(i+"\n",h(n,0),null,"+swapLine")}r.setSelections(s),r.scrollIntoView()})},e.swapLineDown=function(r){if(r.isReadOnly())return d.Pass;for(var e=r.listSelections(),o=[],t=r.lastLine()+1,n=e.length-1;0<=n;n--){var i=e[n],s=i.to().line+1,a=i.from().line;0!=i.to().ch||i.empty()||s--,s<t?o.push(s,a):o.length&&(o[o.length-1]=a),t=a}r.operation(function(){for(var e=o.length-2;0<=e;e-=2){var t=o[e],n=o[e+1],i=r.getLine(t);t==r.lastLine()?r.replaceRange("",h(t-1),h(t),"+swapLine"):r.replaceRange("",h(t,0),h(t+1,0),"+swapLine"),r.replaceRange(i+"\n",h(n,0),null,"+swapLine")}r.scrollIntoView()})},e.toggleCommentIndented=function(e){e.toggleComment({indent:!0})},e.joinLines=function(l){for(var e=l.listSelections(),c=[],t=0;t<e.length;t++){for(var n=e[t],i=n.from(),r=i.line,o=n.to().line;t<e.length-1&&e[t+1].from().line==o;)o=e[++t].to().line;c.push({start:r,end:o,anchor:!n.empty()&&i})}l.operation(function(){for(var e=0,t=[],n=0;n<c.length;n++){for(var i,r=c[n],o=r.anchor&&h(r.anchor.line-e,r.anchor.ch),s=r.start;s<=r.end;s++){var a=s-e;s==r.end&&(i=h(a,l.getLine(a).length+1)),a<l.lastLine()&&(l.replaceRange(" ",h(a),h(1+a,/^\s*/.exec(l.getLine(1+a))[0].length)),++e)}t.push({anchor:o||i,head:i})}l.setSelections(t,0)})},e.duplicateLine=function(i){i.operation(function(){for(var e=i.listSelections().length,t=0;t<e;t++){var n=i.listSelections()[t];n.empty()?i.replaceRange(i.getLine(n.head.line)+"\n",h(n.head.line,0)):i.replaceRange(i.getRange(n.from(),n.to()),n.from())}i.scrollIntoView()})},e.sortLines=function(e){o(e,!0)},e.sortLinesInsensitive=function(e){o(e,!1)},e.nextBookmark=function(e){var t=e.state.sublimeBookmarks;if(t)for(;t.length;){var n=t.shift(),i=n.find();if(i)return t.push(n),e.setSelection(i.from,i.to)}},e.prevBookmark=function(e){var t=e.state.sublimeBookmarks;if(t)for(;t.length;){t.unshift(t.pop());var n=t[t.length-1].find();if(n)return e.setSelection(n.from,n.to);t.pop()}},e.toggleBookmark=function(e){for(var t=e.listSelections(),n=e.state.sublimeBookmarks||(e.state.sublimeBookmarks=[]),i=0;i<t.length;i++){for(var r=t[i].from(),o=t[i].to(),s=t[i].empty()?e.findMarksAt(r):e.findMarks(r,o),a=0;a<s.length;a++)if(s[a].sublimeBookmark){s[a].clear();for(var l=0;l<n.length;l++)n[l]==s[a]&&n.splice(l--,1);break}a==s.length&&n.push(e.markText(r,o,{sublimeBookmark:!0,clearWhenEmpty:!1}))}},e.clearBookmarks=function(e){var t=e.state.sublimeBookmarks;if(t)for(var n=0;n<t.length;n++)t[n].clear();t.length=0},e.selectBookmarks=function(e){var t=e.state.sublimeBookmarks,n=[];if(t)for(var i=0;i<t.length;i++){var r=t[i].find();r?n.push({anchor:r.from,head:r.to}):t.splice(i--,0)}n.length&&e.setSelections(n,0)},e.smartBackspace=function(a){if(a.somethingSelected())return d.Pass;a.operation(function(){for(var e=a.listSelections(),t=a.getOption("indentUnit"),n=e.length-1;0<=n;n--){var i=e[n].head,r=a.getRange({line:i.line,ch:0},i),o=d.countColumn(r,null,a.getOption("tabSize")),s=a.findPosH(i,-1,"char",!1);!r||/\S/.test(r)||o%t!=0||(o=new h(i.line,d.findColumn(r,o-t,t))).ch!=i.ch&&(s=o),a.replaceRange("",s,i,"+delete")}})},e.delLineRight=function(n){n.operation(function(){for(var e=n.listSelections(),t=e.length-1;0<=t;t--)n.replaceRange("",e[t].anchor,h(e[t].to().line),"+delete");n.scrollIntoView()})},e.upcaseAtCursor=function(e){s(e,function(e){return e.toUpperCase()})},e.downcaseAtCursor=function(e){s(e,function(e){return e.toLowerCase()})},e.setSublimeMark=function(e){e.state.sublimeMark&&e.state.sublimeMark.clear(),e.state.sublimeMark=e.setBookmark(e.getCursor())},e.selectToSublimeMark=function(e){var t=e.state.sublimeMark&&e.state.sublimeMark.find();t&&e.setSelection(e.getCursor(),t)},e.deleteToSublimeMark=function(e){var t,n,i=e.state.sublimeMark&&e.state.sublimeMark.find();i&&(n=e.getCursor(),t=i,0<d.cmpPos(n,t)&&(i=t,t=n,n=i),e.state.sublimeKilled=e.getRange(n,t),e.replaceRange("",n,t))},e.swapWithSublimeMark=function(e){var t=e.state.sublimeMark&&e.state.sublimeMark.find();t&&(e.state.sublimeMark.clear(),e.state.sublimeMark=e.setBookmark(e.getCursor()),e.setCursor(t))},e.sublimeYank=function(e){null!=e.state.sublimeKilled&&e.replaceSelection(e.state.sublimeKilled,null,"paste")},e.showInCenter=function(e){var t=e.cursorCoords(null,"local");e.scrollTo(null,(t.top+t.bottom)/2-e.getScrollInfo().clientHeight/2)},e.findUnder=function(e){l(e,!0)},e.findUnderPrevious=function(e){l(e,!1)},e.findAllUnder=function(e){var t=a(e);if(t){for(var n=e.getSearchCursor(t.query),i=[],r=-1;n.findNext();)i.push({anchor:n.from(),head:n.to()}),n.from().line<=t.from.line&&n.from().ch<=t.from.ch&&r++;e.setSelections(i,r)}};var u=d.keyMap;u.macSublime={"Cmd-Left":"goLineStartSmart","Shift-Tab":"indentLess","Shift-Ctrl-K":"deleteLine","Alt-Q":"wrapLines","Ctrl-Left":"goSubwordLeft","Ctrl-Right":"goSubwordRight","Ctrl-Alt-Up":"scrollLineUp","Ctrl-Alt-Down":"scrollLineDown","Cmd-L":"selectLine","Shift-Cmd-L":"splitSelectionByLine",Esc:"singleSelectionTop","Cmd-Enter":"insertLineAfter","Shift-Cmd-Enter":"insertLineBefore","Cmd-D":"selectNextOccurrence","Shift-Cmd-Space":"selectScope","Shift-Cmd-M":"selectBetweenBrackets","Cmd-M":"goToBracket","Cmd-Ctrl-Up":"swapLineUp","Cmd-Ctrl-Down":"swapLineDown","Cmd-/":"toggleCommentIndented","Cmd-J":"joinLines","Shift-Cmd-D":"duplicateLine",F5:"sortLines","Cmd-F5":"sortLinesInsensitive",F2:"nextBookmark","Shift-F2":"prevBookmark","Cmd-F2":"toggleBookmark","Shift-Cmd-F2":"clearBookmarks","Alt-F2":"selectBookmarks",Backspace:"smartBackspace","Cmd-K Cmd-K":"delLineRight","Cmd-K Cmd-U":"upcaseAtCursor","Cmd-K Cmd-L":"downcaseAtCursor","Cmd-K Cmd-Space":"setSublimeMark","Cmd-K Cmd-A":"selectToSublimeMark","Cmd-K Cmd-W":"deleteToSublimeMark","Cmd-K Cmd-X":"swapWithSublimeMark","Cmd-K Cmd-Y":"sublimeYank","Cmd-K Cmd-C":"showInCenter","Cmd-K Cmd-G":"clearBookmarks","Cmd-K Cmd-Backspace":"delLineLeft","Cmd-K Cmd-0":"unfoldAll","Cmd-K Cmd-J":"unfoldAll","Ctrl-Shift-Up":"addCursorToPrevLine","Ctrl-Shift-Down":"addCursorToNextLine","Cmd-F3":"findUnder","Shift-Cmd-F3":"findUnderPrevious","Alt-F3":"findAllUnder","Shift-Cmd-[":"fold","Shift-Cmd-]":"unfold","Cmd-I":"findIncremental","Shift-Cmd-I":"findIncrementalReverse","Cmd-H":"replace",F3:"findNext","Shift-F3":"findPrev",fallthrough:"macDefault"},d.normalizeKeyMap(u.macSublime),u.pcSublime={"Shift-Tab":"indentLess","Shift-Ctrl-K":"deleteLine","Alt-Q":"wrapLines","Ctrl-T":"transposeChars","Alt-Left":"goSubwordLeft","Alt-Right":"goSubwordRight","Ctrl-Up":"scrollLineUp","Ctrl-Down":"scrollLineDown","Ctrl-L":"selectLine","Shift-Ctrl-L":"splitSelectionByLine",Esc:"singleSelectionTop","Ctrl-Enter":"insertLineAfter","Shift-Ctrl-Enter":"insertLineBefore","Ctrl-D":"selectNextOccurrence","Shift-Ctrl-Space":"selectScope","Shift-Ctrl-M":"selectBetweenBrackets","Ctrl-M":"goToBracket","Shift-Ctrl-Up":"swapLineUp","Shift-Ctrl-Down":"swapLineDown","Ctrl-/":"toggleCommentIndented","Ctrl-J":"joinLines","Shift-Ctrl-D":"duplicateLine",F9:"sortLines","Ctrl-F9":"sortLinesInsensitive",F2:"nextBookmark","Shift-F2":"prevBookmark","Ctrl-F2":"toggleBookmark","Shift-Ctrl-F2":"clearBookmarks","Alt-F2":"selectBookmarks",Backspace:"smartBackspace","Ctrl-K Ctrl-K":"delLineRight","Ctrl-K Ctrl-U":"upcaseAtCursor","Ctrl-K Ctrl-L":"downcaseAtCursor","Ctrl-K Ctrl-Space":"setSublimeMark","Ctrl-K Ctrl-A":"selectToSublimeMark","Ctrl-K Ctrl-W":"deleteToSublimeMark","Ctrl-K Ctrl-X":"swapWithSublimeMark","Ctrl-K Ctrl-Y":"sublimeYank","Ctrl-K Ctrl-C":"showInCenter","Ctrl-K Ctrl-G":"clearBookmarks","Ctrl-K Ctrl-Backspace":"delLineLeft","Ctrl-K Ctrl-0":"unfoldAll","Ctrl-K Ctrl-J":"unfoldAll","Ctrl-Alt-Up":"addCursorToPrevLine","Ctrl-Alt-Down":"addCursorToNextLine","Ctrl-F3":"findUnder","Shift-Ctrl-F3":"findUnderPrevious","Alt-F3":"findAllUnder","Shift-Ctrl-[":"fold","Shift-Ctrl-]":"unfold","Ctrl-I":"findIncremental","Shift-Ctrl-I":"findIncrementalReverse","Ctrl-H":"replace",F3:"findNext","Shift-F3":"findPrev",fallthrough:"pcDefault"},d.normalizeKeyMap(u.pcSublime);e=u.default==u.macDefault;u.sublime=e?u.macSublime:u.pcSublime}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../lib/codemirror")):"function"==typeof define&&define.amd?define(["../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";var l=e.Pos;function a(e,t){return e.line==t.line&&e.ch==t.ch}var o=[];function s(e){o.push(e),50<o.length&&o.shift()}function n(e){return o[o.length-(e?Math.min(e,1):1)]||""}var c=null;function d(e,t,n,i,r){null==r&&(r=e.getRange(t,n)),"grow"==i&&c&&c.cm==e&&a(t,c.pos)&&e.isClean(c.gen)?function(e){if(!o.length)return s(e);o[o.length-1]+=e}(r):!1!==i&&s(r),e.replaceRange("",t,n,"+delete"),c="grow"==i?{cm:e,pos:t,gen:e.changeGeneration()}:null}function t(e,t,n){return e.findPosH(t,n,"char",!0)}function i(e,t,n){return e.findPosH(t,n,"word",!0)}function r(e,t,n){return e.findPosV(t,n,"line",e.doc.sel.goalColumn)}function h(e,t,n){return e.findPosV(t,n,"page",e.doc.sel.goalColumn)}function u(e,t,n){for(var i=t.line,r=e.getLine(i),o=/\S/.test(n<0?r.slice(0,t.ch):r.slice(t.ch)),s=e.firstLine(),a=e.lastLine();;){if((i+=n)<s||a<i)return e.clipPos(l(i-n,n<0?0:null));r=e.getLine(i);if(/\S/.test(r))o=!0;else if(o)return l(i,0)}}function f(e,t,n){for(var i=t.line,r=t.ch,o=e.getLine(t.line),s=!1;;){var a=o.charAt(r+(n<0?-1:0));if(a){if(s&&/[!?.]/.test(a))return l(i,r+(0<n?1:0));s=s||/\w/.test(a),r+=n}else{if(i==(n<0?e.firstLine():e.lastLine()))return l(i,r);if(o=e.getLine(i+n),!/\S/.test(o))return l(i,r);i+=n,r=n<0?o.length:0}}}function p(e,t,n){var i;if(e.findMatchingBracket&&(i=e.findMatchingBracket(t,{strict:!0}))&&i.match&&(i.forward?1:-1)==n)return 0<n?l(i.to.line,i.to.ch+1):i.to;for(var r=!0;;r=!1){var o=e.getTokenAt(t),s=l(t.line,n<0?o.start:o.end);if(!(r&&0<n&&o.end==t.ch)&&/\w/.test(o.string))return s;o=e.findPosH(s,n,"char");if(a(s,o))return t;t=o}}function g(e,t){var n=e.state.emacsPrefix;return n?(w(e),"-"==n?-1:Number(n)):t?null:1}function m(t){var i="string"==typeof t?function(e){e.execCommand(t)}:t;return function(e){var t=g(e);i(e);for(var n=1;n<t;++n)i(e)}}function v(e,t,n,i){var r=g(e);r<0&&(i=-i,r=-r);for(var o=0;o<r;++o){var s=n(e,t,i);if(a(s,t))break;t=s}return t}function y(t,n){function e(e){e.extendSelection(v(e,e.getCursor(),t,n))}return e.motion=!0,e}function _(e,t,n,i){for(var r,o=e.listSelections(),s=o.length;s--;)d(e,r=o[s].head,v(e,r,t,n),i)}function x(e,t){if(e.somethingSelected()){for(var n,i=e.listSelections(),r=i.length;r--;)d(e,(n=i[r]).anchor,n.head,t);return!0}}function b(e,t){e.state.emacsPrefix?"-"!=t&&(e.state.emacsPrefix+=t):(e.state.emacsPrefix=t,e.on("keyHandled",C),e.on("inputRead",S))}var k={"Alt-G":!0,"Ctrl-X":!0,"Ctrl-Q":!0,"Ctrl-U":!0};function C(e,t){e.state.emacsPrefixMap||k.hasOwnProperty(t)||w(e)}function w(e){e.state.emacsPrefix=null,e.off("keyHandled",C),e.off("inputRead",S)}function S(e,t){var n=g(e);if(1<n&&"+input"==t.origin){for(var i=t.text.join("\n"),r="",o=1;o<n;++o)r+=i;e.replaceSelection(r)}}function T(e,t){"string"==typeof t&&(/^\d$/.test(t)||"Ctrl-U"==t)||(e.removeKeyMap(O),e.state.emacsPrefixMap=!1,e.off("keyHandled",T),e.off("inputRead",T))}function L(e){e.setCursor(e.getCursor()),e.setExtending(!e.getExtending()),e.on("change",function(){e.setExtending(!1)})}function j(e){e.setExtending(!1),e.setCursor(e.getCursor())}function A(e,t){var n=e.getCursor(),i=e.findPosH(n,1,"word");e.replaceRange(t(e.getRange(n,i)),n,i),e.setCursor(i)}e.emacs={kill:d,killRegion:x,repeated:m};var M=e.keyMap.emacs=e.normalizeKeyMap({"Ctrl-W":function(e){d(e,e.getCursor("start"),e.getCursor("end"),!0)},"Ctrl-K":m(function(e){var t=e.getCursor(),n=e.clipPos(l(t.line)),i=e.getRange(t,n);/\S/.test(i)||(i+="\n",n=l(t.line+1,0)),d(e,t,n,"grow",i)}),"Alt-W":function(e){s(e.getSelection()),j(e)},"Ctrl-Y":function(e){var t=e.getCursor();e.replaceRange(n(g(e)),t,t,"paste"),e.setSelection(t,e.getCursor())},"Alt-Y":function(e){e.replaceSelection((1<o.length&&o.pop(),n()),"around","paste")},"Ctrl-Space":L,"Ctrl-Shift-2":L,"Ctrl-F":y(t,1),"Ctrl-B":y(t,-1),Right:y(t,1),Left:y(t,-1),"Ctrl-D":function(e){_(e,t,1,!1)},Delete:function(e){x(e,!1)||_(e,t,1,!1)},"Ctrl-H":function(e){_(e,t,-1,!1)},Backspace:function(e){x(e,!1)||_(e,t,-1,!1)},"Alt-F":y(i,1),"Alt-B":y(i,-1),"Alt-Right":y(i,1),"Alt-Left":y(i,-1),"Alt-D":function(e){_(e,i,1,"grow")},"Alt-Backspace":function(e){_(e,i,-1,"grow")},"Ctrl-N":y(r,1),"Ctrl-P":y(r,-1),Down:y(r,1),Up:y(r,-1),"Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd",End:"goLineEnd",Home:"goLineStart","Alt-V":y(h,-1),"Ctrl-V":y(h,1),PageUp:y(h,-1),PageDown:y(h,1),"Ctrl-Up":y(u,-1),"Ctrl-Down":y(u,1),"Alt-A":y(f,-1),"Alt-E":y(f,1),"Alt-K":function(e){_(e,f,1,"grow")},"Ctrl-Alt-K":function(e){_(e,p,1,"grow")},"Ctrl-Alt-Backspace":function(e){_(e,p,-1,"grow")},"Ctrl-Alt-F":y(p,1),"Ctrl-Alt-B":y(p,-1),"Shift-Ctrl-Alt-2":function(e){var t=e.getCursor();e.setSelection(v(e,t,p,1),t)},"Ctrl-Alt-T":function(e){var t=p(e,e.getCursor(),-1),n=p(e,t,1),i=p(e,n,1),r=p(e,i,-1);e.replaceRange(e.getRange(r,i)+e.getRange(n,r)+e.getRange(t,n),t,i)},"Ctrl-Alt-U":m(function(e){for(var t=e.getCursor(),n=t.line,i=t.ch,r=[];n>=e.firstLine();){for(var o=e.getLine(n),s=null==i?o.length:i;0<s;)if(")"==(i=o.charAt(--s)))r.push("(");else if("]"==i)r.push("[");else if("}"==i)r.push("{");else if(/[\(\{\[]/.test(i)&&(!r.length||r.pop()!=i))return e.extendSelection(l(n,s));--n,i=null}}),"Alt-Space":function(e){for(var t=e.getCursor(),n=t.ch,i=t.ch,r=e.getLine(t.line);n&&/\s/.test(r.charAt(n-1));)--n;for(;i<r.length&&/\s/.test(r.charAt(i));)++i;e.replaceRange(" ",l(t.line,n),l(t.line,i))},"Ctrl-O":m(function(e){e.replaceSelection("\n","start")}),"Ctrl-T":m(function(e){e.execCommand("transposeChars")}),"Alt-C":m(function(e){A(e,function(e){var t=e.search(/\w/);return-1==t?e:e.slice(0,t)+e.charAt(t).toUpperCase()+e.slice(t+1).toLowerCase()})}),"Alt-U":m(function(e){A(e,function(e){return e.toUpperCase()})}),"Alt-L":m(function(e){A(e,function(e){return e.toLowerCase()})}),"Alt-;":"toggleComment","Ctrl-/":m("undo"),"Shift-Ctrl--":m("undo"),"Ctrl-Z":m("undo"),"Cmd-Z":m("undo"),"Shift-Alt-,":"goDocStart","Shift-Alt-.":"goDocEnd","Ctrl-S":"findPersistentNext","Ctrl-R":"findPersistentPrev","Ctrl-G":function(e){e.execCommand("clearSearch"),j(e)},"Shift-Alt-5":"replace","Alt-/":"autocomplete",Enter:"newlineAndIndent","Ctrl-J":m(function(e){e.replaceSelection("\n","end")}),Tab:"indentAuto","Alt-G G":function(n){var e,t,i=g(n,!0);if(null!=i&&0<i)return n.setCursor(i-1);e="Goto line",t=function(e){var t;e&&!isNaN(t=Number(e))&&t==(0|t)&&0<t&&n.setCursor(t-1)},(i=n).openDialog?i.openDialog(e+': <input type="text" style="width: 10em"/>',t,{bottom:!0}):t(prompt(e,""))},"Ctrl-X Tab":function(e){e.indentSelection(g(e,!0)||e.getOption("indentUnit"))},"Ctrl-X Ctrl-X":function(e){e.setSelection(e.getCursor("head"),e.getCursor("anchor"))},"Ctrl-X Ctrl-S":"save","Ctrl-X Ctrl-W":"save","Ctrl-X S":"saveAll","Ctrl-X F":"open","Ctrl-X U":m("undo"),"Ctrl-X K":"close","Ctrl-X Delete":function(e){d(e,e.getCursor(),f(e,e.getCursor(),1),"grow")},"Ctrl-X H":"selectAll","Ctrl-Q Tab":m("insertTab"),"Ctrl-U":function(e){e.state.emacsPrefixMap=!0,e.addKeyMap(O),e.on("keyHandled",T),e.on("inputRead",T)}}),O={"Ctrl-G":w};function E(t){O[t]=function(e){b(e,t)},M["Ctrl-"+t]=function(e){b(e,t)},k["Ctrl-"+t]=!0}for(var N=0;N<10;++N)E(String(N));E("-")}),function(t){"object"==typeof exports&&"object"==typeof module?t(require("../../lib/codemirror"),"cjs"):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],function(e){t(e,"amd")}):t(CodeMirror,"plain")}(function(l,s){l.modeURL||(l.modeURL="../mode/%N/%N.js");var a={};function c(e,t){var n=l.modes[e].dependencies;if(!n)return t();for(var i=[],r=0;r<n.length;++r)l.modes.hasOwnProperty(n[r])||i.push(n[r]);if(!i.length)return t();for(var o,s,a=(o=t,t=i.length,s=t,function(){0==--s&&o()}),r=0;r<i.length;++r)l.requireMode(i[r],a)}l.requireMode=function(e,t){if("string"!=typeof e&&(e=e.name),l.modes.hasOwnProperty(e))return c(e,t);if(a.hasOwnProperty(e))return a[e].push(t);var n,i,r,o=l.modeURL.replace(/%N/g,e);"plain"==s?((n=document.createElement("script")).src=o,i=document.getElementsByTagName("script")[0],r=a[e]=[t],l.on(n,"load",function(){c(e,function(){for(var e=0;e<r.length;++e)r[e]()})}),i.parentNode.insertBefore(n,i)):"cjs"==s?(require(o),t()):"amd"==s&&requirejs([o],t)},l.autoLoadMode=function(e,t){l.modes.hasOwnProperty(t)||l.requireMode(t,function(){e.setOption("mode",e.getOption("mode"))})}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(m){"use strict";function v(e,t){if(!e.hasOwnProperty(t))throw new Error("Undefined state "+t+" in simple mode")}function y(e,t){if(!e)return/(?:)/;var n="";return e=e instanceof RegExp?(e.ignoreCase&&(n="i"),e.source):String(e),new RegExp((!1===t?"":"^")+"(?:"+e+")",n)}function _(e,t){(e.next||e.push)&&v(t,e.next||e.push),this.regex=y(e.regex),this.token=function(e){if(!e)return null;if(e.apply)return e;if("string"==typeof e)return e.replace(/\./g," ");for(var t=[],n=0;n<e.length;n++)t.push(e[n]&&e[n].replace(/\./g," "));return t}(e.token),this.data=e}m.defineSimpleMode=function(e,t){m.defineMode(e,function(e){return m.simpleMode(e,t)})},m.simpleMode=function(e,t){v(t,"start");var n,i={},r=t.meta||{},o=!1;for(n in t)if(n!=r&&t.hasOwnProperty(n))for(var s=i[n]=[],a=t[n],l=0;l<a.length;l++){var c=a[l];s.push(new _(c,t)),(c.indent||c.dedent)&&(o=!0)}var d,h,u,f,p={startState:function(){return{state:"start",pending:null,local:null,localState:null,indent:o?[]:null}},copyState:function(e){var t={state:e.state,pending:e.pending,local:e.local,localState:null,indent:e.indent&&e.indent.slice(0)};e.localState&&(t.localState=m.copyState(e.local.mode,e.localState)),e.stack&&(t.stack=e.stack.slice(0));for(var n=e.persistentStates;n;n=n.next)t.persistentStates={mode:n.mode,spec:n.spec,state:n.state==e.localState?t.localState:m.copyState(n.mode,n.state),next:t.persistentStates};return t},token:(f=e,function(e,t){if(t.pending){var n=t.pending.shift();return 0==t.pending.length&&(t.pending=null),e.pos+=n.text.length,n.token}if(t.local){if(t.local.end&&e.match(t.local.end)){var i=t.local.endToken||null;return t.local=t.localState=null,i}var r,i=t.local.mode.token(e,t.localState);return t.local.endScan&&(r=t.local.endScan.exec(e.current()))&&(e.pos=e.start+r.index),i}for(var o=u[t.state],s=0;s<o.length;s++){var a=o[s],l=(!a.data.sol||e.sol())&&e.match(a.regex);if(l){a.data.next?t.state=a.data.next:a.data.push?((t.stack||(t.stack=[])).push(t.state),t.state=a.data.push):a.data.pop&&t.stack&&t.stack.length&&(t.state=t.stack.pop()),a.data.mode&&function(e,t,n,i){var r;if(n.persistent)for(var o=t.persistentStates;o&&!r;o=o.next)(n.spec?function e(t,n){if(t===n)return!0;if(!t||"object"!=typeof t||!n||"object"!=typeof n)return!1;var i=0;for(var r in t)if(t.hasOwnProperty(r)){if(!n.hasOwnProperty(r)||!e(t[r],n[r]))return!1;i++}for(var r in n)n.hasOwnProperty(r)&&i--;return 0==i}(n.spec,o.spec):n.mode==o.mode)&&(r=o);var s=r?r.mode:n.mode||m.getMode(e,n.spec),e=r?r.state:m.startState(s);n.persistent&&!r&&(t.persistentStates={mode:s,spec:n.spec,state:e,next:t.persistentStates});t.localState=e,t.local={mode:s,end:n.end&&y(n.end),endScan:n.end&&!1!==n.forceEnd&&y(n.end,!1),endToken:i&&i.join?i[i.length-1]:i}}(f,t,a.data.mode,a.token),a.data.indent&&t.indent.push(e.indentation()+f.indentUnit),a.data.dedent&&t.indent.pop();var c=a.token;if(c&&c.apply&&(c=c(l)),2<l.length&&a.token&&"string"!=typeof a.token){t.pending=[];for(var d=2;d<l.length;d++)l[d]&&t.pending.push({text:l[d],token:a.token[d-1]});return e.backUp(l[0].length-(l[1]?l[1].length:0)),c[0]}return c&&c.join?c[0]:c}}return e.next(),null}),innerMode:function(e){return e.local&&{mode:e.local.mode,state:e.localState}},indent:(d=u=i,function(e,t,n){if(e.local&&e.local.mode.indent)return e.local.mode.indent(e.localState,t,n);if(null==e.indent||e.local||h.dontIndentStates&&-1<function(e,t){for(var n=0;n<t.length;n++)if(t[n]===e)return!0}(e.state,h.dontIndentStates))return m.Pass;var i=e.indent.length-1,r=d[e.state];e:for(;;){for(var o=0;o<r.length;o++){var s=r[o];if(s.data.dedent&&!1!==s.data.dedentIfLineStart){var a=s.regex.exec(t);if(a&&a[0]){i--,(s.next||s.push)&&(r=d[s.next||s.push]),t=t.slice(a[0].length);continue e}}}break}return i<0?0:e.indent[i]})};if(h=r)for(var g in r)r.hasOwnProperty(g)&&(p[g]=r[g]);return p}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../lib/codemirror")):"function"==typeof define&&define.amd?define(["../lib/codemirror"],e):e(CodeMirror)}(function(r){"use strict";r.modeInfo=[{name:"APL",mime:"text/apl",mode:"apl",ext:["dyalog","apl"]},{name:"PGP",mimes:["application/pgp","application/pgp-encrypted","application/pgp-keys","application/pgp-signature"],mode:"asciiarmor",ext:["asc","pgp","sig"]},{name:"ASN.1",mime:"text/x-ttcn-asn",mode:"asn.1",ext:["asn","asn1"]},{name:"Asterisk",mime:"text/x-asterisk",mode:"asterisk",file:/^extensions\.conf$/i},{name:"Brainfuck",mime:"text/x-brainfuck",mode:"brainfuck",ext:["b","bf"]},{name:"C",mime:"text/x-csrc",mode:"clike",ext:["c","h","ino"]},{name:"C++",mime:"text/x-c++src",mode:"clike",ext:["cpp","c++","cc","cxx","hpp","h++","hh","hxx"],alias:["cpp"]},{name:"Cobol",mime:"text/x-cobol",mode:"cobol",ext:["cob","cpy"]},{name:"C#",mime:"text/x-csharp",mode:"clike",ext:["cs"],alias:["csharp"]},{name:"Clojure",mime:"text/x-clojure",mode:"clojure",ext:["clj","cljc","cljx"]},{name:"ClojureScript",mime:"text/x-clojurescript",mode:"clojure",ext:["cljs"]},{name:"Closure Stylesheets (GSS)",mime:"text/x-gss",mode:"css",ext:["gss"]},{name:"CMake",mime:"text/x-cmake",mode:"cmake",ext:["cmake","cmake.in"],file:/^CMakeLists.txt$/},{name:"CoffeeScript",mimes:["application/vnd.coffeescript","text/coffeescript","text/x-coffeescript"],mode:"coffeescript",ext:["coffee"],alias:["coffee","coffee-script"]},{name:"Common Lisp",mime:"text/x-common-lisp",mode:"commonlisp",ext:["cl","lisp","el"],alias:["lisp"]},{name:"Cypher",mime:"application/x-cypher-query",mode:"cypher",ext:["cyp","cypher"]},{name:"Cython",mime:"text/x-cython",mode:"python",ext:["pyx","pxd","pxi"]},{name:"Crystal",mime:"text/x-crystal",mode:"crystal",ext:["cr"]},{name:"CSS",mime:"text/css",mode:"css",ext:["css"]},{name:"CQL",mime:"text/x-cassandra",mode:"sql",ext:["cql"]},{name:"D",mime:"text/x-d",mode:"d",ext:["d"]},{name:"Dart",mimes:["application/dart","text/x-dart"],mode:"dart",ext:["dart"]},{name:"diff",mime:"text/x-diff",mode:"diff",ext:["diff","patch"]},{name:"Django",mime:"text/x-django",mode:"django"},{name:"Dockerfile",mime:"text/x-dockerfile",mode:"dockerfile",file:/^Dockerfile$/},{name:"DTD",mime:"application/xml-dtd",mode:"dtd",ext:["dtd"]},{name:"Dylan",mime:"text/x-dylan",mode:"dylan",ext:["dylan","dyl","intr"]},{name:"EBNF",mime:"text/x-ebnf",mode:"ebnf"},{name:"ECL",mime:"text/x-ecl",mode:"ecl",ext:["ecl"]},{name:"edn",mime:"application/edn",mode:"clojure",ext:["edn"]},{name:"Eiffel",mime:"text/x-eiffel",mode:"eiffel",ext:["e"]},{name:"Elm",mime:"text/x-elm",mode:"elm",ext:["elm"]},{name:"Embedded Javascript",mime:"application/x-ejs",mode:"htmlembedded",ext:["ejs"]},{name:"Embedded Ruby",mime:"application/x-erb",mode:"htmlembedded",ext:["erb"]},{name:"Erlang",mime:"text/x-erlang",mode:"erlang",ext:["erl"]},{name:"Esper",mime:"text/x-esper",mode:"sql"},{name:"Factor",mime:"text/x-factor",mode:"factor",ext:["factor"]},{name:"FCL",mime:"text/x-fcl",mode:"fcl"},{name:"Forth",mime:"text/x-forth",mode:"forth",ext:["forth","fth","4th"]},{name:"Fortran",mime:"text/x-fortran",mode:"fortran",ext:["f","for","f77","f90","f95"]},{name:"F#",mime:"text/x-fsharp",mode:"mllike",ext:["fs"],alias:["fsharp"]},{name:"Gas",mime:"text/x-gas",mode:"gas",ext:["s"]},{name:"Gherkin",mime:"text/x-feature",mode:"gherkin",ext:["feature"]},{name:"GitHub Flavored Markdown",mime:"text/x-gfm",mode:"gfm",file:/^(readme|contributing|history).md$/i},{name:"Go",mime:"text/x-go",mode:"go",ext:["go"]},{name:"Groovy",mime:"text/x-groovy",mode:"groovy",ext:["groovy","gradle"],file:/^Jenkinsfile$/},{name:"HAML",mime:"text/x-haml",mode:"haml",ext:["haml"]},{name:"Haskell",mime:"text/x-haskell",mode:"haskell",ext:["hs"]},{name:"Haskell (Literate)",mime:"text/x-literate-haskell",mode:"haskell-literate",ext:["lhs"]},{name:"Haxe",mime:"text/x-haxe",mode:"haxe",ext:["hx"]},{name:"HXML",mime:"text/x-hxml",mode:"haxe",ext:["hxml"]},{name:"ASP.NET",mime:"application/x-aspx",mode:"htmlembedded",ext:["aspx"],alias:["asp","aspx"]},{name:"HTML",mime:"text/html",mode:"htmlmixed",ext:["html","htm","handlebars","hbs"],alias:["xhtml"]},{name:"HTTP",mime:"message/http",mode:"http"},{name:"IDL",mime:"text/x-idl",mode:"idl",ext:["pro"]},{name:"Pug",mime:"text/x-pug",mode:"pug",ext:["jade","pug"],alias:["jade"]},{name:"Java",mime:"text/x-java",mode:"clike",ext:["java"]},{name:"Java Server Pages",mime:"application/x-jsp",mode:"htmlembedded",ext:["jsp"],alias:["jsp"]},{name:"JavaScript",mimes:["text/javascript","text/ecmascript","application/javascript","application/x-javascript","application/ecmascript"],mode:"javascript",ext:["js"],alias:["ecmascript","js","node"]},{name:"JSON",mimes:["application/json","application/x-json"],mode:"javascript",ext:["json","map"],alias:["json5"]},{name:"JSON-LD",mime:"application/ld+json",mode:"javascript",ext:["jsonld"],alias:["jsonld"]},{name:"JSX",mime:"text/jsx",mode:"jsx",ext:["jsx"]},{name:"Jinja2",mime:"text/jinja2",mode:"jinja2",ext:["j2","jinja","jinja2"]},{name:"Julia",mime:"text/x-julia",mode:"julia",ext:["jl"]},{name:"Kotlin",mime:"text/x-kotlin",mode:"clike",ext:["kt"]},{name:"LESS",mime:"text/x-less",mode:"css",ext:["less"]},{name:"LiveScript",mime:"text/x-livescript",mode:"livescript",ext:["ls"],alias:["ls"]},{name:"Lua",mime:"text/x-lua",mode:"lua",ext:["lua"]},{name:"Markdown",mime:"text/x-markdown",mode:"markdown",ext:["markdown","md","mkd"]},{name:"mIRC",mime:"text/mirc",mode:"mirc"},{name:"MariaDB SQL",mime:"text/x-mariadb",mode:"sql"},{name:"Mathematica",mime:"text/x-mathematica",mode:"mathematica",ext:["m","nb"]},{name:"Modelica",mime:"text/x-modelica",mode:"modelica",ext:["mo"]},{name:"MUMPS",mime:"text/x-mumps",mode:"mumps",ext:["mps"]},{name:"MS SQL",mime:"text/x-mssql",mode:"sql"},{name:"mbox",mime:"application/mbox",mode:"mbox",ext:["mbox"]},{name:"MySQL",mime:"text/x-mysql",mode:"sql"},{name:"Nginx",mime:"text/x-nginx-conf",mode:"nginx",file:/nginx.*\.conf$/i},{name:"NSIS",mime:"text/x-nsis",mode:"nsis",ext:["nsh","nsi"]},{name:"NTriples",mimes:["application/n-triples","application/n-quads","text/n-triples"],mode:"ntriples",ext:["nt","nq"]},{name:"Objective-C",mime:"text/x-objectivec",mode:"clike",ext:["m","mm"],alias:["objective-c","objc"]},{name:"OCaml",mime:"text/x-ocaml",mode:"mllike",ext:["ml","mli","mll","mly"]},{name:"Octave",mime:"text/x-octave",mode:"octave",ext:["m"]},{name:"Oz",mime:"text/x-oz",mode:"oz",ext:["oz"]},{name:"Pascal",mime:"text/x-pascal",mode:"pascal",ext:["p","pas"]},{name:"PEG.js",mime:"null",mode:"pegjs",ext:["jsonld"]},{name:"Perl",mime:"text/x-perl",mode:"perl",ext:["pl","pm"]},{name:"PHP",mimes:["text/x-php","application/x-httpd-php","application/x-httpd-php-open"],mode:"php",ext:["php","php3","php4","php5","php7","phtml"]},{name:"Pig",mime:"text/x-pig",mode:"pig",ext:["pig"]},{name:"Plain Text",mime:"text/plain",mode:"null",ext:["txt","text","conf","def","list","log"]},{name:"PLSQL",mime:"text/x-plsql",mode:"sql",ext:["pls"]},{name:"PowerShell",mime:"application/x-powershell",mode:"powershell",ext:["ps1","psd1","psm1"]},{name:"Properties files",mime:"text/x-properties",mode:"properties",ext:["properties","ini","in"],alias:["ini","properties"]},{name:"ProtoBuf",mime:"text/x-protobuf",mode:"protobuf",ext:["proto"]},{name:"Python",mime:"text/x-python",mode:"python",ext:["BUILD","bzl","py","pyw"],file:/^(BUCK|BUILD)$/},{name:"Puppet",mime:"text/x-puppet",mode:"puppet",ext:["pp"]},{name:"Q",mime:"text/x-q",mode:"q",ext:["q"]},{name:"R",mime:"text/x-rsrc",mode:"r",ext:["r","R"],alias:["rscript"]},{name:"reStructuredText",mime:"text/x-rst",mode:"rst",ext:["rst"],alias:["rst"]},{name:"RPM Changes",mime:"text/x-rpm-changes",mode:"rpm"},{name:"RPM Spec",mime:"text/x-rpm-spec",mode:"rpm",ext:["spec"]},{name:"Ruby",mime:"text/x-ruby",mode:"ruby",ext:["rb"],alias:["jruby","macruby","rake","rb","rbx"]},{name:"Rust",mime:"text/x-rustsrc",mode:"rust",ext:["rs"]},{name:"SAS",mime:"text/x-sas",mode:"sas",ext:["sas"]},{name:"Sass",mime:"text/x-sass",mode:"sass",ext:["sass"]},{name:"Scala",mime:"text/x-scala",mode:"clike",ext:["scala"]},{name:"Scheme",mime:"text/x-scheme",mode:"scheme",ext:["scm","ss"]},{name:"SCSS",mime:"text/x-scss",mode:"css",ext:["scss"]},{name:"Shell",mimes:["text/x-sh","application/x-sh"],mode:"shell",ext:["sh","ksh","bash"],alias:["bash","sh","zsh"],file:/^PKGBUILD$/},{name:"Sieve",mime:"application/sieve",mode:"sieve",ext:["siv","sieve"]},{name:"Slim",mimes:["text/x-slim","application/x-slim"],mode:"slim",ext:["slim"]},{name:"Smalltalk",mime:"text/x-stsrc",mode:"smalltalk",ext:["st"]},{name:"Smarty",mime:"text/x-smarty",mode:"smarty",ext:["tpl"]},{name:"Solr",mime:"text/x-solr",mode:"solr"},{name:"SML",mime:"text/x-sml",mode:"mllike",ext:["sml","sig","fun","smackspec"]},{name:"Soy",mime:"text/x-soy",mode:"soy",ext:["soy"],alias:["closure template"]},{name:"SPARQL",mime:"application/sparql-query",mode:"sparql",ext:["rq","sparql"],alias:["sparul"]},{name:"Spreadsheet",mime:"text/x-spreadsheet",mode:"spreadsheet",alias:["excel","formula"]},{name:"SQL",mime:"text/x-sql",mode:"sql",ext:["sql"]},{name:"SQLite",mime:"text/x-sqlite",mode:"sql"},{name:"Squirrel",mime:"text/x-squirrel",mode:"clike",ext:["nut"]},{name:"Stylus",mime:"text/x-styl",mode:"stylus",ext:["styl"]},{name:"Swift",mime:"text/x-swift",mode:"swift",ext:["swift"]},{name:"sTeX",mime:"text/x-stex",mode:"stex"},{name:"LaTeX",mime:"text/x-latex",mode:"stex",ext:["text","ltx","tex"],alias:["tex"]},{name:"SystemVerilog",mime:"text/x-systemverilog",mode:"verilog",ext:["v","sv","svh"]},{name:"Tcl",mime:"text/x-tcl",mode:"tcl",ext:["tcl"]},{name:"Textile",mime:"text/x-textile",mode:"textile",ext:["textile"]},{name:"TiddlyWiki ",mime:"text/x-tiddlywiki",mode:"tiddlywiki"},{name:"Tiki wiki",mime:"text/tiki",mode:"tiki"},{name:"TOML",mime:"text/x-toml",mode:"toml",ext:["toml"]},{name:"Tornado",mime:"text/x-tornado",mode:"tornado"},{name:"troff",mime:"text/troff",mode:"troff",ext:["1","2","3","4","5","6","7","8","9"]},{name:"TTCN",mime:"text/x-ttcn",mode:"ttcn",ext:["ttcn","ttcn3","ttcnpp"]},{name:"TTCN_CFG",mime:"text/x-ttcn-cfg",mode:"ttcn-cfg",ext:["cfg"]},{name:"Turtle",mime:"text/turtle",mode:"turtle",ext:["ttl"]},{name:"TypeScript",mime:"application/typescript",mode:"javascript",ext:["ts"],alias:["ts"]},{name:"TypeScript-JSX",mime:"text/typescript-jsx",mode:"jsx",ext:["tsx"],alias:["tsx"]},{name:"Twig",mime:"text/x-twig",mode:"twig"},{name:"Web IDL",mime:"text/x-webidl",mode:"webidl",ext:["webidl"]},{name:"VB.NET",mime:"text/x-vb",mode:"vb",ext:["vb"]},{name:"VBScript",mime:"text/vbscript",mode:"vbscript",ext:["vbs"]},{name:"Velocity",mime:"text/velocity",mode:"velocity",ext:["vtl"]},{name:"Verilog",mime:"text/x-verilog",mode:"verilog",ext:["v"]},{name:"VHDL",mime:"text/x-vhdl",mode:"vhdl",ext:["vhd","vhdl"]},{name:"Vue.js Component",mimes:["script/x-vue","text/x-vue"],mode:"vue",ext:["vue"]},{name:"XML",mimes:["application/xml","text/xml"],mode:"xml",ext:["xml","xsl","xsd","svg"],alias:["rss","wsdl","xsd"]},{name:"XQuery",mime:"application/xquery",mode:"xquery",ext:["xy","xquery"]},{name:"Yacas",mime:"text/x-yacas",mode:"yacas",ext:["ys"]},{name:"YAML",mimes:["text/x-yaml","text/yaml"],mode:"yaml",ext:["yaml","yml"],alias:["yml"]},{name:"Z80",mime:"text/x-z80",mode:"z80",ext:["z80"]},{name:"mscgen",mime:"text/x-mscgen",mode:"mscgen",ext:["mscgen","mscin","msc"]},{name:"xu",mime:"text/x-xu",mode:"mscgen",ext:["xu"]},{name:"msgenny",mime:"text/x-msgenny",mode:"mscgen",ext:["msgenny"]}];for(var e=0;e<r.modeInfo.length;e++){var t=r.modeInfo[e];t.mimes&&(t.mime=t.mimes[0])}r.findModeByMIME=function(e){e=e.toLowerCase();for(var t=0;t<r.modeInfo.length;t++){var n=r.modeInfo[t];if(n.mime==e)return n;if(n.mimes)for(var i=0;i<n.mimes.length;i++)if(n.mimes[i]==e)return n}return/\+xml$/.test(e)?r.findModeByMIME("application/xml"):/\+json$/.test(e)?r.findModeByMIME("application/json"):void 0},r.findModeByExtension=function(e){for(var t=0;t<r.modeInfo.length;t++){var n=r.modeInfo[t];if(n.ext)for(var i=0;i<n.ext.length;i++)if(n.ext[i]==e)return n}},r.findModeByFileName=function(e){for(var t=0;t<r.modeInfo.length;t++){var n=r.modeInfo[t];if(n.file&&n.file.test(e))return n}var i=e.lastIndexOf("."),i=-1<i&&e.substring(i+1,e.length);if(i)return r.findModeByExtension(i)},r.findModeByName=function(e){e=e.toLowerCase();for(var t=0;t<r.modeInfo.length;t++){var n=r.modeInfo[t];if(n.name.toLowerCase()==e)return n;if(n.alias)for(var i=0;i<n.alias.length;i++)if(n.alias[i].toLowerCase()==e)return n}}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(y){"use strict";y.registerHelper("fold","brace",function(r,o){var s,a=o.line,l=r.getLine(a);function e(e){for(var t=o.ch,n=0;;){var i=t<=0?-1:l.lastIndexOf(e,t-1);if(-1!=i){if(1==n&&i<o.ch)break;if(s=r.getTokenTypeAt(y.Pos(a,i+1)),!/^(comment|string)/.test(s))return i+1;t=i-1}else{if(1==n)break;n=1,t=l.length}}}var t="{",n="}",i=e("{");if(null==i&&(n="]",i=e(t="[")),null!=i){var c,d,h=1,u=r.lastLine();e:for(var f=a;f<=u;++f)for(var p=r.getLine(f),g=f==a?i:0;;){var m=p.indexOf(t,g),v=p.indexOf(n,g);if(m<0&&(m=p.length),v<0&&(v=p.length),(g=Math.min(m,v))==p.length)break;if(r.getTokenTypeAt(y.Pos(f,g+1))==s)if(g==m)++h;else if(!--h){c=f,d=g;break e}++g}if(null!=c&&a!=c)return{from:y.Pos(a,i),to:y.Pos(c,d)}}}),y.registerHelper("fold","import",function(o,e){function t(e){if(e<o.firstLine()||e>o.lastLine())return null;var t=o.getTokenAt(y.Pos(e,1));if(/\S/.test(t.string)||(t=o.getTokenAt(y.Pos(e,t.end+1))),"keyword"!=t.type||"import"!=t.string)return null;for(var n=e,i=Math.min(o.lastLine(),e+10);n<=i;++n){var r=o.getLine(n).indexOf(";");if(-1!=r)return{startCh:t.end,end:y.Pos(n,r)}}}var n=e.line,i=t(n);if(!i||t(n-1)||(e=t(n-2))&&e.end.line==n-1)return null;for(var r=i.end;;){var s=t(r.line+1);if(null==s)break;r=s.end}return{from:o.clipPos(y.Pos(n,i.startCh+1)),to:r}}),y.registerHelper("fold","include",function(n,e){function t(e){if(e<n.firstLine()||e>n.lastLine())return null;var t=n.getTokenAt(y.Pos(e,1));return/\S/.test(t.string)||(t=n.getTokenAt(y.Pos(e,t.end+1))),"meta"==t.type&&"#include"==t.string.slice(0,8)?t.start+8:void 0}var i=e.line,e=t(i);if(null==e||null!=t(i-1))return null;for(var r=i;;){if(null==t(r+1))break;++r}return{from:y.Pos(i,e+1),to:n.clipPos(y.Pos(r))}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";var l=e.Pos;function a(e,t){return e.line-t.line||e.ch-t.ch}var t="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",i=new RegExp("<(/?)(["+t+"][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*)","g");function c(e,t,n,i){this.line=t,this.ch=n,this.cm=e,this.text=e.getLine(t),this.min=i?Math.max(i.from,e.firstLine()):e.firstLine(),this.max=i?Math.min(i.to-1,e.lastLine()):e.lastLine()}function d(e,t){t=e.cm.getTokenTypeAt(l(e.line,t));return t&&/\btag\b/.test(t)}function r(e){return!(e.line>=e.max)&&(e.ch=0,e.text=e.cm.getLine(++e.line),1)}function h(e){return!(e.line<=e.min)&&(e.text=e.cm.getLine(--e.line),e.ch=e.text.length,1)}function u(e){for(;;){var t=e.text.indexOf(">",e.ch);if(-1==t){if(r(e))continue;return}if(d(e,t+1)){var n=e.text.lastIndexOf("/",t),n=-1<n&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,n?"selfClose":"regular"}e.ch=t+1}}function f(e){for(;;){var t=e.ch?e.text.lastIndexOf("<",e.ch-1):-1;if(-1==t){if(h(e))continue;return}if(d(e,t+1)){i.lastIndex=t,e.ch=t;var n=i.exec(e.text);if(n&&n.index==t)return n}else e.ch=t}}function p(e){for(;;){i.lastIndex=e.ch;var t=i.exec(e.text);if(!t){if(r(e))continue;return}if(d(e,t.index+1))return e.ch=t.index+t[0].length,t;e.ch=t.index+1}}function g(e,t){for(var n=[];;){var i,r=p(e),o=e.line,s=e.ch-(r?r[0].length:0);if(!r||!(i=u(e)))return;if("selfClose"!=i)if(r[1]){for(var a=n.length-1;0<=a;--a)if(n[a]==r[2]){n.length=a;break}if(a<0&&(!t||t==r[2]))return{tag:r[2],from:l(o,s),to:l(e.line,e.ch)}}else n.push(r[2])}}function m(e,t){for(var n=[];;){var i=function(e){for(;;){var t=e.ch?e.text.lastIndexOf(">",e.ch-1):-1;if(-1==t){if(h(e))continue;return}if(d(e,t+1)){var n=e.text.lastIndexOf("/",t),n=-1<n&&!/\S/.test(e.text.slice(n+1,t));return e.ch=t+1,n?"selfClose":"regular"}e.ch=t}}(e);if(!i)return;if("selfClose"!=i){var r=e.line,i=e.ch,o=f(e);if(!o)return;if(o[1])n.push(o[2]);else{for(var s=n.length-1;0<=s;--s)if(n[s]==o[2]){n.length=s;break}if(s<0&&(!t||t==o[2]))return{tag:o[2],from:l(e.line,e.ch),to:l(r,i)}}}else f(e)}}e.registerHelper("fold","xml",function(e,t){for(var n=new c(e,t.line,0);;){var i=p(n);if(!i||n.line!=t.line)return;var r=u(n);if(!r)return;if(!i[1]&&"selfClose"!=r){r=l(n.line,n.ch),i=g(n,i[2]);return i&&0<a(i.from,r)?{from:r,to:i.from}:null}}}),e.findMatchingTag=function(e,t,n){var i=new c(e,t.line,t.ch,n);if(-1!=i.text.indexOf(">")||-1!=i.text.indexOf("<")){var r=u(i),o=r&&l(i.line,i.ch),s=r&&f(i);if(r&&s&&!(0<a(i,t))){t={from:l(i.line,i.ch),to:o,tag:s[2]};return"selfClose"==r?{open:t,close:null,at:"open"}:s[1]?{open:m(i,s[2]),close:t,at:"close"}:{open:t,close:g(i=new c(e,o.line,o.ch,n),s[2]),at:"open"}}}},e.findEnclosingTag=function(e,t,n,i){for(var r=new c(e,t.line,t.ch,n);;){var o=m(r,i);if(!o)break;var s=g(new c(e,t.line,t.ch,n),o.tag);if(s)return{open:o,close:s}}},e.scanForClosingTag=function(e,t,n,i){return g(new c(e,t.line,t.ch,i?{from:0,to:i}:null),n)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(d){"use strict";d.registerHelper("fold","markdown",function(t,e){function i(e){e=t.getTokenTypeAt(d.Pos(e,0));return e&&/\bheader\b/.test(e)}function n(e,t,n){t=t&&t.match(/^#+/);return t&&i(e)?t[0].length:(t=n&&n.match(/^[=\-]+\s*$/))&&i(e+1)?"="==n[0]?1:2:100}var r=t.getLine(e.line),o=t.getLine(e.line+1),s=n(e.line,r,o);if(100!==s){for(var a=t.lastLine(),l=e.line,c=t.getLine(l+2);l<a&&!(n(l+1,o,c)<=s);)++l,o=c,c=t.getLine(l+2);return{from:d.Pos(e.line,r.length),to:d.Pos(l,t.getLine(l).length)}}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(x){"use strict";x.registerGlobalHelper("fold","comment",function(e){return e.blockCommentStart&&e.blockCommentEnd},function(e,t){var n=e.getModeAt(t),i=n.blockCommentStart,r=n.blockCommentEnd;if(i&&r){for(var o,s=t.line,a=e.getLine(s),l=t.ch,c=0;;){var d=l<=0?-1:a.lastIndexOf(i,l-1);if(-1!=d){if(1==c&&d<t.ch)return;if(/comment/.test(e.getTokenTypeAt(x.Pos(s,d+1)))&&(0==d||a.slice(d-r.length,d)==r||!/comment/.test(e.getTokenTypeAt(x.Pos(s,d))))){o=d+i.length;break}l=d-1}else{if(1==c)return;c=1,l=a.length}}var h,u,f=1,p=e.lastLine();e:for(var g=s;g<=p;++g)for(var m=e.getLine(g),v=g==s?o:0;;){var y=m.indexOf(i,v),_=m.indexOf(r,v);if(y<0&&(y=m.length),_<0&&(_=m.length),(v=Math.min(y,_))==m.length)break;if(v==y)++f;else if(!--f){h=g,u=v;break e}++v}if(null!=h&&(s!=h||u!=o))return{from:x.Pos(s,o),to:x.Pos(h,u)}}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(a){"use strict";function l(e,t){var n=e.getLine(t),i=n.search(/\S/);return-1==i||/\bcomment\b/.test(e.getTokenTypeAt(a.Pos(t,i+1)))?-1:a.countColumn(n,null,e.getOption("tabSize"))}a.registerHelper("fold","indent",function(e,t){var n=l(e,t.line);if(!(n<0)){for(var i=null,r=t.line+1,o=e.lastLine();r<=o;++r){var s=l(e,r);if(-1!=s){if(!(n<s))break;i=r}}return i?{from:a.Pos(t.line,e.getLine(t.line).length),to:a.Pos(i,e.getLine(i).length)}:void 0}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(d){"use strict";function r(r,o,e,s){var a;e&&e.call?(a=e,e=null):a=h(r,e,"rangeFinder"),"number"==typeof o&&(o=d.Pos(o,0));var l=h(r,e,"minFoldSize");function t(e){var t=a(r,o);if(!t||t.to.line-t.from.line<l)return null;for(var n=r.findMarksAt(t.from),i=0;i<n.length;++i)if(n[i].__isFold&&"fold"!==s){if(!e)return null;t.cleared=!0,n[i].clear()}return t}var n,i,c=t(!0);if(h(r,e,"scanUp"))for(;!c&&o.line>r.firstLine();)o=d.Pos(o.line-1,0),c=t(!1);c&&!c.cleared&&"unfold"!==s&&(n=function(e,t){e=h(e,t,"widget");"string"==typeof e?(t=document.createTextNode(e),(e=document.createElement("span")).appendChild(t),e.className="CodeMirror-foldmarker"):e=e&&e.cloneNode(!0);return e}(r,e),d.on(n,"mousedown",function(e){i.clear(),d.e_preventDefault(e)}),(i=r.markText(c.from,c.to,{replacedWith:n,clearOnEnter:h(r,e,"clearOnEnter"),__isFold:!0})).on("clear",function(e,t){d.signal(r,"unfold",r,e,t)}),d.signal(r,"fold",r,c.from,c.to))}d.newFoldFunction=function(n,i){return function(e,t){r(e,t,{rangeFinder:n,widget:i})}},d.defineExtension("foldCode",function(e,t,n){r(this,e,t,n)}),d.defineExtension("isFolded",function(e){for(var t=this.findMarksAt(e),n=0;n<t.length;++n)if(t[n].__isFold)return!0}),d.commands.toggleFold=function(e){e.foldCode(e.getCursor())},d.commands.fold=function(e){e.foldCode(e.getCursor(),null,"fold")},d.commands.unfold=function(e){e.foldCode(e.getCursor(),null,"unfold")},d.commands.foldAll=function(n){n.operation(function(){for(var e=n.firstLine(),t=n.lastLine();e<=t;e++)n.foldCode(d.Pos(e,0),null,"fold")})},d.commands.unfoldAll=function(n){n.operation(function(){for(var e=n.firstLine(),t=n.lastLine();e<=t;e++)n.foldCode(d.Pos(e,0),null,"unfold")})},d.registerHelper("fold","combine",function(){var r=Array.prototype.slice.call(arguments,0);return function(e,t){for(var n=0;n<r.length;++n){var i=r[n](e,t);if(i)return i}}}),d.registerHelper("fold","auto",function(e,t){for(var n=e.getHelpers(t,"fold"),i=0;i<n.length;i++){var r=n[i](e,t);if(r)return r}});var i={rangeFinder:d.fold.auto,widget:"↔",minFoldSize:0,scanUp:!1,clearOnEnter:!0};function h(e,t,n){if(t&&void 0!==t[n])return t[n];e=e.options.foldOptions;return(e&&void 0!==e[n]?e:i)[n]}d.defineOption("foldOptions",null),d.defineExtension("foldOption",function(e,t){return h(this,e,t)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("./foldcode")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","./foldcode"],e):e(CodeMirror)}(function(i){"use strict";i.defineOption("foldGutter",!1,function(e,t,n){n&&n!=i.Init&&(e.clearGutter(e.state.foldGutter.options.gutter),e.state.foldGutter=null,e.off("gutterClick",a),e.off("change",h),e.off("viewportChange",u),e.off("fold",f),e.off("unfold",f),e.off("swapDoc",h)),t&&(e.state.foldGutter=new r(function(e){!0===e&&(e={});null==e.gutter&&(e.gutter="CodeMirror-foldgutter");null==e.indicatorOpen&&(e.indicatorOpen="CodeMirror-foldgutter-open");null==e.indicatorFolded&&(e.indicatorFolded="CodeMirror-foldgutter-folded");return e}(t)),s(e),e.on("gutterClick",a),e.on("change",h),e.on("viewportChange",u),e.on("fold",f),e.on("unfold",f),e.on("swapDoc",h))});var l=i.Pos;function r(e){this.options=e,this.from=this.to=0}function c(e,t){for(var n=e.findMarks(l(t,0),l(t+1,0)),i=0;i<n.length;++i)if(n[i].__isFold&&n[i].find().from.line==t)return n[i]}function d(e){if("string"!=typeof e)return e.cloneNode(!0);var t=document.createElement("div");return t.className=e+" CodeMirror-guttermarker-subtle",t}function o(i,e,t){var r=i.state.foldGutter.options,o=e,s=i.foldOption(r,"minFoldSize"),a=i.foldOption(r,"rangeFinder");i.eachLine(e,t,function(e){var t,n=null;c(i,o)?n=d(r.indicatorFolded):(t=l(o,0),(t=a&&a(i,t))&&t.to.line-t.from.line>=s&&(n=d(r.indicatorOpen))),i.setGutterMarker(e,r.gutter,n),++o})}function s(e){var t=e.getViewport(),n=e.state.foldGutter;n&&(e.operation(function(){o(e,t.from,t.to)}),n.from=t.from,n.to=t.to)}function a(e,t,n){var i=e.state.foldGutter;!i||n==(n=i.options).gutter&&((i=c(e,t))?i.clear():e.foldCode(l(t,0),n.rangeFinder))}function h(e){var t,n=e.state.foldGutter;n&&(t=n.options,n.from=n.to=0,clearTimeout(n.changeUpdate),n.changeUpdate=setTimeout(function(){s(e)},t.foldOnChangeTimeSpan||600))}function u(t){var e,n=t.state.foldGutter;n&&(e=n.options,clearTimeout(n.changeUpdate),n.changeUpdate=setTimeout(function(){var e=t.getViewport();n.from==n.to||20<e.from-n.to||20<n.from-e.to?s(t):t.operation(function(){e.from<n.from&&(o(t,e.from,n.from),n.from=e.from),e.to>n.to&&(o(t,n.to,e.to),n.to=e.to)})},e.updateViewportTimeSpan||400))}function f(e,t){var n=e.state.foldGutter;!n||(t=t.line)>=n.from&&t<n.to&&o(e,t,t+1)}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";var b={},k=/[^\s\u00a0]/,C=e.Pos;function u(e){e=e.search(k);return-1==e?0:e}function w(e,t){var n=e.getMode();return!1!==n.useInnerComments&&n.innerMode?e.getModeAt(t):n}e.commands.toggleComment=function(e){e.toggleComment()},e.defineExtension("toggleComment",function(e){e=e||b;for(var t=1/0,n=this.listSelections(),i=null,r=n.length-1;0<=r;r--){var o=n[r].from(),s=n[r].to();o.line>=t||(s.line>=t&&(s=C(t,0)),t=o.line,null==i?i=this.uncomment(o,s,e)?"un":(this.lineComment(o,s,e),"line"):"un"==i?this.uncomment(o,s,e):this.lineComment(o,s,e))}}),e.defineExtension("lineComment",function(o,e,s){s=s||b;var t,a,l,c,d,h=this,n=w(h,o),i=h.getLine(o.line);null!=i&&(t=o,i=i,!/\bstring\b/.test(h.getTokenTypeAt(C(t.line,0)))||/^[\'\"\`]/.test(i))&&((a=s.lineComment||n.lineComment)?(l=Math.min(0!=e.ch||e.line==o.line?e.line+1:e.line,h.lastLine()+1),c=null==s.padding?" ":s.padding,d=s.commentBlankLines||o.line==e.line,h.operation(function(){if(s.indent){for(var e=null,t=o.line;t<l;++t){var n=(i=h.getLine(t)).slice(0,u(i));(null==e||e.length>n.length)&&(e=n)}for(t=o.line;t<l;++t){var i=h.getLine(t),r=e.length;(d||k.test(i))&&(i.slice(0,r)!=e&&(r=u(i)),h.replaceRange(e+a+c,C(t,0),C(t,r)))}}else for(t=o.line;t<l;++t)(d||k.test(h.getLine(t)))&&h.replaceRange(a+c,C(t,0))})):(s.blockCommentStart||n.blockCommentStart)&&(s.fullLines=!0,h.blockComment(o,e,s)))}),e.defineExtension("blockComment",function(i,r,o){o=o||b;var s,a,l=this,c=w(l,i),d=o.blockCommentStart||c.blockCommentStart,h=o.blockCommentEnd||c.blockCommentEnd;d&&h?/\bcomment\b/.test(l.getTokenTypeAt(C(i.line,0)))||((s=Math.min(r.line,l.lastLine()))!=i.line&&0==r.ch&&k.test(l.getLine(s))&&--s,a=null==o.padding?" ":o.padding,i.line>s||l.operation(function(){if(0!=o.fullLines){var e=k.test(l.getLine(s));l.replaceRange(a+h,C(s)),l.replaceRange(d+a,C(i.line,0));var t=o.blockCommentLead||c.blockCommentLead;if(null!=t)for(var n=i.line+1;n<=s;++n)n==s&&!e||l.replaceRange(t+a,C(n,0))}else l.replaceRange(h,r),l.replaceRange(d,i)})):(o.lineComment||c.lineComment)&&0!=o.fullLines&&l.lineComment(i,r,o)}),e.defineExtension("uncomment",function(e,t,n){n=n||b;var r,o=this,i=w(o,e),s=Math.min(0!=t.ch||t.line==e.line?t.line:t.line-1,o.lastLine()),a=Math.min(e.line,s),l=n.lineComment||i.lineComment,c=[],d=null==n.padding?" ":n.padding;e:if(l){for(var h=a;h<=s;++h){var u=o.getLine(h),f=u.indexOf(l);if(-1<f&&!/comment/.test(o.getTokenTypeAt(C(h,f+1)))&&(f=-1),-1==f&&k.test(u))break e;if(-1<f&&k.test(u.slice(0,f)))break e;c.push(u)}if(o.operation(function(){for(var e=a;e<=s;++e){var t=c[e-a],n=t.indexOf(l),i=n+l.length;n<0||(t.slice(i,i+d.length)==d&&(i+=d.length),r=!0,o.replaceRange("",C(e,n),C(e,i)))}}),r)return!0}var p=n.blockCommentStart||i.blockCommentStart,g=n.blockCommentEnd||i.blockCommentEnd;if(!p||!g)return!1;var m=n.blockCommentLead||i.blockCommentLead,v=o.getLine(a),y=v.indexOf(p);if(-1==y)return!1;var _=s==a?v:o.getLine(s),x=_.indexOf(g,s==a?y+p.length:0),n=C(a,y+1),i=C(s,x+1);if(-1==x||!/comment/.test(o.getTokenTypeAt(n))||!/comment/.test(o.getTokenTypeAt(i))||-1<o.getRange(n,i,"\n").indexOf(g))return!1;i=-1==(n=v.lastIndexOf(p,e.ch))?-1:v.slice(0,e.ch).indexOf(g,n+p.length);if(-1!=n&&-1!=i&&i+g.length!=e.ch)return!1;i=_.indexOf(g,t.ch);e=_.slice(t.ch).lastIndexOf(p,i-t.ch),n=-1==i||-1==e?-1:t.ch+e;return(-1==i||-1==n||n==t.ch)&&(o.operation(function(){o.replaceRange("",C(s,x-(d&&_.slice(x-d.length,x)==d?d.length:0)),C(s,x+g.length));var e=y+p.length;if(d&&v.slice(e,e+d.length)==d&&(e+=d.length),o.replaceRange("",C(a,y),C(a,e)),m)for(var t=a+1;t<=s;++t){var n,i=o.getLine(t),r=i.indexOf(m);-1==r||k.test(i.slice(0,r))||(n=r+m.length,d&&i.slice(n,n+d.length)==d&&(n+=d.length),o.replaceRange("",C(t,r),C(t,n)))}}),!0)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(y){var n={pairs:"()[]{}''\"\"",closeBefore:")]}'\":;>",triples:"",explode:"[]{}"},_=y.Pos;function x(e,t){return"pairs"==t&&"string"==typeof e?e:("object"==typeof e&&null!=e[t]?e:n)[t]}y.defineOption("autoCloseBrackets",!1,function(e,t,n){n&&n!=y.Init&&(e.removeKeyMap(r),e.state.closeBrackets=null),t&&(i(x(t,"pairs")),e.state.closeBrackets=t,e.addKeyMap(r))});var r={Backspace:function(e){var t=b(e);if(!t||e.getOption("disableInput"))return y.Pass;for(var n=x(t,"pairs"),i=e.listSelections(),r=0;r<i.length;r++){if(!i[r].empty())return y.Pass;var o=a(e,i[r].head);if(!o||n.indexOf(o)%2!=0)return y.Pass}for(r=i.length-1;0<=r;r--){var s=i[r].head;e.replaceRange("",_(s.line,s.ch-1),_(s.line,s.ch+1),"+delete")}},Enter:function(i){var e=b(i),t=e&&x(e,"explode");if(!t||i.getOption("disableInput"))return y.Pass;for(var r=i.listSelections(),n=0;n<r.length;n++){if(!r[n].empty())return y.Pass;var o=a(i,r[n].head);if(!o||t.indexOf(o)%2!=0)return y.Pass}i.operation(function(){var e=i.lineSeparator()||"\n";i.replaceSelection(e+e,null),i.execCommand("goCharLeft"),r=i.listSelections();for(var t=0;t<r.length;t++){var n=r[t].head.line;i.indentLine(n,null,!0),i.indentLine(n+1,null,!0)}})}};function i(e){for(var t=0;t<e.length;t++){var n=e.charAt(t),i="'"+n+"'";r[i]||(r[i]=function(t){return function(e){return function(r,e){var t=b(r);if(!t||r.getOption("disableInput"))return y.Pass;var n=x(t,"pairs"),i=n.indexOf(e);if(-1==i)return y.Pass;for(var o,s=x(t,"closeBefore"),a=x(t,"triples"),l=n.charAt(i+1)==e,c=r.listSelections(),d=i%2==0,h=0;h<c.length;h++){var u,f=c[h],p=f.head,g=r.getRange(p,_(p.line,p.ch+1));if(d&&!f.empty())u="surround";else if(!l&&d||g!=e)if(l&&1<p.ch&&0<=a.indexOf(e)&&r.getRange(_(p.line,p.ch-2),p)==e+e){if(2<p.ch&&/\bstring/.test(r.getTokenTypeAt(_(p.line,p.ch-2))))return y.Pass;u="addFour"}else if(l){f=0==p.ch?" ":r.getRange(_(p.line,p.ch-1),p);if(y.isWordChar(g)||f==e||y.isWordChar(f))return y.Pass;u="both"}else{if(!d||!(0===g.length||/\s/.test(g)||-1<s.indexOf(g)))return y.Pass;u="both"}else u=l&&function(e,t){var n=e.getTokenAt(_(t.line,t.ch+1));return/\bstring/.test(n.type)&&n.start==t.ch&&(0==t.ch||!/\bstring/.test(e.getTokenTypeAt(t)))}(r,p)?"both":0<=a.indexOf(e)&&r.getRange(p,_(p.line,p.ch+3))==e+e+e?"skipThree":"skip";if(o){if(o!=u)return y.Pass}else o=u}var m=i%2?n.charAt(i-1):e,v=i%2?e:n.charAt(i+1);r.operation(function(){if("skip"==o)r.execCommand("goCharRight");else if("skipThree"==o)for(var e=0;e<3;e++)r.execCommand("goCharRight");else if("surround"==o){for(var t=r.getSelections(),e=0;e<t.length;e++)t[e]=m+t[e]+v;r.replaceSelections(t,"around"),t=r.listSelections().slice();for(e=0;e<t.length;e++)t[e]=(n=t[e],i=void 0,i=0<y.cmpPos(n.anchor,n.head),{anchor:new _(n.anchor.line,n.anchor.ch+(i?-1:1)),head:new _(n.head.line,n.head.ch+(i?1:-1))});r.setSelections(t)}else"both"==o?(r.replaceSelection(m+v,null),r.triggerElectric(m+v),r.execCommand("goCharLeft")):"addFour"==o&&(r.replaceSelection(m+m+m+m,"before"),r.execCommand("goCharRight"));var n,i})}(e,t)}}(n))}}function b(e){var t=e.state.closeBrackets;return t&&!t.override&&e.getModeAt(e.getCursor()).closeBrackets||t}function a(e,t){t=e.getRange(_(t.line,t.ch-1),_(t.line,t.ch+1));return 2==t.length?t:null}i(n.pairs+"`")}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(i){var d=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),m=i.Pos,v={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<","<":">>",">":"<<"};function y(e){return e&&e.bracketRegex||/[(){}[\]]/}function h(e,t,n){var i=e.getLineHandle(t.line),r=t.ch-1,o=n&&n.afterCursor;null==o&&(o=/(^| )cm-fat-cursor($| )/.test(e.getWrapperElement().className));var s=y(n),o=!o&&0<=r&&s.test(i.text.charAt(r))&&v[i.text.charAt(r)]||s.test(i.text.charAt(r+1))&&v[i.text.charAt(++r)];if(!o)return null;s=">"==o.charAt(1)?1:-1;if(n&&n.strict&&0<s!=(r==t.ch))return null;i=e.getTokenTypeAt(m(t.line,r+1)),n=a(e,m(t.line,r+(0<s?1:0)),s,i||null,n);return null==n?null:{from:m(t.line,r),to:n&&n.pos,match:n&&n.ch==o.charAt(0),forward:0<s}}function a(e,t,n,i,r){for(var o=r&&r.maxScanLineLength||1e4,s=r&&r.maxScanLines||1e3,a=[],l=y(r),c=0<n?Math.min(t.line+s,e.lastLine()+1):Math.max(e.firstLine()-1,t.line-s),d=t.line;d!=c;d+=n){var h=e.getLine(d);if(h){var u=0<n?0:h.length-1,f=0<n?h.length:-1;if(!(h.length>o))for(d==t.line&&(u=t.ch-(n<0?1:0));u!=f;u+=n){var p=h.charAt(u);if(l.test(p)&&(void 0===i||e.getTokenTypeAt(m(d,u+1))==i)){var g=v[p];if(g&&">"==g.charAt(1)==0<n)a.push(p);else{if(!a.length)return{pos:m(d,u),ch:p};a.pop()}}}}}return d-n!=(0<n?e.lastLine():e.firstLine())&&null}function t(e,t,n){for(var i=e.state.matchBrackets.maxHighlightLineLength||1e3,r=[],o=e.listSelections(),s=0;s<o.length;s++){var a,l=o[s].empty()&&h(e,o[s].head,n);l&&e.getLine(l.from.line).length<=i&&(a=l.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket",r.push(e.markText(l.from,m(l.from.line,l.from.ch+1),{className:a})),l.to&&e.getLine(l.to.line).length<=i&&r.push(e.markText(l.to,m(l.to.line,l.to.ch+1),{className:a})))}if(r.length){d&&e.state.focused&&e.focus();function c(){e.operation(function(){for(var e=0;e<r.length;e++)r[e].clear()})}if(!t)return c;setTimeout(c,800)}}function r(e){e.operation(function(){e.state.matchBrackets.currentlyHighlighted&&(e.state.matchBrackets.currentlyHighlighted(),e.state.matchBrackets.currentlyHighlighted=null),e.state.matchBrackets.currentlyHighlighted=t(e,!1,e.state.matchBrackets)})}i.defineOption("matchBrackets",!1,function(e,t,n){n&&n!=i.Init&&(e.off("cursorActivity",r),e.state.matchBrackets&&e.state.matchBrackets.currentlyHighlighted&&(e.state.matchBrackets.currentlyHighlighted(),e.state.matchBrackets.currentlyHighlighted=null)),t&&(e.state.matchBrackets="object"==typeof t?t:{},e.on("cursorActivity",r))}),i.defineExtension("matchBrackets",function(){t(this,!0)}),i.defineExtension("findMatchingBracket",function(e,t,n){return!n&&"boolean"!=typeof t||(t=n?(n.strict=t,n):t?{strict:!0}:null),h(this,e,t)}),i.defineExtension("scanForBracket",function(e,t,n,i){return a(this,e,t,n,i)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(g){"use strict";g.runMode=function(e,t,n,i){var l,c,d,r=g.getMode(g.defaults,t),h=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<9);n.appendChild&&(l=i&&i.tabSize||g.defaults.tabSize,d=0,(c=n).innerHTML="",n=function(e,t){if("\n"==e)return c.appendChild(document.createTextNode(h?"\r":e)),void(d=0);for(var n,i="",r=0;;){var o=e.indexOf("\t",r);if(-1==o){i+=e.slice(r),d+=e.length-r;break}d+=o-r,i+=e.slice(r,o);var s=l-d%l;d+=s;for(var a=0;a<s;++a)i+=" ";r=o+1}t?((n=c.appendChild(document.createElement("span"))).className="cm-"+t.replace(/ +/g," cm-"),n.appendChild(document.createTextNode(i))):c.appendChild(document.createTextNode(i))});for(var o=g.splitLines(e),s=i&&i.state||g.startState(r),a=0,u=o.length;a<u;++a){a&&n("\n");var f=new g.StringStream(o[a]);for(!f.string&&r.blankLine&&r.blankLine(s);!f.eol();){var p=r.token(f,s);n(f.current(),p,a,f.start,s),f.start=f.pos}}}}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(S){"use strict";var T="CodeMirror-hint-active";function i(e,t){this.cm=e,this.options=t,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length;var n=this;e.on("cursorActivity",this.activityFunc=function(){n.cursorActivity()})}S.showHint=function(e,t,n){if(!t)return e.showHint(n);n&&n.async&&(t.async=!0);var i={hint:t};if(n)for(var r in n)i[r]=n[r];return e.showHint(i)},S.defineExtension("showHint",function(e){e=function(e,t,n){var i=e.options.hintOptions,r={};for(o in s)r[o]=s[o];if(i)for(var o in i)void 0!==i[o]&&(r[o]=i[o]);if(n)for(var o in n)void 0!==n[o]&&(r[o]=n[o]);r.hint.resolve&&(r.hint=r.hint.resolve(e,t));return r}(this,this.getCursor("start"),e);var t=this.listSelections();if(!(1<t.length)){if(this.somethingSelected()){if(!e.hint.supportsSelection)return;for(var n=0;n<t.length;n++)if(t[n].head.line!=t[n].anchor.line)return}this.state.completionActive&&this.state.completionActive.close();e=this.state.completionActive=new i(this,e);e.options.hint&&(S.signal(this,"startCompletion",this),e.update(!0))}}),S.defineExtension("closeHint",function(){this.state.completionActive&&this.state.completionActive.close()});var r=window.requestAnimationFrame||function(e){return setTimeout(e,1e3/60)},o=window.cancelAnimationFrame||clearTimeout;function L(e){return"string"==typeof e?e:e.text}function j(e,t){for(;t&&t!=e;){if("LI"===t.nodeName.toUpperCase()&&t.parentNode==e)return t;t=t.parentNode}}function n(r,e){this.completion=r,this.data=e,this.picked=!1;var n=this,o=r.cm,s=o.getInputField().ownerDocument,a=s.defaultView||s.parentWindow,l=this.hints=s.createElement("ul"),t=r.cm.options.theme;l.className="CodeMirror-hints "+t,this.selectedHint=e.selectedHint||0;for(var i=e.list,c=0;c<i.length;++c){var d=l.appendChild(s.createElement("li")),h=i[c],u="CodeMirror-hint"+(c!=this.selectedHint?"":" "+T);null!=h.className&&(u=h.className+" "+u),d.className=u,h.render?h.render(d,e,h):d.appendChild(s.createTextNode(h.displayText||L(h))),d.hintId=c}var f=o.cursorCoords(r.options.alignWithWord?e.from:null),p=f.left,g=f.bottom,m=!0;l.style.left=p+"px",l.style.top=g+"px";var v=a.innerWidth||Math.max(s.body.offsetWidth,s.documentElement.offsetWidth),y=a.innerHeight||Math.max(s.body.offsetHeight,s.documentElement.offsetHeight);(r.options.container||s.body).appendChild(l);var _=l.getBoundingClientRect(),x=_.bottom-y,t=l.scrollHeight>l.clientHeight+1,b=o.getScrollInfo();0<x&&(x=_.bottom-_.top,0<f.top-(f.bottom-_.top)-x?(l.style.top=(g=f.top-x)+"px",m=!1):y<x&&(l.style.height=y-5+"px",l.style.top=(g=f.bottom-_.top)+"px",C=o.getCursor(),e.from.ch!=C.ch&&(f=o.cursorCoords(C),l.style.left=(p=f.left)+"px",_=l.getBoundingClientRect())));var k,C=_.right-v;if(0<C&&(_.right-_.left>v&&(l.style.width=v-5+"px",C-=_.right-_.left-v),l.style.left=(p=f.left-C)+"px"),t)for(var w=l.firstChild;w;w=w.nextSibling)w.style.paddingRight=o.display.nativeBarWidth+"px";return o.addKeyMap(this.keyMap=function(e,i){var r={Up:function(){i.moveFocus(-1)},Down:function(){i.moveFocus(1)},PageUp:function(){i.moveFocus(1-i.menuSize(),!0)},PageDown:function(){i.moveFocus(i.menuSize()-1,!0)},Home:function(){i.setFocus(0)},End:function(){i.setFocus(i.length-1)},Enter:i.pick,Tab:i.pick,Esc:i.close};/Mac/.test(navigator.platform)&&(r["Ctrl-P"]=function(){i.moveFocus(-1)},r["Ctrl-N"]=function(){i.moveFocus(1)});var t=e.options.customKeys,o=t?{}:r;function n(e,t){var n="string"!=typeof t?function(e){return t(e,i)}:r.hasOwnProperty(t)?r[t]:t;o[e]=n}if(t)for(var s in t)t.hasOwnProperty(s)&&n(s,t[s]);var a=e.options.extraKeys;if(a)for(var s in a)a.hasOwnProperty(s)&&n(s,a[s]);return o}(r,{moveFocus:function(e,t){n.changeActive(n.selectedHint+e,t)},setFocus:function(e){n.changeActive(e)},menuSize:function(){return n.screenAmount()},length:i.length,close:function(){r.close()},pick:function(){n.pick()},data:e})),r.options.closeOnUnfocus&&(o.on("blur",this.onBlur=function(){k=setTimeout(function(){r.close()},100)}),o.on("focus",this.onFocus=function(){clearTimeout(k)})),o.on("scroll",this.onScroll=function(){var e=o.getScrollInfo(),t=o.getWrapperElement().getBoundingClientRect(),n=g+b.top-e.top,i=n-(a.pageYOffset||(s.documentElement||s.body).scrollTop);if(m||(i+=l.offsetHeight),i<=t.top||i>=t.bottom)return r.close();l.style.top=n+"px",l.style.left=p+b.left-e.left+"px"}),S.on(l,"dblclick",function(e){e=j(l,e.target||e.srcElement);e&&null!=e.hintId&&(n.changeActive(e.hintId),n.pick())}),S.on(l,"click",function(e){e=j(l,e.target||e.srcElement);e&&null!=e.hintId&&(n.changeActive(e.hintId),r.options.completeOnSingleClick&&n.pick())}),S.on(l,"mousedown",function(){setTimeout(function(){o.focus()},20)}),S.signal(e,"select",i[this.selectedHint],l.childNodes[this.selectedHint]),!0}function a(e,t,n,i){e.async?e(t,i,n):(n=e(t,n))&&n.then?n.then(i):i(n)}i.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&S.signal(this.data,"close"),this.widget&&this.widget.close(),S.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(e,t){t=e.list[t];t.hint?t.hint(this.cm,e,t):this.cm.replaceRange(L(t),t.from||e.from,t.to||e.to,"complete"),S.signal(e,"pick",t),this.close()},cursorActivity:function(){this.debounce&&(o(this.debounce),this.debounce=0);var e,t=this.cm.getCursor(),n=this.cm.getLine(t.line);t.line!=this.startPos.line||n.length-t.ch!=this.startLen-this.startPos.ch||t.ch<this.startPos.ch||this.cm.somethingSelected()||!t.ch||this.options.closeCharacters.test(n.charAt(t.ch-1))?this.close():((e=this).debounce=r(function(){e.update()}),this.widget&&this.widget.disable())},update:function(t){var n,i;null!=this.tick&&(i=++(n=this).tick,a(this.options.hint,this.cm,this.options,function(e){n.tick==i&&n.finishUpdate(e,t)}))},finishUpdate:function(e,t){this.data&&S.signal(this.data,"update");t=this.widget&&this.widget.picked||t&&this.options.completeSingle;this.widget&&this.widget.close(),(this.data=e)&&e.list.length&&(t&&1==e.list.length?this.pick(e,0):(this.widget=new n(this,e),S.signal(e,"shown")))}},n.prototype={close:function(){var e;this.completion.widget==this&&(this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap),e=this.completion.cm,this.completion.options.closeOnUnfocus&&(e.off("blur",this.onBlur),e.off("focus",this.onFocus)),e.off("scroll",this.onScroll))},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var e=this;this.keyMap={Enter:function(){e.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(e,t){e>=this.data.list.length?e=t?this.data.list.length-1:0:e<0&&(e=t?0:this.data.list.length-1),this.selectedHint!=e&&((t=this.hints.childNodes[this.selectedHint])&&(t.className=t.className.replace(" "+T,"")),(t=this.hints.childNodes[this.selectedHint=e]).className+=" "+T,t.offsetTop<this.hints.scrollTop?this.hints.scrollTop=t.offsetTop-3:t.offsetTop+t.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=t.offsetTop+t.offsetHeight-this.hints.clientHeight+3),S.signal(this.data,"select",this.data.list[this.selectedHint],t))},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},S.registerHelper("hint","auto",{resolve:function(e,t){var n,s=e.getHelpers(t,"hint");if(s.length){t=function(e,i,r){var o=function(e,t){if(!e.somethingSelected())return t;for(var n=[],i=0;i<t.length;i++)t[i].supportsSelection&&n.push(t[i]);return n}(e,s);!function t(n){if(n==o.length)return i(null);a(o[n],e,r,function(e){e&&0<e.list.length?i(e):t(n+1)})}(0)};return t.async=!0,t.supportsSelection=!0,t}return(n=e.getHelper(e.getCursor(),"hintWords"))?function(e){return S.hint.fromList(e,{words:n})}:S.hint.anyword?function(e,t){return S.hint.anyword(e,t)}:function(){}}}),S.registerHelper("hint","fromList",function(e,t){var n,i=e.getCursor(),r=e.getTokenAt(i),o=S.Pos(i.line,r.start),e=i;r.start<i.ch&&/\w/.test(r.string.charAt(i.ch-r.start-1))?n=r.string.substr(0,i.ch-r.start):(n="",o=i);for(var s=[],a=0;a<t.words.length;a++){var l=t.words[a];l.slice(0,n.length)==n&&s.push(l)}if(s.length)return{list:s,from:o,to:e}}),S.commands.autocomplete=S.showHint;var s={hint:S.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null};S.defineOption("hintOptions",null)}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(p){"use strict";var g="CodeMirror-lint-markers";function l(e){e.parentNode&&e.parentNode.removeChild(e)}function m(e,t,n){var i,r=(e=e,t=t,(i=document.createElement("div")).className="CodeMirror-lint-tooltip",i.appendChild(t.cloneNode(!0)),document.body.appendChild(i),p.on(document,"mousemove",o),o(e),null!=i.style.opacity&&(i.style.opacity=1),i);function o(e){if(!i.parentNode)return p.off(document,"mousemove",o);i.style.top=Math.max(0,e.clientY-i.offsetHeight-5)+"px",i.style.left=e.clientX+5+"px"}function s(){var e;p.off(n,"mouseout",s),r&&((e=r).parentNode&&(null==e.style.opacity&&l(e),e.style.opacity=0,setTimeout(function(){l(e)},600)),r=null)}var a=setInterval(function(){if(r)for(var e=n;;e=e.parentNode){if(e&&11==e.nodeType&&(e=e.host),e==document.body)return;if(!e){s();break}}if(!r)return clearInterval(a)},400);p.on(n,"mouseout",s)}function s(t,e,n){this.marked=[],this.options=e,this.timeout=null,this.hasGutter=n,this.onMouseOver=function(e){!function(e,t){var n=t.target||t.srcElement;if(!/\bCodeMirror-lint-mark-/.test(n.className))return;for(var i=n.getBoundingClientRect(),n=(i.left+i.right)/2,i=(i.top+i.bottom)/2,r=e.findMarksAt(e.coordsChar({left:n,top:i},"client")),o=[],s=0;s<r.length;++s){var a=r[s].__annotation;a&&o.push(a)}o.length&&function(e,t){for(var n=t.target||t.srcElement,i=document.createDocumentFragment(),r=0;r<e.length;r++){var o=e[r];i.appendChild(y(o))}m(t,i,n)}(o,t)}(t,e)},this.waitingFor=0}function v(e){var t=e.state.lint;t.hasGutter&&e.clearGutter(g);for(var n=0;n<t.marked.length;++n)t.marked[n].clear();t.marked.length=0}function y(e){var t=(t=e.severity)||"error",n=document.createElement("div");return n.className="CodeMirror-lint-message-"+t,void 0!==e.messageHTML?n.innerHTML=e.messageHTML:n.appendChild(document.createTextNode(e.message)),n}function a(t){var e,n,i,r,o,s=t.state.lint.options,a=s.options||s,l=s.getAnnotations||t.getHelper(p.Pos(0,0),"lint");function c(){o=-1,n.off("change",c)}l&&(s.async||l.async?(i=l,s=a,r=(n=t).state.lint,o=++r.waitingFor,n.on("change",c),i(n.getValue(),function(e,t){n.off("change",c),r.waitingFor==o&&(t&&e instanceof p&&(e=t),n.operation(function(){d(n,e)}))},s,n)):(e=l(t.getValue(),a,t))&&(e.then?e.then(function(e){t.operation(function(){d(t,e)})}):t.operation(function(){d(t,e)})))}function d(e,t){v(e);for(var n,i,r=e.state.lint,o=r.options,s=function(e){for(var t=[],n=0;n<e.length;++n){var i=e[n],r=i.from.line;(t[r]||(t[r]=[])).push(i)}return t}(t),a=0;a<s.length;++a){var l=s[a];if(l){for(var c=null,d=r.hasGutter&&document.createDocumentFragment(),h=0;h<l.length;++h){var u=l[h],f=u.severity;i=f=f||"error",c="error"==(n=c)?n:i,o.formatAnnotation&&(u=o.formatAnnotation(u)),r.hasGutter&&d.appendChild(y(u)),u.to&&r.marked.push(e.markText(u.from,u.to,{className:"CodeMirror-lint-mark-"+f,__annotation:u}))}r.hasGutter&&e.setGutterMarker(a,g,function(t,e,n,i){var r=document.createElement("div"),o=r;return r.className="CodeMirror-lint-marker-"+e,n&&((o=r.appendChild(document.createElement("div"))).className="CodeMirror-lint-marker-multiple"),0!=i&&p.on(o,"mouseover",function(e){m(e,t,o)}),r}(d,c,1<l.length,r.options.tooltips))}}o.onUpdateLinting&&o.onUpdateLinting(t,s,e)}function c(e){var t=e.state.lint;t&&(clearTimeout(t.timeout),t.timeout=setTimeout(function(){a(e)},t.options.delay||500))}p.defineOption("lint",!1,function(e,t,n){if(n&&n!=p.Init&&(v(e),!1!==e.state.lint.options.lintOnChange&&e.off("change",c),p.off(e.getWrapperElement(),"mouseover",e.state.lint.onMouseOver),clearTimeout(e.state.lint.timeout),delete e.state.lint),t){for(var i=e.getOption("gutters"),r=!1,o=0;o<i.length;++o)i[o]==g&&(r=!0);t=e.state.lint=new s(e,(t=t)instanceof Function?{getAnnotations:t}:(t&&!0!==t||(t={}),t),r);!1!==t.options.lintOnChange&&e.on("change",c),0!=t.options.tooltips&&"gutter"!=t.options.tooltips&&p.on(e.getWrapperElement(),"mouseover",t.onMouseOver),a(e)}}),p.defineExtension("performLint",function(){this.state.lint&&a(this)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(r){"use strict";var m,v,y=r.Pos;function f(e,t){for(var n,i,n=null!=(i=(n=e).flags)?i:(n.ignoreCase?"i":"")+(n.global?"g":"")+(n.multiline?"m":""),r=n,o=0;o<t.length;o++)-1==r.indexOf(t.charAt(o))&&(r+=t.charAt(o));return n==r?e:new RegExp(e.source,r)}function p(e,t,n){t=f(t,"g");for(var i=n.line,r=n.ch,o=e.lastLine();i<=o;i++,r=0){t.lastIndex=r;var s=e.getLine(i),s=t.exec(s);if(s)return{from:y(i,s.index),to:y(i,s.index+s[0].length),match:s}}}function g(e,t){for(var n,i=0;;){t.lastIndex=i;var r=t.exec(e);if(!r)return n;if((i=(n=r).index+(n[0].length||1))==e.length)return n}}function _(e,t,n,i){if(e.length==t.length)return n;for(var r=0,o=n+Math.max(0,e.length-t.length);;){if(r==o)return r;var s=r+o>>1,a=i(e.slice(0,s)).length;if(a==n)return s;n<a?o=s:r=1+s}}function i(n,i,e,t){var r;this.atOccurrence=!1,this.doc=n,e=e?n.clipPos(e):y(0,0),this.pos={from:e,to:e},"object"==typeof t?r=t.caseFold:(r=t,t=null),"string"==typeof i?(null==r&&(r=!1),this.matches=function(e,t){return(e?function(e,t,n,i){if(!t.length)return null;var r=i?m:v,o=r(t).split(/\r|\n\r?/);e:for(var s=n.line,a=n.ch,l=e.firstLine()-1+o.length;l<=s;s--,a=-1){var c=e.getLine(s);-1<a&&(c=c.slice(0,a));var d=r(c);if(1==o.length){var h=d.lastIndexOf(o[0]);if(-1!=h)return{from:y(s,_(c,d,h,r)),to:y(s,_(c,d,h+o[0].length,r))}}else{var u=o[o.length-1];if(d.slice(0,u.length)==u){for(var f=1,n=s-o.length+1;f<o.length-1;f++)if(r(e.getLine(n+f))!=o[f])continue e;var p=e.getLine(s+1-o.length),h=r(p);if(h.slice(h.length-o[0].length)==o[0])return{from:y(s+1-o.length,_(p,h,p.length-o[0].length,r)),to:y(s,_(c,d,u.length,r))}}}}}:function(e,t,n,i){if(!t.length)return null;var r=i?m:v,o=r(t).split(/\r|\n\r?/);e:for(var s=n.line,a=n.ch,l=e.lastLine()+1-o.length;s<=l;s++,a=0){var c=e.getLine(s).slice(a),d=r(c);if(1==o.length){var h=d.indexOf(o[0]);if(-1!=h){n=_(c,d,h,r)+a;return{from:y(s,_(c,d,h,r)+a),to:y(s,_(c,d,h+o[0].length,r)+a)}}}else{var u=d.length-o[0].length;if(d.slice(u)==o[0]){for(var f=1;f<o.length-1;f++)if(r(e.getLine(s+f))!=o[f])continue e;var p=e.getLine(s+o.length-1),g=r(p),h=o[o.length-1];if(g.slice(0,h.length)==h)return{from:y(s,_(c,d,u,r)+a),to:y(s+o.length-1,_(p,g,h.length,r))}}}}})(n,i,t,r)}):(i=f(i,"gm"),t&&!1===t.multiline?this.matches=function(e,t){return(e?function(e,t,n){t=f(t,"g");for(var i=n.line,r=n.ch,o=e.firstLine();o<=i;i--,r=-1){var s=e.getLine(i);-1<r&&(s=s.slice(0,r));s=g(s,t);if(s)return{from:y(i,s.index),to:y(i,s.index+s[0].length),match:s}}}:p)(n,i,t)}:this.matches=function(e,t){return(e?function(e,t,n){t=f(t,"gm");for(var i=1,r=n.line,o=e.firstLine();o<=r;){for(var s=0;s<i;s++)var a=e.getLine(r--),l=null==l?a.slice(0,n.ch):a+"\n"+l;i*=2;var c=g(l,t);if(c){var d=l.slice(0,c.index).split("\n"),h=c[0].split("\n"),u=r+d.length,d=d[d.length-1].length;return{from:y(u,d),to:y(u+h.length-1,1==h.length?d+h[0].length:h[h.length-1].length),match:c}}}}:function(e,t,n){if(!/\\s|\\n|\n|\\W|\\D|\[\^/.test(t.source))return p(e,t,n);t=f(t,"gm");for(var i=1,r=n.line,o=e.lastLine();r<=o;){for(var s=0;s<i&&!(o<r);s++)var a=e.getLine(r++),l=null==l?a:l+"\n"+a;i*=2,t.lastIndex=n.ch;var c=t.exec(l);if(c){var d=l.slice(0,c.index).split("\n"),h=c[0].split("\n"),u=n.line+d.length-1,d=d[d.length-1].length;return{from:y(u,d),to:y(u+h.length-1,1==h.length?d+h[0].length:h[h.length-1].length),match:c}}}})(n,i,t)})}v=String.prototype.normalize?(m=function(e){return e.normalize("NFD").toLowerCase()},function(e){return e.normalize("NFD")}):(m=function(e){return e.toLowerCase()},function(e){return e}),i.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){for(var t=this.matches(e,this.doc.clipPos(e?this.pos.from:this.pos.to));t&&0==r.cmpPos(t.from,t.to);)e?t.from.ch?t.from=y(t.from.line,t.from.ch-1):t=t.from.line==this.doc.firstLine()?null:this.matches(e,this.doc.clipPos(y(t.from.line-1))):t.to.ch<this.doc.getLine(t.to.line).length?t.to=y(t.to.line,t.to.ch+1):t=t.to.line==this.doc.lastLine()?null:this.matches(e,y(t.to.line+1,0));if(t)return this.pos=t,this.atOccurrence=!0,this.pos.match||!0;var n=y(e?this.doc.firstLine():this.doc.lastLine()+1,0);return this.pos={from:n,to:n},this.atOccurrence=!1},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(e,t){this.atOccurrence&&(e=r.splitLines(e),this.doc.replaceRange(e,this.pos.from,this.pos.to,t),this.pos.to=y(this.pos.from.line+e.length-1,e[e.length-1].length+(1==e.length?this.pos.from.ch:0)))}},r.defineExtension("getSearchCursor",function(e,t,n){return new i(this.doc,e,t,n)}),r.defineDocExtension("getSearchCursor",function(e,t,n){return new i(this,e,t,n)}),r.defineExtension("selectMatches",function(e,t){for(var n=[],i=this.getSearchCursor(e,this.getCursor("from"),t);i.findNext()&&!(0<r.cmpPos(i.to(),this.getCursor("to")));)n.push({anchor:i.from(),head:i.to()});n.length&&this.setSelections(n,0)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(i){function r(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function o(e){r(e);var t=e.state.placeholder=document.createElement("pre");t.style.cssText="height: 0; overflow: visible",t.style.direction=e.getOption("direction"),t.className="CodeMirror-placeholder";var n=e.getOption("placeholder");"string"==typeof n&&(n=document.createTextNode(n)),t.appendChild(n),e.display.lineSpace.insertBefore(t,e.display.lineSpace.firstChild)}function s(e){l(e)&&o(e)}function a(e){var t=e.getWrapperElement(),n=l(e);t.className=t.className.replace(" CodeMirror-empty","")+(n?" CodeMirror-empty":""),(n?o:r)(e)}function l(e){return 1===e.lineCount()&&""===e.getLine(0)}i.defineOption("placeholder","",function(e,t,n){n=n&&n!=i.Init;t&&!n?(e.on("blur",s),e.on("change",a),e.on("swapDoc",a),a(e)):!t&&n&&(e.off("blur",s),e.off("change",a),e.off("swapDoc",a),r(e),(n=e.getWrapperElement()).className=n.className.replace(" CodeMirror-empty","")),t&&!e.hasFocus()&&s(e)})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(i){"use strict";var s="CodeMirror-activeline",a="CodeMirror-activeline-background",l="CodeMirror-activeline-gutter";function c(e){for(var t=0;t<e.state.activeLines.length;t++)e.removeLineClass(e.state.activeLines[t],"wrap",s),e.removeLineClass(e.state.activeLines[t],"background",a),e.removeLineClass(e.state.activeLines[t],"gutter",l)}function r(t,e){for(var n=[],i=0;i<e.length;i++){var r=e[i],o=t.getOption("styleActiveLine");("object"==typeof o&&o.nonEmpty?r.anchor.line==r.head.line:r.empty())&&(r=t.getLineHandleVisualStart(r.head.line),n[n.length-1]!=r&&n.push(r))}!function(e,t){if(e.length==t.length){for(var n=0;n<e.length;n++)if(e[n]!=t[n])return;return 1}}(t.state.activeLines,n)&&t.operation(function(){c(t);for(var e=0;e<n.length;e++)t.addLineClass(n[e],"wrap",s),t.addLineClass(n[e],"background",a),t.addLineClass(n[e],"gutter",l);t.state.activeLines=n})}function o(e,t){r(e,t.ranges)}i.defineOption("styleActiveLine",!1,function(e,t,n){n=n!=i.Init&&n;t!=n&&(n&&(e.off("beforeSelectionChange",o),c(e),delete e.state.activeLines),t&&(e.state.activeLines=[],r(e,e.listSelections()),e.on("beforeSelectionChange",o)))})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof module&&module.exports?module.exports=e(require("jquery")):e(jQuery)}(function(O,E){"use strict";if(!O.jstree){var r=0,o=!1,s=!1,a=!1,n=[],e=O("script:last").attr("src"),x=window.document,c=window.setImmediate,i=window.Promise;!c&&i&&(c=function(e,t){i.resolve(t).then(e)}),O.jstree={version:"3.3.11",defaults:{plugins:[]},plugins:{},path:e&&-1!==e.indexOf("/")?e.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},O.jstree.create=function(e,n){var i=new O.jstree.core(++r),t=n;return n=O.extend(!0,{},O.jstree.defaults,n),t&&t.plugins&&(n.plugins=t.plugins),O.each(n.plugins,function(e,t){"core"!==e&&(i=i.plugin(t,n[t]))}),O(e).data("jstree",i),i.init(e,n),i},O.jstree.destroy=function(){O(".jstree:jstree").jstree("destroy"),O(x).off(".jstree")},O.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},O.jstree.reference=function(t){var n=null,e=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!e||!e.length)try{e=O(t)}catch(e){}if(!e||!e.length)try{e=O("#"+t.replace(O.jstree.idregex,"\\$&"))}catch(e){}return e&&e.length&&(e=e.closest(".jstree")).length&&(e=e.data("jstree"))?n=e:O(".jstree").each(function(){var e=O(this).data("jstree");return e&&e._model.data[t]?(n=e,!1):void 0}),n},O.fn.jstree=function(n){var i="string"==typeof n,r=Array.prototype.slice.call(arguments,1),o=null;return!(!0===n&&!this.length)&&(this.each(function(){var e=O.jstree.reference(this),t=i&&e?e[n]:null;return o=i&&t?t.apply(e,r):null,e||i||n!==E&&!O.isPlainObject(n)||O.jstree.create(this,n),(e&&!i||!0===n)&&(o=e||!1),(null===o||o===E)&&void 0}),null!==o&&o!==E?o:this)},O.expr.pseudos.jstree=O.expr.createPseudo(function(e){return function(e){return O(e).hasClass("jstree")&&O(e).data("jstree")!==E}}),O.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:O.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0,loaded_state:!1,restore_focus:!0,compute_elements_positions:!1,keyboard:{"ctrl-space":function(e){e.type="click",O(e.currentTarget).trigger(e)},enter:function(e){e.type="click",O(e.currentTarget).trigger(e)},left:function(e){e.preventDefault(),this.is_open(e.currentTarget)?this.close_node(e.currentTarget):(e=this.get_parent(e.currentTarget))&&e.id!==O.jstree.root&&this.get_node(e,!0).children(".jstree-anchor").focus()},up:function(e){e.preventDefault();e=this.get_prev_dom(e.currentTarget);e&&e.length&&e.children(".jstree-anchor").focus()},right:function(e){e.preventDefault(),this.is_closed(e.currentTarget)?this.open_node(e.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):!this.is_open(e.currentTarget)||(e=this.get_node(e.currentTarget,!0).children(".jstree-children")[0])&&O(this._firstChild(e)).children(".jstree-anchor").focus()},down:function(e){e.preventDefault();e=this.get_next_dom(e.currentTarget);e&&e.length&&e.children(".jstree-anchor").focus()},"*":function(e){this.open_all()},home:function(e){e.preventDefault();e=this._firstChild(this.get_container_ul()[0]);e&&O(e).children(".jstree-anchor").filter(":visible").focus()},end:function(e){e.preventDefault(),this.element.find(".jstree-anchor").filter(":visible").last().focus()},f2:function(e){e.preventDefault(),this.edit(e.currentTarget)}}},O.jstree.core.prototype={plugin:function(e,t){var n=O.jstree.plugins[e];return n?(this._data[e]={},n.prototype=this,new n(t,this)):this},init:function(e,t){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this._model.data[O.jstree.root]={id:O.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this.element=O(e).addClass("jstree jstree-"+this._id),this.settings=t,this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0),this.element.attr("tabindex")||this.element.attr("tabindex","0"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"),this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24,this._data.core.node=this._create_prototype_node(),this.trigger("loading"),this.load_node(O.jstree.root)},destroy:function(e){if(this.trigger("destroy"),this._wrk)try{window.URL.revokeObjectURL(this._wrk),this._wrk=null}catch(e){}e||this.element.empty(),this.teardown()},_create_prototype_node:function(){var e,t,n=x.createElement("LI");return n.setAttribute("role","none"),(e=x.createElement("I")).className="jstree-icon jstree-ocl",e.setAttribute("role","presentation"),n.appendChild(e),(e=x.createElement("A")).className="jstree-anchor",e.setAttribute("href","#"),e.setAttribute("tabindex","-1"),e.setAttribute("role","treeitem"),(t=x.createElement("I")).className="jstree-icon jstree-themeicon",t.setAttribute("role","presentation"),e.appendChild(t),n.appendChild(e),e=t=null,n},_kbevent_to_func:function(e){var t=[];if(e.ctrlKey&&t.push("ctrl"),e.altKey&&t.push("alt"),e.shiftKey&&t.push("shift"),t.push({8:"Backspace",9:"Tab",13:"Enter",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"}[e.which]||e.which),"shift-shift"===(t=t.sort().join("-").toLowerCase())||"ctrl-ctrl"===t||"alt-alt"===t)return null;var n,i,r=this.settings.core.keyboard;for(n in r)if(r.hasOwnProperty(n)&&(i=n,"-"!==i&&"+"!==i&&(i=i.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS"),i=i.split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase()),i===t))return r[n];return null},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){var r="",o=null,t=0;this.element.on("dblclick.jstree",function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;if(x.selection&&x.selection.empty)x.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges(),t.collapse()}catch(e){}}}).on("mousedown.jstree",O.proxy(function(e){e.target===this.element[0]&&(e.preventDefault(),t=+new Date)},this)).on("mousedown.jstree",".jstree-ocl",function(e){e.preventDefault()}).on("click.jstree",".jstree-ocl",O.proxy(function(e){this.toggle_node(e.target)},this)).on("dblclick.jstree",".jstree-anchor",O.proxy(function(e){return!(!e.target.tagName||"input"!==e.target.tagName.toLowerCase())||void(this.settings.core.dblclick_toggle&&this.toggle_node(e.target))},this)).on("click.jstree",".jstree-anchor",O.proxy(function(e){e.preventDefault(),e.currentTarget!==x.activeElement&&O(e.currentTarget).focus(),this.activate_node(e.currentTarget,e)},this)).on("keydown.jstree",".jstree-anchor",O.proxy(function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;this._data.core.rtl&&(37===e.which?e.which=39:39===e.which&&(e.which=37));var t=this._kbevent_to_func(e);if(t){e=t.call(this,e);if(!1===e||!0===e)return e}},this)).on("load_node.jstree",O.proxy(function(e,t){t.status&&(t.node.id!==O.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(O.proxy(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){for(var e=[],t=0,n=this._data.core.selected.length;t<n;t++)e=e.concat(this._model.data[this._data.core.selected[t]].parents);for(t=0,n=(e=O.vakata.array_unique(e)).length;t<n;t++)this.open_node(e[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}},this),0))},this)).on("keypress.jstree",O.proxy(function(e){if(e.target.tagName&&"input"===e.target.tagName.toLowerCase())return!0;o&&clearTimeout(o),o=setTimeout(function(){r=""},500);var n=String.fromCharCode(e.which).toLowerCase(),t=this.element.find(".jstree-anchor").filter(":visible"),e=t.index(x.activeElement)||0,i=!1;if(1<(r+=n).length){if(t.slice(e).each(O.proxy(function(e,t){return 0===O(t).text().toLowerCase().indexOf(r)?(O(t).focus(),!(i=!0)):void 0},this)),i)return;if(t.slice(0,e).each(O.proxy(function(e,t){return 0===O(t).text().toLowerCase().indexOf(r)?(O(t).focus(),!(i=!0)):void 0},this)),i)return}new RegExp("^"+n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(r)&&(t.slice(e+1).each(O.proxy(function(e,t){return O(t).text().toLowerCase().charAt(0)===n?(O(t).focus(),!(i=!0)):void 0},this)),i||t.slice(0,e+1).each(O.proxy(function(e,t){return O(t).text().toLowerCase().charAt(0)===n?(O(t).focus(),!(i=!0)):void 0},this)))},this)).on("init.jstree",O.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this._data.core.themes.ellipsis=e.ellipsis,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",O.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"](),this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()},this)).on("blur.jstree",".jstree-anchor",O.proxy(function(e){this._data.core.focused=null,O(e.currentTarget).filter(".jstree-hovered").trigger("mouseleave"),this.element.attr("tabindex","0")},this)).on("focus.jstree",".jstree-anchor",O.proxy(function(e){var t=this.get_node(e.currentTarget);t&&t.id&&(this._data.core.focused=t.id),this.element.find(".jstree-hovered").not(e.currentTarget).trigger("mouseleave"),O(e.currentTarget).trigger("mouseenter"),this.element.attr("tabindex","-1")},this)).on("focus.jstree",O.proxy(function(){var e;500<+new Date-t&&!this._data.core.focused&&this.settings.core.restore_focus&&(t=0,(e=this.get_node(this.element.attr("aria-activedescendant"),!0))&&e.find("> .jstree-anchor").focus())},this)).on("mouseenter.jstree",".jstree-anchor",O.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",O.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),O(x).off(".jstree-"+this._id)},trigger:function(e,t){((t=t||{}).instance=this).element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(e){var t=this.settings.core.strings;return O.isFunction(t)?t.call(this,e):t&&t[e]?t[e]:e},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(e,t){var n;e&&e.id&&(e=e.id),e instanceof O&&e.length&&e[0].id&&(e=e[0].id);try{if(this._model.data[e])e=this._model.data[e];else if("string"==typeof e&&this._model.data[e.replace(/^#/,"")])e=this._model.data[e.replace(/^#/,"")];else if("string"==typeof e&&(n=O("#"+e.replace(O.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[n.closest(".jstree-node").attr("id")])e=this._model.data[n.closest(".jstree-node").attr("id")];else if((n=this.element.find(e)).length&&this._model.data[n.closest(".jstree-node").attr("id")])e=this._model.data[n.closest(".jstree-node").attr("id")];else{if(!(n=this.element.find(e)).length||!n.hasClass("jstree"))return!1;e=this._model.data[O.jstree.root]}return t&&(e=e.id===O.jstree.root?this.element:O("#"+e.id.replace(O.jstree.idregex,"\\$&"),this.element)),e}catch(e){return!1}},get_path:function(e,t,n){if(!(e=e.parents?e:this.get_node(e))||e.id===O.jstree.root||!e.parents)return!1;var i,r,o=[];for(o.push(n?e.id:e.text),i=0,r=e.parents.length;i<r;i++)o.push(n?e.parents[i]:this.get_text(e.parents[i]));return o=o.reverse().slice(1),t?o.join(t):o},get_next_dom:function(e,t){var n;if((e=this.get_node(e,!0))[0]===this.element[0]){for(n=this._firstChild(this.get_container_ul()[0]);n&&0===n.offsetHeight;)n=this._nextSibling(n);return!!n&&O(n)}if(!e||!e.length)return!1;if(t){for(n=e[0];n=this._nextSibling(n),n&&0===n.offsetHeight;);return!!n&&O(n)}if(e.hasClass("jstree-open")){for(n=this._firstChild(e.children(".jstree-children")[0]);n&&0===n.offsetHeight;)n=this._nextSibling(n);if(null!==n)return O(n)}for(n=e[0];n=this._nextSibling(n),n&&0===n.offsetHeight;);return null!==n?O(n):e.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(e,t){var n;if((e=this.get_node(e,!0))[0]===this.element[0]){for(n=this.get_container_ul()[0].lastChild;n&&0===n.offsetHeight;)n=this._previousSibling(n);return!!n&&O(n)}if(!e||!e.length)return!1;if(t){for(n=e[0];n=this._previousSibling(n),n&&0===n.offsetHeight;);return!!n&&O(n)}for(n=e[0];n=this._previousSibling(n),n&&0===n.offsetHeight;);if(null===n)return!(!(n=e[0].parentNode.parentNode)||!n.className||-1===n.className.indexOf("jstree-node"))&&O(n);for(e=O(n);e.hasClass("jstree-open");)e=e.children(".jstree-children").first().children(".jstree-node:visible:last");return e},get_parent:function(e){return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&e.parent},get_children_dom:function(e){return(e=this.get_node(e,!0))[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):!(!e||!e.length)&&e.children(".jstree-children").children(".jstree-node")},is_parent:function(e){return(e=this.get_node(e))&&(!1===e.state.loaded||0<e.children.length)},is_loaded:function(e){return(e=this.get_node(e))&&e.state.loaded},is_loading:function(e){return(e=this.get_node(e))&&e.state&&e.state.loading},is_open:function(e){return(e=this.get_node(e))&&e.state.opened},is_closed:function(e){return(e=this.get_node(e))&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(s,a){var e,t,n,i,r;if(O.isArray(s))return this._load_nodes(s.slice(),a),!0;if(!(s=this.get_node(s)))return a&&a.call(this,s,!1),!1;if(s.state.loaded){for(s.state.loaded=!1,n=0,i=s.parents.length;n<i;n++)this._model.data[s.parents[n]].children_d=O.vakata.array_filter(this._model.data[s.parents[n]].children_d,function(e){return-1===O.inArray(e,s.children_d)});for(e=0,t=s.children_d.length;e<t;e++)this._model.data[s.children_d[e]].state.selected&&(r=!0),delete this._model.data[s.children_d[e]];r&&(this._data.core.selected=O.vakata.array_filter(this._data.core.selected,function(e){return-1===O.inArray(e,s.children_d)})),s.children=[],s.children_d=[],r&&this.trigger("changed",{action:"load_node",node:s,selected:this._data.core.selected})}return s.state.failed=!1,s.state.loading=!0,this.get_node(s,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(s,O.proxy(function(e){(s=this._model.data[s.id]).state.loading=!1,s.state.loaded=e,s.state.failed=!s.state.loaded;for(var t=this.get_node(s,!0),n=0,i=this._model.data,r=!1,n=0,o=s.children.length;n<o;n++)if(i[s.children[n]]&&!i[s.children[n]].state.hidden){r=!0;break}s.state.loaded&&t&&t.length&&(t.removeClass("jstree-closed jstree-open jstree-leaf"),r?"#"!==s.id&&t.addClass(s.state.opened?"jstree-open":"jstree-closed"):t.addClass("jstree-leaf")),t.removeClass("jstree-loading").attr("aria-busy",!1),this.trigger("load_node",{node:s,status:e}),a&&a.call(this,s,e)},this)),!0},_load_nodes:function(e,t,n,i){for(var r=!0,o=function(){this._load_nodes(e,t,!0)},s=this._model.data,a=[],l=0,c=e.length;l<c;l++)s[e[l]]&&(!s[e[l]].state.loaded&&!s[e[l]].state.failed||!n&&i)&&(this.is_loading(e[l])||this.load_node(e[l],o),r=!1);if(r){for(l=0,c=e.length;l<c;l++)s[e[l]]&&s[e[l]].state.loaded&&a.push(e[l]);t&&!t.done&&(t.call(this,a),t.done=!0)}},load_all:function(e,t){if(e=e||O.jstree.root,!(e=this.get_node(e)))return!1;var n,i,r=[],o=this._model.data,s=o[e.id].children_d;for(e.state&&!e.state.loaded&&r.push(e.id),n=0,i=s.length;n<i;n++)o[s[n]]&&o[s[n]].state&&!o[s[n]].state.loaded&&r.push(s[n]);r.length?this._load_nodes(r,function(){this.load_all(e,t)}):(t&&t.call(this,e),this.trigger("load_all",{node:e}))},_load_node:function(r,o){function s(){return 3!==this.nodeType&&8!==this.nodeType}var e,t=this.settings.core.data;return t?O.isFunction(t)?t.call(this,r,O.proxy(function(e){!1===e?o.call(this,!1):this["string"==typeof e?"_append_html_data":"_append_json_data"](r,"string"==typeof e?O(O.parseHTML(e)).filter(s):e,function(e){o.call(this,e)})},this)):"object"==typeof t?t.url?(t=O.extend(!0,{},t),O.isFunction(t.url)&&(t.url=t.url.call(this,r)),O.isFunction(t.data)&&(t.data=t.data.call(this,r)),O.ajax(t).done(O.proxy(function(e,t,n){var i=n.getResponseHeader("Content-Type");return i&&-1!==i.indexOf("json")||"object"==typeof e?this._append_json_data(r,e,function(e){o.call(this,e)}):i&&-1!==i.indexOf("html")||"string"==typeof e?this._append_html_data(r,O(O.parseHTML(e)).filter(s),function(e){o.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:r.id,xhr:n})},this.settings.core.error.call(this,this._data.core.last_error),o.call(this,!1))},this)).fail(O.proxy(function(e){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:r.id,xhr:e})},o.call(this,!1),this.settings.core.error.call(this,this._data.core.last_error)},this))):(e=O.isArray(t)?O.extend(!0,[],t):O.isPlainObject(t)?O.extend(!0,{},t):t,r.id===O.jstree.root?this._append_json_data(r,e,function(e){o.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:r.id})},this.settings.core.error.call(this,this._data.core.last_error),o.call(this,!1))):"string"==typeof t?r.id===O.jstree.root?this._append_html_data(r,O(O.parseHTML(t)).filter(s),function(e){o.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:r.id})},this.settings.core.error.call(this,this._data.core.last_error),o.call(this,!1)):o.call(this,!1):r.id===O.jstree.root?this._append_html_data(r,this._data.core.original_container_html.clone(!0),function(e){o.call(this,e)}):o.call(this,!1)},_node_changed:function(e){(e=this.get_node(e))&&-1===O.inArray(e.id,this._model.changed)&&this._model.changed.push(e.id)},_append_html_data:function(e,t,n){(e=this.get_node(e)).children=[],e.children_d=[];var i,r,o,t=t.is("ul")?t.children():t,s=e.id,a=[],l=[],c=this._model.data,d=c[s],e=this._data.core.selected.length;for(t.each(O.proxy(function(e,t){(i=this._parse_model_from_html(O(t),s,d.parents.concat()))&&(a.push(i),l.push(i),c[i].children_d.length&&(l=l.concat(c[i].children_d)))},this)),d.children=a,d.children_d=l,r=0,o=d.parents.length;r<o;r++)c[d.parents[r]].children_d=c[d.parents[r]].children_d.concat(l);this.trigger("model",{nodes:l,parent:s}),s!==O.jstree.root?(this._node_changed(s),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==e&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),n.call(this,!0)},_append_json_data:function(e,t,l,n){if(null!==this.element){(e=this.get_node(e)).children=[],e.children_d=[],t.d&&("string"==typeof(t=t.d)&&(t=JSON.parse(t))),O.isArray(t)||(t=[t]);var i=null,r={df:this._model.default_state,dat:t,par:e.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},y=this,o=function(e,c){e.data&&(e=e.data);var t,n,i,r,o=e.dat,s=e.par,a=[],l=[],d=[],h=e.df,u=e.t_id,f=e.t_cnt,p=e.m,g=p[s],e=e.sel,m=function(e,t,n){n=n?n.concat():[],t&&n.unshift(t);var i,r,o,s,a=e.id.toString(),l={id:a,text:e.text||"",icon:e.icon===c||e.icon,parent:t,parents:n,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in h)h.hasOwnProperty(i)&&(l.state[i]=h[i]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(l.icon=e.data.jstree.icon),l.icon!==c&&null!==l.icon&&""!==l.icon||(l.icon=!0),e&&e.data&&(l.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(l.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(l.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(l.li_attr[i]=e.li_attr[i]);if(l.li_attr.id||(l.li_attr.id=a),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(l.a_attr[i]=e.a_attr[i]);for(e&&e.children&&!0===e.children&&(l.state.loaded=!1,l.children=[],l.children_d=[]),i=0,r=(p[l.id]=l).children.length;i<r;i++)o=m(p[l.children[i]],l.id,n),s=p[o],l.children_d.push(o),s.children_d.length&&(l.children_d=l.children_d.concat(s.children_d));return delete e.data,delete e.children,p[l.id].original=e,l.state.selected&&d.push(l.id),l.id},v=function(e,t,n){n=n?n.concat():[],t&&n.unshift(t);for(var i,r,o,s,a,l=!1;l="j"+u+"_"+ ++f,p[l];);for(i in a={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===c||e.icon,parent:t,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},h)h.hasOwnProperty(i)&&(a.state[i]=h[i]);if(e&&e.id&&(a.id=e.id.toString()),e&&e.text&&(a.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(a.icon=e.data.jstree.icon),a.icon!==c&&null!==a.icon&&""!==a.icon||(a.icon=!0),e&&e.data&&(a.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(a.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(a.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(a.li_attr[i]=e.li_attr[i]);if(a.li_attr.id&&!a.id&&(a.id=a.li_attr.id.toString()),a.id||(a.id=l),a.li_attr.id||(a.li_attr.id=a.id),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(a.a_attr[i]=e.a_attr[i]);if(e&&e.children&&e.children.length){for(i=0,r=e.children.length;i<r;i++)o=v(e.children[i],a.id,n),s=p[o],a.children.push(o),s.children_d.length&&(a.children_d=a.children_d.concat(s.children_d));a.children_d=a.children_d.concat(a.children)}return e&&e.children&&!0===e.children&&(a.state.loaded=!1,a.children=[],a.children_d=[]),delete e.data,delete e.children,a.original=e,(p[a.id]=a).state.selected&&d.push(a.id),a.id};if(o.length&&o[0].id!==c&&o[0].parent!==c){for(n=0,i=o.length;n<i;n++)o[n].children||(o[n].children=[]),o[n].state||(o[n].state={}),p[o[n].id.toString()]=o[n];for(n=0,i=o.length;n<i;n++)p[o[n].parent.toString()]?(p[o[n].parent.toString()].children.push(o[n].id.toString()),g.children_d.push(o[n].id.toString())):void 0!==y&&(y._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:o[n].id.toString(),parent:o[n].parent.toString()})},y.settings.core.error.call(y,y._data.core.last_error));for(n=0,i=g.children.length;n<i;n++)t=m(p[g.children[n]],s,g.parents.concat()),l.push(t),p[t].children_d.length&&(l=l.concat(p[t].children_d));for(n=0,i=g.parents.length;n<i;n++)p[g.parents[n]].children_d=p[g.parents[n]].children_d.concat(l);r={cnt:f,mod:p,sel:e,par:s,dpc:l,add:d}}else{for(n=0,i=o.length;n<i;n++)(t=v(o[n],s,g.parents.concat()))&&(a.push(t),l.push(t),p[t].children_d.length&&(l=l.concat(p[t].children_d)));for(g.children=a,g.children_d=l,n=0,i=g.parents.length;n<i;n++)p[g.parents[n]].children_d=p[g.parents[n]].children_d.concat(l);r={cnt:f,mod:p,sel:e,par:s,dpc:l,add:d}}return"undefined"!=typeof window&&void 0!==window.document?r:void postMessage(r)},s=function(e,t){if(null!==this.element){for(var n in this._cnt=e.cnt,a=this._model.data)a.hasOwnProperty(n)&&a[n].state&&a[n].state.loading&&e.mod[n]&&(e.mod[n].state.loading=!0);if(this._model.data=e.mod,t){var i,r=e.add,o=e.sel,s=this._data.core.selected.slice(),a=this._model.data;if(o.length!==s.length||O.vakata.array_unique(o.concat(s)).length!==o.length){for(n=0,i=o.length;n<i;n++)-1===O.inArray(o[n],r)&&-1===O.inArray(o[n],s)&&(a[o[n]].state.selected=!1);for(n=0,i=s.length;n<i;n++)-1===O.inArray(s[n],o)&&(a[s[n]].state.selected=!0)}}e.add.length&&(this._data.core.selected=this._data.core.selected.concat(e.add)),this.trigger("model",{nodes:e.dpc,parent:e.par}),e.par!==O.jstree.root?(this._node_changed(e.par),this.redraw()):this.redraw(!0),e.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),!t&&c?c(function(){l.call(y,!0)}):l.call(y,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+o.toString()],{type:"text/javascript"}))),!this._data.core.working||n?(this._data.core.working=!0,(i=new window.Worker(this._wrk)).onmessage=O.proxy(function(e){s.call(this,e.data,!0);try{i.terminate(),i=null}catch(e){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1},this),r.par?i.postMessage(r):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([e,t,l,!0])}catch(e){s.call(this,o(r),!1),this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else s.call(this,o(r),!1)}},_parse_model_from_html:function(e,t,n){n=n?[].concat(n):[],t&&n.unshift(t);var i,r,o,s,a=this._model.data,l={id:!1,text:!1,icon:!0,parent:t,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in this._model.default_state)this._model.default_state.hasOwnProperty(o)&&(l.state[o]=this._model.default_state[o]);if(t=O.vakata.attributes(e,!0),O.each(t,function(e,t){return!(t=O.vakata.trim(t)).length||(l.li_attr[e]=t,void("id"===e&&(l.id=t.toString())))}),(t=e.children("a").first()).length&&(t=O.vakata.attributes(t,!0),O.each(t,function(e,t){(t=O.vakata.trim(t)).length&&(l.a_attr[e]=t)})),(t=(e.children("a").first().length?e.children("a").first():e).clone()).children("ins, i, ul").remove(),t=t.html(),t=O("<div></div>").html(t),l.text=this.settings.core.force_text?t.text():t.html(),t=e.data(),l.data=t?O.extend(!0,{},t):null,l.state.opened=e.hasClass("jstree-open"),l.state.selected=e.children("a").hasClass("jstree-clicked"),l.state.disabled=e.children("a").hasClass("jstree-disabled"),l.data&&l.data.jstree)for(o in l.data.jstree)l.data.jstree.hasOwnProperty(o)&&(l.state[o]=l.data.jstree[o]);for(t=e.children("a").children(".jstree-themeicon"),t.length&&(l.icon=!t.hasClass("jstree-themeicon-hidden")&&t.attr("rel")),l.state.icon!==E&&(l.icon=l.state.icon),l.icon!==E&&null!==l.icon&&""!==l.icon||(l.icon=!0),t=e.children("ul").children("li");s="j"+this._id+"_"+ ++this._cnt,a[s];);return l.id=l.li_attr.id?l.li_attr.id.toString():s,t.length?(t.each(O.proxy(function(e,t){i=this._parse_model_from_html(O(t),l.id,n),r=this._model.data[i],l.children.push(i),r.children_d.length&&(l.children_d=l.children_d.concat(r.children_d))},this)),l.children_d=l.children_d.concat(l.children)):e.hasClass("jstree-closed")&&(l.state.loaded=!1),l.li_attr.class&&(l.li_attr.class=l.li_attr.class.replace("jstree-closed","").replace("jstree-open","")),l.a_attr.class&&(l.a_attr.class=l.a_attr.class.replace("jstree-clicked","").replace("jstree-disabled","")),(a[l.id]=l).state.selected&&this._data.core.selected.push(l.id),l.id},_parse_model_from_flat_json:function(e,t,n){n=n?n.concat():[],t&&n.unshift(t);var i,r,o,s,a=e.id.toString(),l=this._model.data,c=this._model.default_state,d={id:a,text:e.text||"",icon:e.icon===E||e.icon,parent:t,parents:n,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(i in c)c.hasOwnProperty(i)&&(d.state[i]=c[i]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),d.icon!==E&&null!==d.icon&&""!==d.icon||(d.icon=!0),e&&e.data&&(d.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(d.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(d.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(d.li_attr[i]=e.li_attr[i]);if(d.li_attr.id||(d.li_attr.id=a),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(d.a_attr[i]=e.a_attr[i]);for(e&&e.children&&!0===e.children&&(d.state.loaded=!1,d.children=[],d.children_d=[]),i=0,r=(l[d.id]=d).children.length;i<r;i++)s=l[o=this._parse_model_from_flat_json(l[d.children[i]],d.id,n)],d.children_d.push(o),s.children_d.length&&(d.children_d=d.children_d.concat(s.children_d));return delete e.data,delete e.children,l[d.id].original=e,d.state.selected&&this._data.core.selected.push(d.id),d.id},_parse_model_from_json:function(e,t,n){n=n?n.concat():[],t&&n.unshift(t);for(var i,r,o,s,a,l=!1,c=this._model.data,d=this._model.default_state;l="j"+this._id+"_"+ ++this._cnt,c[l];);for(i in a={id:!1,text:"string"==typeof e?e:"",icon:"object"!=typeof e||e.icon===E||e.icon,parent:t,parents:n,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},d)d.hasOwnProperty(i)&&(a.state[i]=d[i]);if(e&&e.id&&(a.id=e.id.toString()),e&&e.text&&(a.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(a.icon=e.data.jstree.icon),a.icon!==E&&null!==a.icon&&""!==a.icon||(a.icon=!0),e&&e.data&&(a.data=e.data,e.data.jstree))for(i in e.data.jstree)e.data.jstree.hasOwnProperty(i)&&(a.state[i]=e.data.jstree[i]);if(e&&"object"==typeof e.state)for(i in e.state)e.state.hasOwnProperty(i)&&(a.state[i]=e.state[i]);if(e&&"object"==typeof e.li_attr)for(i in e.li_attr)e.li_attr.hasOwnProperty(i)&&(a.li_attr[i]=e.li_attr[i]);if(a.li_attr.id&&!a.id&&(a.id=a.li_attr.id.toString()),a.id||(a.id=l),a.li_attr.id||(a.li_attr.id=a.id),e&&"object"==typeof e.a_attr)for(i in e.a_attr)e.a_attr.hasOwnProperty(i)&&(a.a_attr[i]=e.a_attr[i]);if(e&&e.children&&e.children.length){for(i=0,r=e.children.length;i<r;i++)s=c[o=this._parse_model_from_json(e.children[i],a.id,n)],a.children.push(o),s.children_d.length&&(a.children_d=a.children_d.concat(s.children_d));a.children_d=a.children.concat(a.children_d)}return e&&e.children&&!0===e.children&&(a.state.loaded=!1,a.children=[],a.children_d=[]),delete e.data,delete e.children,a.original=e,(c[a.id]=a).state.selected&&this._data.core.selected.push(a.id),a.id},_redraw:function(){for(var e,t=(this._model.force_full_redraw?this._model.data[O.jstree.root].children:this._model.changed).concat([]),n=x.createElement("UL"),i=this._data.core.focused,r=0,o=t.length;r<o;r++)(e=this.redraw_node(t[r],!0,this._model.force_full_redraw))&&this._model.force_full_redraw&&n.appendChild(e);this._model.force_full_redraw&&(n.className=this.get_container_ul()[0].className,n.setAttribute("role","group"),this.element.empty().append(n)),null!==i&&this.settings.core.restore_focus&&((e=this.get_node(i,!0))&&e.length&&e.children(".jstree-anchor")[0]!==x.activeElement?e.children(".jstree-anchor").focus():this._data.core.focused=null),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:t})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},draw_children:function(e){var t,n=this.get_node(e),i=!1,r=!1,o=x;if(!n)return!1;if(n.id===O.jstree.root)return this.redraw(!0);if(!(e=this.get_node(e,!0))||!e.length)return!1;if(e.children(".jstree-children").remove(),e=e[0],n.children.length&&n.state.loaded){for((r=o.createElement("UL")).setAttribute("role","group"),r.className="jstree-children",i=0,t=n.children.length;i<t;i++)r.appendChild(this.redraw_node(n.children[i],!0,!0));e.appendChild(r)}},redraw_node:function(e,t,n,i){var r,o,s=this.get_node(e),a=!1,l=!1,c=!1,d=!1,h=!1,u=!1,f="",p=x,g=this._model.data,m=!1,v=null,y=!1,_=!1;if(!s)return!1;if(s.id===O.jstree.root)return this.redraw(!0);if(t=t||0===s.children.length,e=x.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(s.id[0])?"\\3"+s.id[0]+" "+s.id.substr(1).replace(O.jstree.idregex,"\\$&"):s.id.replace(O.jstree.idregex,"\\$&"))):x.getElementById(s.id))e=O(e),n||((a=e.parent().parent()[0])===this.element[0]&&(a=null),l=e.index()),t||!s.children.length||e.children(".jstree-children").length||(t=!0),t||(c=e.children(".jstree-children")[0]),m=e.children(".jstree-anchor")[0]===x.activeElement,e.remove();else if(t=!0,!n){if(!(null===(a=s.parent!==O.jstree.root?O("#"+s.parent.replace(O.jstree.idregex,"\\$&"),this.element)[0]:null)||a&&g[s.parent].state.opened))return!1;l=O.inArray(s.id,(null===a?g[O.jstree.root]:g[s.parent]).children)}for(d in e=this._data.core.node.cloneNode(!0),f="jstree-node ",s.li_attr)if(s.li_attr.hasOwnProperty(d)){if("id"===d)continue;"class"!==d?e.setAttribute(d,s.li_attr[d]):f+=s.li_attr[d]}for(s.a_attr.id||(s.a_attr.id=s.id+"_anchor"),e.childNodes[1].setAttribute("aria-selected",!!s.state.selected),e.childNodes[1].setAttribute("aria-level",s.parents.length),this.settings.core.compute_elements_positions&&(e.childNodes[1].setAttribute("aria-setsize",g[s.parent].children.length),e.childNodes[1].setAttribute("aria-posinset",g[s.parent].children.indexOf(s.id)+1)),s.state.disabled&&e.childNodes[1].setAttribute("aria-disabled",!0),d=0,h=s.children.length;d<h;d++)if(!g[s.children[d]].state.hidden){y=!0;break}if(null!==s.parent&&g[s.parent]&&!s.state.hidden&&(d=O.inArray(s.id,g[s.parent].children),_=s.id,-1!==d))for(d++,h=g[s.parent].children.length;d<h&&(g[g[s.parent].children[d]].state.hidden||(_=g[s.parent].children[d]),_===s.id);d++);for(h in s.state.hidden&&(f+=" jstree-hidden"),s.state.loading&&(f+=" jstree-loading"),s.state.loaded&&!y?f+=" jstree-leaf":(f+=s.state.opened&&s.state.loaded?" jstree-open":" jstree-closed",e.childNodes[1].setAttribute("aria-expanded",s.state.opened&&s.state.loaded)),_===s.id&&(f+=" jstree-last"),e.id=s.id,e.className=f,f=(s.state.selected?" jstree-clicked":"")+(s.state.disabled?" jstree-disabled":""),s.a_attr)if(s.a_attr.hasOwnProperty(h)){if("href"===h&&"#"===s.a_attr[h])continue;"class"!==h?e.childNodes[1].setAttribute(h,s.a_attr[h]):f+=" "+s.a_attr[h]}if(f.length&&(e.childNodes[1].className="jstree-anchor "+f),(s.icon&&!0!==s.icon||!1===s.icon)&&(!1===s.icon?e.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===s.icon.indexOf("/")&&-1===s.icon.indexOf(".")?e.childNodes[1].childNodes[0].className+=" "+s.icon+" jstree-themeicon-custom":(e.childNodes[1].childNodes[0].style.backgroundImage='url("'+s.icon+'")',e.childNodes[1].childNodes[0].style.backgroundPosition="center center",e.childNodes[1].childNodes[0].style.backgroundSize="auto",e.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?e.childNodes[1].appendChild(p.createTextNode(s.text)):e.childNodes[1].innerHTML+=s.text,t&&s.children.length&&(s.state.opened||i)&&s.state.loaded){for((u=p.createElement("UL")).setAttribute("role","group"),u.className="jstree-children",d=0,h=s.children.length;d<h;d++)u.appendChild(this.redraw_node(s.children[d],t,!0));e.appendChild(u)}if(c&&e.appendChild(c),!n){for(d=0,h=(a=a||this.element[0]).childNodes.length;d<h;d++)if(a.childNodes[d]&&a.childNodes[d].className&&-1!==a.childNodes[d].className.indexOf("jstree-children")){v=a.childNodes[d];break}v||((v=p.createElement("UL")).setAttribute("role","group"),v.className="jstree-children",a.appendChild(v)),l<(a=v).childNodes.length?a.insertBefore(e,a.childNodes[l]):a.appendChild(e),m&&(r=this.element[0].scrollTop,o=this.element[0].scrollLeft,e.childNodes[1].focus(),this.element[0].scrollTop=r,this.element[0].scrollLeft=o)}return s.state.opened&&!s.state.loaded&&(s.state.opened=!1,setTimeout(O.proxy(function(){this.open_node(s.id,!1,0)},this),0)),e},open_node:function(e,n,i){var t,r,o,s;if(O.isArray(e)){for(t=0,r=(e=e.slice()).length;t<r;t++)this.open_node(e[t],n,i);return!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&(i=i===E?this.settings.core.animation:i,this.is_closed(e)?this.is_loaded(e)?(o=this.get_node(e,!0),s=this,o.length&&(i&&o.children(".jstree-children").length&&o.children(".jstree-children").stop(!0,!0),e.children.length&&!this._firstChild(o.children(".jstree-children")[0])&&this.draw_children(e),i?(this.trigger("before_open",{node:e}),o.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").children(".jstree-anchor").attr("aria-expanded",!0).end().children(".jstree-children").stop(!0,!0).slideDown(i,function(){this.style.display="",s.element&&s.trigger("after_open",{node:e})})):(this.trigger("before_open",{node:e}),o[0].className=o[0].className.replace("jstree-closed","jstree-open"),o[0].childNodes[1].setAttribute("aria-expanded",!0))),e.state.opened=!0,n&&n.call(this,e,!0),o.length||this.trigger("before_open",{node:e}),this.trigger("open_node",{node:e}),i&&o.length||this.trigger("after_open",{node:e}),!0):this.is_loading(e)?setTimeout(O.proxy(function(){this.open_node(e,n,i)},this),500):void this.load_node(e,function(e,t){return t?this.open_node(e,n,i):!!n&&n.call(this,e,!1)}):(n&&n.call(this,e,!1),!1))},_open_to:function(e){if(!(e=this.get_node(e))||e.id===O.jstree.root)return!1;for(var t=e.parents,n=0,i=t.length;n<i;n+=1)n!==O.jstree.root&&this.open_node(t[n],!1,0);return O("#"+e.id.replace(O.jstree.idregex,"\\$&"),this.element)},close_node:function(e,t){var n,i,r,o;if(O.isArray(e)){for(n=0,i=(e=e.slice()).length;n<i;n++)this.close_node(e[n],t);return!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&(!this.is_closed(e)&&(t=t===E?this.settings.core.animation:t,o=(r=this).get_node(e,!0),e.state.opened=!1,this.trigger("close_node",{node:e}),void(o.length?t?o.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").children(".jstree-anchor").attr("aria-expanded",!1).end().children(".jstree-children").stop(!0,!0).slideUp(t,function(){this.style.display="",o.children(".jstree-children").remove(),r.element&&r.trigger("after_close",{node:e})}):(o[0].className=o[0].className.replace("jstree-open","jstree-closed"),o.children(".jstree-anchor").attr("aria-expanded",!1),o.children(".jstree-children").remove(),this.trigger("after_close",{node:e})):this.trigger("after_close",{node:e}))))},toggle_node:function(e){var t,n;if(O.isArray(e)){for(t=0,n=(e=e.slice()).length;t<n;t++)this.toggle_node(e[t]);return!0}return this.is_closed(e)?this.open_node(e):this.is_open(e)?this.close_node(e):void 0},open_all:function(e,n,i){if(e=e||O.jstree.root,!(e=this.get_node(e)))return!1;var t,r,o,s=e.id===O.jstree.root?this.get_container_ul():this.get_node(e,!0);if(!s.length){for(t=0,r=e.children_d.length;t<r;t++)this.is_closed(this._model.data[e.children_d[t]])&&(this._model.data[e.children_d[t]].state.opened=!0);return this.trigger("open_all",{node:e})}i=i||s,(s=(o=this).is_closed(e)?s.find(".jstree-closed").addBack():s.find(".jstree-closed")).each(function(){o.open_node(this,function(e,t){t&&this.is_parent(e)&&this.open_all(e,n,i)},n||0)}),0===i.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(i)})},close_all:function(e,t){if(e=e||O.jstree.root,!(e=this.get_node(e)))return!1;var n,i,r=e.id===O.jstree.root?this.get_container_ul():this.get_node(e,!0),o=this;for(r.length&&(r=this.is_open(e)?r.find(".jstree-open").addBack():r.find(".jstree-open"),O(r.get().reverse()).each(function(){o.close_node(this,t||0)})),n=0,i=e.children_d.length;n<i;n++)this._model.data[e.children_d[n]].state.opened=!1;this.trigger("close_all",{node:e})},is_disabled:function(e){return(e=this.get_node(e))&&e.state&&e.state.disabled},enable_node:function(e){var t,n;if(O.isArray(e)){for(t=0,n=(e=e.slice()).length;t<n;t++)this.enable_node(e[t]);return!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&(e.state.disabled=!1,this.get_node(e,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),void this.trigger("enable_node",{node:e}))},disable_node:function(e){var t,n;if(O.isArray(e)){for(t=0,n=(e=e.slice()).length;t<n;t++)this.disable_node(e[t]);return!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&(e.state.disabled=!0,this.get_node(e,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),void this.trigger("disable_node",{node:e}))},is_hidden:function(e){return!0===(e=this.get_node(e)).state.hidden},hide_node:function(e,t){var n,i;if(O.isArray(e)){for(n=0,i=(e=e.slice()).length;n<i;n++)this.hide_node(e[n],!0);return t||this.redraw(),!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&void(e.state.hidden||(e.state.hidden=!0,this._node_changed(e.parent),t||this.redraw(),this.trigger("hide_node",{node:e})))},show_node:function(e,t){var n,i;if(O.isArray(e)){for(n=0,i=(e=e.slice()).length;n<i;n++)this.show_node(e[n],!0);return t||this.redraw(),!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&void(e.state.hidden&&(e.state.hidden=!1,this._node_changed(e.parent),t||this.redraw(),this.trigger("show_node",{node:e})))},hide_all:function(e){var t,n=this._model.data,i=[];for(t in n)n.hasOwnProperty(t)&&t!==O.jstree.root&&!n[t].state.hidden&&(n[t].state.hidden=!0,i.push(t));return this._model.force_full_redraw=!0,e||this.redraw(),this.trigger("hide_all",{nodes:i}),i},show_all:function(e){var t,n=this._model.data,i=[];for(t in n)n.hasOwnProperty(t)&&t!==O.jstree.root&&n[t].state.hidden&&(n[t].state.hidden=!1,i.push(t));return this._model.force_full_redraw=!0,e||this.redraw(),this.trigger("show_all",{nodes:i}),i},activate_node:function(e,t){if(this.is_disabled(e))return!1;if(t&&"object"==typeof t||(t={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==E?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(t.metaKey||t.ctrlKey||t.shiftKey)&&(!t.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(t.shiftKey){for(var n=this.get_node(e).id,i=this._data.core.last_clicked.id,r=this.get_node(this._data.core.last_clicked.parent).children,o=!1,s=0,a=r.length;s<a;s+=1)r[s]===n&&(o=!o),r[s]===i&&(o=!o),this.is_disabled(r[s])||!o&&r[s]!==n&&r[s]!==i?this.deselect_node(r[s],!0,t):this.is_hidden(r[s])||this.select_node(r[s],!0,!1,t);this.trigger("changed",{action:"select_node",node:this.get_node(e),selected:this._data.core.selected,event:t})}else this.is_selected(e)?this.deselect_node(e,!1,t):this.select_node(e,!1,!1,t);else!this.settings.core.multiple&&(t.metaKey||t.ctrlKey||t.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,t):(this.deselect_all(!0),this.select_node(e,!1,!1,t),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e),event:t})},hover_node:function(e){if(!(e=this.get_node(e,!0))||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),n=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){n.attr("aria-activedescendant",e[0].id)},0)},dehover_node:function(e){return!!((e=this.get_node(e,!0))&&e.length&&e.children(".jstree-hovered").length)&&(e.children(".jstree-anchor").removeClass("jstree-hovered"),void this.trigger("dehover_node",{node:this.get_node(e)}))},select_node:function(e,t,n,i){var r,o,s;if(O.isArray(e)){for(o=0,s=(e=e.slice()).length;o<s;o++)this.select_node(e[o],t,n,i);return!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&(r=this.get_node(e,!0),void(e.state.selected||(e.state.selected=!0,this._data.core.selected.push(e.id),n||(r=this._open_to(e)),r&&r.length&&r.children(".jstree-anchor").addClass("jstree-clicked").attr("aria-selected",!0),this.trigger("select_node",{node:e,selected:this._data.core.selected,event:i}),t||this.trigger("changed",{action:"select_node",node:e,selected:this._data.core.selected,event:i}))))},deselect_node:function(e,t,n){var i,r,o;if(O.isArray(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.deselect_node(e[i],t,n);return!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&(o=this.get_node(e,!0),void(e.state.selected&&(e.state.selected=!1,this._data.core.selected=O.vakata.array_remove_item(this._data.core.selected,e.id),o.length&&o.children(".jstree-anchor").removeClass("jstree-clicked").attr("aria-selected",!1),this.trigger("deselect_node",{node:e,selected:this._data.core.selected,event:n}),t||this.trigger("changed",{action:"deselect_node",node:e,selected:this._data.core.selected,event:n}))))},select_all:function(e){var t,n,i=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data[O.jstree.root].children_d.concat(),t=0,n=this._data.core.selected.length;t<n;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),e||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:i})},deselect_all:function(e){for(var t=this._data.core.selected.concat([]),n=0,i=this._data.core.selected.length;n<i;n++)this._model.data[this._data.core.selected[n]]&&(this._model.data[this._data.core.selected[n]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked").attr("aria-selected",!1),this.trigger("deselect_all",{selected:this._data.core.selected,node:t}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:t})},is_selected:function(e){return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&e.state.selected},get_selected:function(e){return e?O.map(this._data.core.selected,O.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected.slice()},get_top_selected:function(e){for(var t,n,i=this.get_selected(!0),r={},o=0,s=i.length;o<s;o++)r[i[o].id]=i[o];for(o=0,s=i.length;o<s;o++)for(t=0,n=i[o].children_d.length;t<n;t++)r[i[o].children_d[t]]&&delete r[i[o].children_d[t]];for(o in i=[],r)r.hasOwnProperty(o)&&i.push(o);return e?O.map(i,O.proxy(function(e){return this.get_node(e)},this)):i},get_bottom_selected:function(e){for(var t=this.get_selected(!0),n=[],i=0,r=t.length;i<r;i++)t[i].children.length||n.push(t[i].id);return e?O.map(n,O.proxy(function(e){return this.get_node(e)},this)):n},get_state:function(){var e,t={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(e in this._model.data)this._model.data.hasOwnProperty(e)&&e!==O.jstree.root&&(this._model.data[e].state.loaded&&this.settings.core.loaded_state&&t.core.loaded.push(e),this._model.data[e].state.opened&&t.core.open.push(e),this._model.data[e].state.selected&&t.core.selected.push(e));return t},set_state:function(t,n){if(t){if(t.core&&t.core.selected&&t.core.initial_selection===E&&(t.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")),t.core){var i,e;if(t.core.loaded)return this.settings.core.loaded_state&&O.isArray(t.core.loaded)&&t.core.loaded.length?this._load_nodes(t.core.loaded,function(e){delete t.core.loaded,this.set_state(t,n)}):(delete t.core.loaded,this.set_state(t,n)),!1;if(t.core.open)return O.isArray(t.core.open)&&t.core.open.length?this._load_nodes(t.core.open,function(e){this.open_node(e,!1,0),delete t.core.open,this.set_state(t,n)}):(delete t.core.open,this.set_state(t,n)),!1;if(t.core.scroll)return t.core.scroll&&t.core.scroll.left!==E&&this.element.scrollLeft(t.core.scroll.left),t.core.scroll&&t.core.scroll.top!==E&&this.element.scrollTop(t.core.scroll.top),delete t.core.scroll,this.set_state(t,n),!1;if(t.core.selected)return i=this,t.core.initial_selection!==E&&t.core.initial_selection!==this._data.core.selected.concat([]).sort().join(",")||(this.deselect_all(),O.each(t.core.selected,function(e,t){i.select_node(t,!1,!0)})),delete t.core.initial_selection,delete t.core.selected,this.set_state(t,n),!1;for(e in t)t.hasOwnProperty(e)&&"core"!==e&&-1===O.inArray(e,this.settings.plugins)&&delete t[e];if(O.isEmptyObject(t.core))return delete t.core,this.set_state(t,n),!1}return!O.isEmptyObject(t)||(t=null,n&&n.call(this),this.trigger("set_state"),!1)}return!1},refresh:function(e,t){this._data.core.state=!0===t?{}:this.get_state(),t&&O.isFunction(t)&&(this._data.core.state=t.call(this,this._data.core.state)),this._cnt=0,this._model.data={},this._model.data[O.jstree.root]={id:O.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}},this._data.core.selected=[],this._data.core.last_clicked=null,this._data.core.focused=null;var n=this.get_container_ul()[0].className;e||(this.element.html("<ul class='"+n+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading")),this.load_node(O.jstree.root,function(e,t){t&&(this.get_container_ul()[0].className=n,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(O.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(!(t=this.get_node(t))||t.id===O.jstree.root)return!1;var n=[],e=[],i=this._data.core.selected.concat([]);e.push(t.id),!0===t.state.opened&&n.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){e.push(this.id),n.push(this.id)}),this._load_nodes(e,O.proxy(function(e){this.open_node(n,!1,0),this.select_node(i),this.trigger("refresh_node",{node:t,nodes:e})},this),!1,!0)},set_id:function(e,t){if(!(e=this.get_node(e))||e.id===O.jstree.root)return!1;var n,i,r=this._model.data,o=e.id;for(t=t.toString(),r[e.parent].children[O.inArray(e.id,r[e.parent].children)]=t,n=0,i=e.parents.length;n<i;n++)r[e.parents[n]].children_d[O.inArray(e.id,r[e.parents[n]].children_d)]=t;for(n=0,i=e.children.length;n<i;n++)r[e.children[n]].parent=t;for(n=0,i=e.children_d.length;n<i;n++)r[e.children_d[n]].parents[O.inArray(e.id,r[e.children_d[n]].parents)]=t;return-1!==(n=O.inArray(e.id,this._data.core.selected))&&(this._data.core.selected[n]=t),(n=this.get_node(e.id,!0))&&(n.attr("id",t),this.element.attr("aria-activedescendant")===e.id&&this.element.attr("aria-activedescendant",t)),delete r[e.id],e.id=t,r[e.li_attr.id=t]=e,this.trigger("set_id",{node:e,new:e.id,old:o}),!0},get_text:function(e){return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&e.text},set_text:function(e,t){var n,i;if(O.isArray(e)){for(n=0,i=(e=e.slice()).length;n<i;n++)this.set_text(e[n],t);return!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&(e.text=t,this.get_node(e,!0).length&&this.redraw_node(e.id),this.trigger("set_text",{obj:e,text:t}),!0)},get_json:function(e,t,n){if(!(e=this.get_node(e||O.jstree.root)))return!1;t&&t.flat&&!n&&(n=[]);var i,r,o={id:e.id,text:e.text,icon:this.get_icon(e),li_attr:O.extend(!0,{},e.li_attr),a_attr:O.extend(!0,{},e.a_attr),state:{},data:(!t||!t.no_data)&&O.extend(!0,O.isArray(e.data)?[]:{},e.data)};if(t&&t.flat?o.parent=e.parent:o.children=[],t&&t.no_state)delete o.state;else for(i in e.state)e.state.hasOwnProperty(i)&&(o.state[i]=e.state[i]);if(t&&t.no_li_attr&&delete o.li_attr,t&&t.no_a_attr&&delete o.a_attr,t&&t.no_id&&(delete o.id,o.li_attr&&o.li_attr.id&&delete o.li_attr.id,o.a_attr&&o.a_attr.id&&delete o.a_attr.id),t&&t.flat&&e.id!==O.jstree.root&&n.push(o),!t||!t.no_children)for(i=0,r=e.children.length;i<r;i++)t&&t.flat?this.get_json(e.children[i],t,n):o.children.push(this.get_json(e.children[i],t));return t&&t.flat?n:e.id===O.jstree.root?o.children:o},create_node:function(e,t,n,i,r){if(null===e&&(e=O.jstree.root),!(e=this.get_node(e)))return!1;if(!(n=n===E?"last":n).toString().match(/^(before|after)$/)&&!r&&!this.is_loaded(e))return this.load_node(e,function(){this.create_node(e,t,n,i,!0)});var o,s,a,l;switch((t="string"==typeof(t=t||{text:this.get_string("New node")})?{text:t}:O.extend(!0,{},t)).text===E&&(t.text=this.get_string("New node")),e.id===O.jstree.root&&("before"===n&&(n="first"),"after"===n&&(n="last")),n){case"before":o=this.get_node(e.parent),n=O.inArray(e.id,o.children),e=o;break;case"after":o=this.get_node(e.parent),n=O.inArray(e.id,o.children)+1,e=o;break;case"inside":case"first":n=0;break;case"last":n=e.children.length;break;default:n=n||0}if(n>e.children.length&&(n=e.children.length),t.id||(t.id=!0),!this.check("create_node",t,e,n))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!0===t.id&&delete t.id,!(t=this._parse_model_from_json(t,e.id,e.parents.concat())))return!1;for(o=this.get_node(t),(s=[]).push(t),s=s.concat(o.children_d),this.trigger("model",{nodes:s,parent:e.id}),e.children_d=e.children_d.concat(s),a=0,l=e.parents.length;a<l;a++)this._model.data[e.parents[a]].children_d=this._model.data[e.parents[a]].children_d.concat(s);for(t=o,o=[],a=0,l=e.children.length;a<l;a++)o[n<=a?a+1:a]=e.children[a];return o[n]=t.id,e.children=o,this.redraw_node(e,!0),this.trigger("create_node",{node:this.get_node(t),parent:e.id,position:n}),i&&i.call(this,this.get_node(t)),t.id},rename_node:function(e,t){var n,i,r;if(O.isArray(e)){for(n=0,i=(e=e.slice()).length;n<i;n++)this.rename_node(e[n],t);return!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&(r=e.text,this.check("rename_node",e,this.get_parent(e),t)?(this.set_text(e,t),this.trigger("rename_node",{node:e,text:t,old:r}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1))},delete_node:function(e){var t,n,i,r,o,s,a,l,c,d,h;if(O.isArray(e)){for(t=0,n=(e=e.slice()).length;t<n;t++)this.delete_node(e[t]);return!0}if(!(e=this.get_node(e))||e.id===O.jstree.root)return!1;if(i=this.get_node(e.parent),h=O.inArray(e.id,i.children),c=!1,!this.check("delete_node",e,i,h))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==h&&(i.children=O.vakata.array_remove(i.children,h)),(r=e.children_d.concat([])).push(e.id),o=0,s=e.parents.length;o<s;o++)this._model.data[e.parents[o]].children_d=O.vakata.array_filter(this._model.data[e.parents[o]].children_d,function(e){return-1===O.inArray(e,r)});for(a=0,l=r.length;a<l;a++)if(this._model.data[r[a]].state.selected){c=!0;break}for(c&&(this._data.core.selected=O.vakata.array_filter(this._data.core.selected,function(e){return-1===O.inArray(e,r)})),this.trigger("delete_node",{node:e,parent:i.id}),c&&this.trigger("changed",{action:"delete_node",node:e,selected:this._data.core.selected,parent:i.id}),a=0,l=r.length;a<l;a++)delete this._model.data[r[a]];return-1!==O.inArray(this._data.core.focused,r)&&(this._data.core.focused=null,d=this.element[0].scrollTop,h=this.element[0].scrollLeft,i.id===O.jstree.root?this._model.data[O.jstree.root].children[0]&&this.get_node(this._model.data[O.jstree.root].children[0],!0).children(".jstree-anchor").focus():this.get_node(i,!0).children(".jstree-anchor").focus(),this.element[0].scrollTop=d,this.element[0].scrollLeft=h),this.redraw_node(i,!0),!0},check:function(e,t,n,i,r){t=t&&t.id?t:this.get_node(t),n=n&&n.id?n:this.get_node(n);var o=e.match(/^move_node|copy_node|create_node$/i)?n:t,s=this.settings.core.check_callback;if("move_node"===e||"copy_node"===e){if(!(r&&r.is_multi||"move_node"!==e||O.inArray(t.id,n.children)!==i))return!(this._data.core.last_error={error:"check",plugin:"core",id:"core_08",reason:"Moving node to its current position",data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!n||!n.id)&&n.id})});if(!(r&&r.is_multi||t.id!==n.id&&("move_node"!==e||O.inArray(t.id,n.children)!==i)&&-1===O.inArray(n.id,t.children_d)))return!(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!n||!n.id)&&n.id})})}return o&&o.data&&(o=o.data),o&&o.functions&&(!1===o.functions[e]||!0===o.functions[e])?(!1===o.functions[e]&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!n||!n.id)&&n.id})}),o.functions[e]):!(!1===s||O.isFunction(s)&&!1===s.call(this,e,t,n,i,r)||s&&!1===s[e])||!(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!n||!n.id)&&n.id})})},last_error:function(){return this._data.core.last_error},move_node:function(e,t,n,i,r,o,s){var a,l,c,d,h,u,f,p,g,m,v,y,_,x;if(t=this.get_node(t),n=n===E?0:n,!t)return!1;if(!n.toString().match(/^(before|after)$/)&&!r&&!this.is_loaded(t))return this.load_node(t,function(){this.move_node(e,t,n,i,!0,!1,s)});if(O.isArray(e)){if(1!==e.length){for(a=0,l=e.length;a<l;a++)(g=this.move_node(e[a],t,n,i,r,!1,s))&&(t=g,n="after");return this.redraw(),!0}e=e[0]}if(!(e=e&&e.id?e:this.get_node(e))||e.id===O.jstree.root)return!1;if(c=(e.parent||O.jstree.root).toString(),h=n.toString().match(/^(before|after)$/)&&t.id!==O.jstree.root?this.get_node(t.parent):t,f=!(u=s||(this._model.data[e.id]?this:O.jstree.reference(e.id)))||!u._id||this._id!==u._id,d=u&&u._id&&c&&u._model.data[c]&&u._model.data[c].children?O.inArray(e.id,u._model.data[c].children):-1,u&&u._id&&(e=u._model.data[e.id]),f)return!!(g=this.copy_node(e,t,n,i,r,!1,s))&&(u&&u.delete_node(e),g);switch(t.id===O.jstree.root&&("before"===n&&(n="first"),"after"===n&&(n="last")),n){case"before":n=O.inArray(t.id,h.children);break;case"after":n=O.inArray(t.id,h.children)+1;break;case"inside":case"first":n=0;break;case"last":n=h.children.length;break;default:n=n||0}if(n>h.children.length&&(n=h.children.length),!this.check("move_node",e,h,n,{core:!0,origin:s,is_multi:u&&u._id&&u._id!==this._id,is_foreign:!u||!u._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(e.parent===h.id){for(p=h.children.concat(),-1!==(g=O.inArray(e.id,p))&&(p=O.vakata.array_remove(p,g),g<n&&n--),g=[],m=0,v=p.length;m<v;m++)g[n<=m?m+1:m]=p[m];g[n]=e.id,h.children=g,this._node_changed(h.id),this.redraw(h.id===O.jstree.root)}else{for((g=e.children_d.concat()).push(e.id),m=0,v=e.parents.length;m<v;m++){for(p=[],y=0,_=(x=u._model.data[e.parents[m]].children_d).length;y<_;y++)-1===O.inArray(x[y],g)&&p.push(x[y]);u._model.data[e.parents[m]].children_d=p}for(u._model.data[c].children=O.vakata.array_remove_item(u._model.data[c].children,e.id),m=0,v=h.parents.length;m<v;m++)this._model.data[h.parents[m]].children_d=this._model.data[h.parents[m]].children_d.concat(g);for(p=[],m=0,v=h.children.length;m<v;m++)p[n<=m?m+1:m]=h.children[m];for(p[n]=e.id,h.children=p,h.children_d.push(e.id),h.children_d=h.children_d.concat(e.children_d),e.parent=h.id,(g=h.parents.concat()).unshift(h.id),x=e.parents.length,g=(e.parents=g).concat(),m=0,v=e.children_d.length;m<v;m++)this._model.data[e.children_d[m]].parents=this._model.data[e.children_d[m]].parents.slice(0,-1*x),Array.prototype.push.apply(this._model.data[e.children_d[m]].parents,g);c!==O.jstree.root&&h.id!==O.jstree.root||(this._model.force_full_redraw=!0),this._model.force_full_redraw||(this._node_changed(c),this._node_changed(h.id)),o||this.redraw()}return i&&i.call(this,e,h,n),this.trigger("move_node",{node:e,parent:h.id,position:n,old_parent:c,old_position:d,is_multi:u&&u._id&&u._id!==this._id,is_foreign:!u||!u._id,old_instance:u,new_instance:this}),e.id},copy_node:function(e,t,n,i,r,o,s){var a,l,c,d,h,u,f,p,g,m;if(t=this.get_node(t),n=n===E?0:n,!t)return!1;if(!n.toString().match(/^(before|after)$/)&&!r&&!this.is_loaded(t))return this.load_node(t,function(){this.copy_node(e,t,n,i,!0,!1,s)});if(O.isArray(e)){if(1!==e.length){for(a=0,l=e.length;a<l;a++)(d=this.copy_node(e[a],t,n,i,r,!0,s))&&(t=d,n="after");return this.redraw(),!0}e=e[0]}if(!(e=e&&e.id?e:this.get_node(e))||e.id===O.jstree.root)return!1;switch(p=(e.parent||O.jstree.root).toString(),g=n.toString().match(/^(before|after)$/)&&t.id!==O.jstree.root?this.get_node(t.parent):t,(m=s||(this._model.data[e.id]?this:O.jstree.reference(e.id)))&&m._id&&(this._id,m._id),m&&m._id&&(e=m._model.data[e.id]),t.id===O.jstree.root&&("before"===n&&(n="first"),"after"===n&&(n="last")),n){case"before":n=O.inArray(t.id,g.children);break;case"after":n=O.inArray(t.id,g.children)+1;break;case"inside":case"first":n=0;break;case"last":n=g.children.length;break;default:n=n||0}if(n>g.children.length&&(n=g.children.length),!this.check("copy_node",e,g,n,{core:!0,origin:s,is_multi:m&&m._id&&m._id!==this._id,is_foreign:!m||!m._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(!(f=m?m.get_json(e,{no_id:!0,no_data:!0,no_state:!0}):e))return!1;if(!0===f.id&&delete f.id,!(f=this._parse_model_from_json(f,g.id,g.parents.concat())))return!1;for(d=this.get_node(f),e&&e.state&&!1===e.state.loaded&&(d.state.loaded=!1),(c=[]).push(f),c=c.concat(d.children_d),this.trigger("model",{nodes:c,parent:g.id}),h=0,u=g.parents.length;h<u;h++)this._model.data[g.parents[h]].children_d=this._model.data[g.parents[h]].children_d.concat(c);for(c=[],h=0,u=g.children.length;h<u;h++)c[n<=h?h+1:h]=g.children[h];return c[n]=d.id,g.children=c,g.children_d.push(d.id),g.children_d=g.children_d.concat(d.children_d),g.id===O.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(g.id),o||this.redraw(g.id===O.jstree.root),i&&i.call(this,d,g,n),this.trigger("copy_node",{node:d,original:e,parent:g.id,position:n,old_parent:p,old_position:m&&m._id&&p&&m._model.data[p]&&m._model.data[p].children?O.inArray(e.id,m._model.data[p].children):-1,is_multi:m&&m._id&&m._id!==this._id,is_foreign:!m||!m._id,old_instance:m,new_instance:this}),d.id},cut:function(e){if(e=e||this._data.core.selected.concat(),O.isArray(e)||(e=[e]),!e.length)return!1;for(var t,n=[],i=0,r=e.length;i<r;i++)(t=this.get_node(e[i]))&&t.id&&t.id!==O.jstree.root&&n.push(t);return!!n.length&&(o=n,s="move_node",void(a=this).trigger("cut",{node:e}))},copy:function(e){if(e=e||this._data.core.selected.concat(),O.isArray(e)||(e=[e]),!e.length)return!1;for(var t,n=[],i=0,r=e.length;i<r;i++)(t=this.get_node(e[i]))&&t.id&&t.id!==O.jstree.root&&n.push(t);return!!n.length&&(o=n,s="copy_node",void(a=this).trigger("copy",{node:e}))},get_buffer:function(){return{mode:s,node:o,inst:a}},can_paste:function(){return!1!==s&&!1!==o},paste:function(e,t){return!!((e=this.get_node(e))&&s&&s.match(/^(copy_node|move_node)$/)&&o)&&(this[s](o,e,t,!1,!1,!1,a)&&this.trigger("paste",{parent:e.id,node:o,mode:s}),void(a=s=o=!1))},clear_buffer:function(){a=s=o=!1,this.trigger("clear_buffer")},edit:function(n,e,i){var t,r,o,s,a,l,c,d,h=!1;return!!(n=this.get_node(n))&&(this.check("edit",n,this.get_parent(n))?(d=n,e="string"==typeof e?e:n.text,this.set_text(n,""),n=this._open_to(n),d.text=e,c=this._data.core.rtl,t=this.element.width(),this._data.core.focused=d.id,r=n.children(".jstree-anchor").focus(),o=O("<span></span>"),s=e,a=O("<div></div>",{css:{position:"absolute",top:"-200px",left:c?"0px":"-1000px",visibility:"hidden"}}).appendTo(x.body),l=O("<input />",{value:s,class:"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:O.proxy(function(e){e.stopImmediatePropagation(),e.preventDefault();var t=o.children(".jstree-rename-input").val(),e=this.settings.core.force_text;""===t&&(t=s),a.remove(),o.replaceWith(r),o.remove(),s=e?s:O("<div></div>").append(O.parseHTML(s)).html(),n=this.get_node(n),this.set_text(n,s),(e=!!this.rename_node(n,e?O("<div></div>").text(t).text():O("<div></div>").append(O.parseHTML(t)).html()))||this.set_text(n,s),this._data.core.focused=d.id,setTimeout(O.proxy(function(){var e=this.get_node(d.id,!0);e.length&&(this._data.core.focused=d.id,e.children(".jstree-anchor").focus())},this),0),i&&i.call(this,d,e,h,t),l=null},this),keydown:function(e){var t=e.which;27===t&&(h=!0,this.value=s),27!==t&&13!==t&&37!==t&&38!==t&&39!==t&&40!==t&&32!==t||e.stopImmediatePropagation(),27!==t&&13!==t||(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(e){l.width(Math.min(a.text("pW"+this.value).width(),t))},keypress:function(e){return 13!==e.which&&void 0}}),c={fontFamily:r.css("fontFamily")||"",fontSize:r.css("fontSize")||"",fontWeight:r.css("fontWeight")||"",fontStyle:r.css("fontStyle")||"",fontStretch:r.css("fontStretch")||"",fontVariant:r.css("fontVariant")||"",letterSpacing:r.css("letterSpacing")||"",wordSpacing:r.css("wordSpacing")||""},o.attr("class",r.attr("class")).append(r.contents().clone()).append(l),r.replaceWith(o),a.css(c),l.css(c).width(Math.min(a.text("pW"+l[0].value).width(),t))[0].select(),void O(x).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(e){l&&e.target!==l&&O(l).blur()})):(this.settings.core.error.call(this,this._data.core.last_error),!1))},set_theme:function(e,t){if(!e)return!1;!0===t&&(t=(this.settings.core.themes.dir||O.jstree.path+"/themes")+"/"+e+"/style.css"),t&&-1===O.inArray(t,n)&&(O("head").append('<link rel="stylesheet" href="'+t+'" type="text/css" />'),n.push(t)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=e,this.element.addClass("jstree-"+e),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+e+"-responsive"),this.trigger("set_theme",{theme:e})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),(this._data.core.themes.variant=e)&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped"),this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped"),this.trigger("hide_stripes")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots"),this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots"),this.trigger("hide_dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons"),this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons"),this.trigger("hide_icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},show_ellipsis:function(){this._data.core.themes.ellipsis=!0,this.get_container_ul().addClass("jstree-ellipsis"),this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=!1,this.get_container_ul().removeClass("jstree-ellipsis"),this.trigger("hide_ellipsis")},toggle_ellipsis:function(){this._data.core.themes.ellipsis?this.hide_ellipsis():this.show_ellipsis()},set_icon:function(e,t){var n,i,r,o;if(O.isArray(e)){for(n=0,i=(e=e.slice()).length;n<i;n++)this.set_icon(e[n],t);return!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&(o=e.icon,e.icon=!0===t||null===t||t===E||""===t||t,r=this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon"),!1===t?(r.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel"),this.hide_icon(e)):(!0===t||null===t||t===E||""===t?r.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel"):-1===t.indexOf("/")&&-1===t.indexOf(".")?(r.removeClass(o).css("background",""),r.addClass(t+" jstree-themeicon-custom").attr("rel",t)):(r.removeClass(o).css("background",""),r.addClass("jstree-themeicon-custom").css("background","url('"+t+"') center center no-repeat").attr("rel",t)),!1===o&&this.show_icon(e)),!0)},get_icon:function(e){return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&e.icon},hide_icon:function(e){var t,n;if(O.isArray(e)){for(t=0,n=(e=e.slice()).length;t<n;t++)this.hide_icon(e[t]);return!0}return!(!(e=this.get_node(e))||e===O.jstree.root)&&(e.icon=!1,this.get_node(e,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0)},show_icon:function(e){var t,n,i;if(O.isArray(e)){for(t=0,n=(e=e.slice()).length;t<n;t++)this.show_icon(e[t]);return!0}return!(!(e=this.get_node(e))||e===O.jstree.root)&&(i=this.get_node(e,!0),e.icon=!i.length||i.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"),e.icon||(e.icon=!0),i.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0)}},O.vakata={},O.vakata.attributes=function(e,n){e=O(e)[0];var i=n?{}:[];return e&&e.attributes&&O.each(e.attributes,function(e,t){-1===O.inArray(t.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==t.value&&""!==O.vakata.trim(t.value)&&(n?i[t.name]=t.value:i.push(t.name))}),i},O.vakata.array_unique=function(e){for(var t=[],n={},i=0,r=e.length;i<r;i++)n[e[i]]===E&&(t.push(e[i]),n[e[i]]=!0);return t},O.vakata.array_remove=function(e,t){return e.splice(t,1),e},O.vakata.array_remove_item=function(e,t){t=O.inArray(t,e);return-1!==t?O.vakata.array_remove(e,t):e},O.vakata.array_filter=function(e,t,n,i,r){if(e.filter)return e.filter(t,n);for(r in i=[],e)~~r+""==r+""&&0<=r&&t.call(n,e[r],+r,e)&&i.push(e[r]);return i},O.vakata.trim=function(e){return String.prototype.trim?String.prototype.trim.call(e.toString()):e.toString().replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},O.jstree.plugins.changed=function(e,o){var s=[];this.trigger=function(e,t){if(t=t||{},"changed"===e.replace(".jstree","")){t.changed={selected:[],deselected:[]};for(var n={},i=0,r=s.length;i<r;i++)n[s[i]]=1;for(i=0,r=t.selected.length;i<r;i++)n[t.selected[i]]?n[t.selected[i]]=2:t.changed.selected.push(t.selected[i]);for(i=0,r=s.length;i<r;i++)1===n[s[i]]&&t.changed.deselected.push(s[i]);s=t.selected.slice()}o.trigger.call(this,e,t)},this.refresh=function(e,t){return s=[],o.refresh.apply(this,arguments)}};var l,d,h=x.createElement("I");h.className="jstree-icon jstree-checkbox",h.setAttribute("role","presentation"),O.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0},O.jstree.plugins.checkbox=function(e,l){this.bind=function(){l.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",O.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",O.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",O.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(O.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",O.proxy(function(e,t){for(var n=this._model.data,i=(n[t.parent],t.nodes),r=0,o=i.length;r<o;r++)n[i[r]].state.checked=n[i[r]].state.checked||n[i[r]].original&&n[i[r]].original.state&&n[i[r]].original.state.checked,n[i[r]].state.checked&&this._data.checkbox.selected.push(i[r])},this)),-1===this.settings.checkbox.cascade.indexOf("up")&&-1===this.settings.checkbox.cascade.indexOf("down")||this.element.on("model.jstree",O.proxy(function(e,t){var n,i,r,o,s,a,l=this._model.data,c=l[t.parent],d=t.nodes,h=[],t=this.settings.checkbox.cascade,u=this.settings.checkbox.tie_selection;if(-1!==t.indexOf("down"))if(c.state[u?"selected":"checked"]){for(i=0,r=d.length;i<r;i++)l[d[i]].state[u?"selected":"checked"]=!0;this._data[u?"core":"checkbox"].selected=this._data[u?"core":"checkbox"].selected.concat(d)}else for(i=0,r=d.length;i<r;i++)if(l[d[i]].state[u?"selected":"checked"]){for(o=0,s=l[d[i]].children_d.length;o<s;o++)l[l[d[i]].children_d[o]].state[u?"selected":"checked"]=!0;this._data[u?"core":"checkbox"].selected=this._data[u?"core":"checkbox"].selected.concat(l[d[i]].children_d)}if(-1!==t.indexOf("up")){for(i=0,r=c.children_d.length;i<r;i++)l[c.children_d[i]].children.length||h.push(l[c.children_d[i]].parent);for(o=0,s=(h=O.vakata.array_unique(h)).length;o<s;o++)for(c=l[h[o]];c&&c.id!==O.jstree.root;){for(i=n=0,r=c.children.length;i<r;i++)n+=l[c.children[i]].state[u?"selected":"checked"];if(n!==r)break;c.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(c.id),(a=this.get_node(c,!0))&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}}this._data[u?"core":"checkbox"].selected=O.vakata.array_unique(this._data[u?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",O.proxy(function(e,t){var n,i,r=t.node,o=this._model.data,s=this.get_node(r.parent),t=this.settings.checkbox.cascade,a=this.settings.checkbox.tie_selection,l={},c=this._data[a?"core":"checkbox"].selected;for(u=0,f=c.length;u<f;u++)l[c[u]]=!0;if(-1!==t.indexOf("down"))for(var d=this._cascade_new_checked_state(r.id,!0),h=r.children_d.concat(r.id),u=0,f=h.length;u<f;u++)-1<d.indexOf(h[u])?l[h[u]]=!0:delete l[h[u]];if(-1!==t.indexOf("up"))for(;s&&s.id!==O.jstree.root;){for(u=n=0,f=s.children.length;u<f;u++)n+=o[s.children[u]].state[a?"selected":"checked"];if(n!==f)break;s.state[a?"selected":"checked"]=!0,l[s.id]=!0,(i=this.get_node(s,!0))&&i.length&&i.attr("aria-selected",!0).children(".jstree-anchor").addClass(a?"jstree-clicked":"jstree-checked"),s=this.get_node(s.parent)}for(u in c=[],l)l.hasOwnProperty(u)&&c.push(u);this._data[a?"core":"checkbox"].selected=c},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",O.proxy(function(e,t){for(var n,i=this.get_node(O.jstree.root),r=this._model.data,o=0,s=i.children_d.length;o<s;o++)(n=r[i.children_d[o]])&&n.original&&n.original.state&&n.original.state.undetermined&&(n.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",O.proxy(function(e,t){var n,i,r,o,s=t.node,a=(this.get_node(s,!0),this.settings.checkbox.cascade),l=this.settings.checkbox.tie_selection,t=this._data[l?"core":"checkbox"].selected,c=s.children_d.concat(s.id);if(-1!==a.indexOf("down")&&(o=this._cascade_new_checked_state(s.id,!1),t=O.vakata.array_filter(t,function(e){return-1===c.indexOf(e)||-1<o.indexOf(e)})),-1!==a.indexOf("up")&&-1===t.indexOf(s.id)){for(n=0,i=s.parents.length;n<i;n++)(r=this._model.data[s.parents[n]]).state[l?"selected":"checked"]=!1,r&&r.original&&r.original.state&&r.original.state.undetermined&&(r.original.state.undetermined=!1),(r=this.get_node(s.parents[n],!0))&&r.length&&r.attr("aria-selected",!1).children(".jstree-anchor").removeClass(l?"jstree-clicked":"jstree-checked");t=O.vakata.array_filter(t,function(e){return-1===s.parents.indexOf(e)})}this._data[l?"core":"checkbox"].selected=t},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",O.proxy(function(e,t){for(var n,i,r,o,s=this.get_node(t.parent),a=this._model.data,l=this.settings.checkbox.tie_selection;s&&s.id!==O.jstree.root&&!s.state[l?"selected":"checked"];){for(n=r=0,i=s.children.length;n<i;n++)r+=a[s.children[n]].state[l?"selected":"checked"];if(!(0<i&&r===i))break;s.state[l?"selected":"checked"]=!0,this._data[l?"core":"checkbox"].selected.push(s.id),(o=this.get_node(s,!0))&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(l?"jstree-clicked":"jstree-checked"),s=this.get_node(s.parent)}},this)).on("move_node.jstree",O.proxy(function(e,t){var n,i,r,o,s,a=t.is_multi,l=t.old_parent,t=this.get_node(t.parent),c=this._model.data,d=this.settings.checkbox.tie_selection;if(!a)for(n=this.get_node(l);n&&n.id!==O.jstree.root&&!n.state[d?"selected":"checked"];){for(r=i=0,o=n.children.length;r<o;r++)i+=c[n.children[r]].state[d?"selected":"checked"];if(!(0<o&&i===o))break;n.state[d?"selected":"checked"]=!0,this._data[d?"core":"checkbox"].selected.push(n.id),(s=this.get_node(n,!0))&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass(d?"jstree-clicked":"jstree-checked"),n=this.get_node(n.parent)}for(n=t;n&&n.id!==O.jstree.root;){for(r=i=0,o=n.children.length;r<o;r++)i+=c[n.children[r]].state[d?"selected":"checked"];if(i===o)n.state[d?"selected":"checked"]||(n.state[d?"selected":"checked"]=!0,this._data[d?"core":"checkbox"].selected.push(n.id),(s=this.get_node(n,!0))&&s.length&&s.attr("aria-selected",!0).children(".jstree-anchor").addClass(d?"jstree-clicked":"jstree-checked"));else{if(!n.state[d?"selected":"checked"])break;n.state[d?"selected":"checked"]=!1,this._data[d?"core":"checkbox"].selected=O.vakata.array_remove_item(this._data[d?"core":"checkbox"].selected,n.id),(s=this.get_node(n,!0))&&s.length&&s.attr("aria-selected",!1).children(".jstree-anchor").removeClass(d?"jstree-clicked":"jstree-checked")}n=this.get_node(n.parent)}},this))},this.get_undetermined=function(e){if(-1===this.settings.checkbox.cascade.indexOf("undetermined"))return[];for(var n,i,r={},o=this._model.data,t=this.settings.checkbox.tie_selection,s=this._data[t?"core":"checkbox"].selected,a=[],l=this,c=[],d=0,h=s.length;d<h;d++)if(o[s[d]]&&o[s[d]].parents)for(n=0,i=o[s[d]].parents.length;n<i&&r[o[s[d]].parents[n]]===E;n++)o[s[d]].parents[n]!==O.jstree.root&&(r[o[s[d]].parents[n]]=!0,a.push(o[s[d]].parents[n]));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var e,t=l.get_node(this);if(t)if(t.state.loaded){for(d=0,h=t.children_d.length;d<h;d++)if(!(e=o[t.children_d[d]]).state.loaded&&e.original&&e.original.state&&e.original.state.undetermined&&!0===e.original.state.undetermined)for(r[e.id]===E&&e.id!==O.jstree.root&&(r[e.id]=!0,a.push(e.id)),n=0,i=e.parents.length;n<i;n++)r[e.parents[n]]===E&&e.parents[n]!==O.jstree.root&&(r[e.parents[n]]=!0,a.push(e.parents[n]))}else if(t.original&&t.original.state&&t.original.state.undetermined&&!0===t.original.state.undetermined)for(r[t.id]===E&&t.id!==O.jstree.root&&(r[t.id]=!0,a.push(t.id)),n=0,i=t.parents.length;n<i;n++)r[t.parents[n]]===E&&t.parents[n]!==O.jstree.root&&(r[t.parents[n]]=!0,a.push(t.parents[n]))}),d=0,h=a.length;d<h;d++)o[a[d]].state[t?"selected":"checked"]||c.push(e?o[a[d]]:a[d]);return c},this._undetermined=function(){if(null!==this.element){var e,t,n,i=this.get_undetermined(!1);for(this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),e=0,t=i.length;e<t;e++)(n=this.get_node(i[e],!0))&&n.length&&n.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}},this.redraw_node=function(e,t,n,i){if(e=l.redraw_node.apply(this,arguments)){for(var r=null,o=null,s=0,a=e.childNodes.length;s<a;s++)if(e.childNodes[s]&&e.childNodes[s].className&&-1!==e.childNodes[s].className.indexOf("jstree-anchor")){r=e.childNodes[s];break}r&&(!this.settings.checkbox.tie_selection&&this._model.data[e.id].state.checked&&(r.className+=" jstree-checked"),o=h.cloneNode(!1),this._model.data[e.id].state.checkbox_disabled&&(o.className+=" jstree-checkbox-disabled"),r.insertBefore(o,r.childNodes[0]))}return n||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(O.proxy(this._undetermined,this),50)),e},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(e){e=this.get_node(e);var t,n,i=this.settings.checkbox.cascade,r=this.settings.checkbox.tie_selection,o=this._data[r?"core":"checkbox"].selected,s=this._model.data;if(!e||!0===e.state[r?"selected":"checked"]||-1===i.indexOf("undetermined")||-1===i.indexOf("down")&&-1===i.indexOf("up"))return!1;if(!e.state.loaded&&!0===e.original.state.undetermined)return!0;for(t=0,n=e.children_d.length;t<n;t++)if(-1!==O.inArray(e.children_d[t],o)||!s[e.children_d[t]].state.loaded&&s[e.children_d[t]].original.state.undetermined)return!0;return!1},this.disable_checkbox=function(e){var t,n,i;if(O.isArray(e)){for(t=0,n=(e=e.slice()).length;t<n;t++)this.disable_checkbox(e[t]);return!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&(i=this.get_node(e,!0),void(e.state.checkbox_disabled||(e.state.checkbox_disabled=!0,i&&i.length&&i.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:e}))))},this.enable_checkbox=function(e){var t,n,i;if(O.isArray(e)){for(t=0,n=(e=e.slice()).length;t<n;t++)this.enable_checkbox(e[t]);return!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&(i=this.get_node(e,!0),void(e.state.checkbox_disabled&&(e.state.checkbox_disabled=!1,i&&i.length&&i.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:e}))))},this.activate_node=function(e,t){return!O(t.target).hasClass("jstree-checkbox-disabled")&&(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||O(t.target).hasClass("jstree-checkbox"))&&(t.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!O(t.target).hasClass("jstree-checkbox")?l.activate_node.call(this,e,t):!this.is_disabled(e)&&(this.is_checked(e)?this.uncheck_node(e,t):this.check_node(e,t),void this.trigger("activate_node",{node:this.get_node(e)})))},this._cascade_new_checked_state=function(e,t){var n,i,r=this.settings.checkbox.tie_selection,o=this._model.data[e],s=[],a=[];if(!this.settings.checkbox.cascade_to_disabled&&o.state.disabled||!this.settings.checkbox.cascade_to_hidden&&o.state.hidden)c=this.get_checked_descendants(e),o.state[r?"selected":"checked"]&&c.push(o.id),s=s.concat(c);else{if(o.children)for(n=0,i=o.children.length;n<i;n++){var l=o.children[n],c=this._cascade_new_checked_state(l,t),s=s.concat(c);-1<c.indexOf(l)&&a.push(l)}var d=this.get_node(o,!0),e=0<a.length&&a.length<o.children.length;o.original&&o.original.state&&o.original.state.undetermined&&(o.original.state.undetermined=e),!e&&t&&a.length===o.children.length?(o.state[r?"selected":"checked"]=t,s.push(o.id),d.attr("aria-selected",!0).children(".jstree-anchor").addClass(r?"jstree-clicked":"jstree-checked")):(o.state[r?"selected":"checked"]=!1,d.attr("aria-selected",!1).children(".jstree-anchor").removeClass(r?"jstree-clicked":"jstree-checked"))}return s},this.get_checked_descendants=function(e){var t=this,n=t.settings.checkbox.tie_selection,e=t._model.data[e];return O.vakata.array_filter(e.children_d,function(e){return t._model.data[e].state[n?"selected":"checked"]})},this.check_node=function(e,t){if(this.settings.checkbox.tie_selection)return this.select_node(e,!1,!0,t);var n,i,r;if(O.isArray(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.check_node(e[i],t);return!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&(n=this.get_node(e,!0),void(e.state.checked||(e.state.checked=!0,this._data.checkbox.selected.push(e.id),n&&n.length&&n.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:e,selected:this._data.checkbox.selected,event:t}))))},this.uncheck_node=function(e,t){if(this.settings.checkbox.tie_selection)return this.deselect_node(e,!1,t);var n,i,r;if(O.isArray(e)){for(n=0,i=(e=e.slice()).length;n<i;n++)this.uncheck_node(e[n],t);return!0}return!(!(e=this.get_node(e))||e.id===O.jstree.root)&&(r=this.get_node(e,!0),void(e.state.checked&&(e.state.checked=!1,this._data.checkbox.selected=O.vakata.array_remove_item(this._data.checkbox.selected,e.id),r.length&&r.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:e,selected:this._data.checkbox.selected,event:t}))))},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var e,t;this._data.checkbox.selected.concat([]);for(this._data.checkbox.selected=this._model.data[O.jstree.root].children_d.concat(),e=0,t=this._data.checkbox.selected.length;e<t;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();for(var e=this._data.checkbox.selected.concat([]),t=0,n=this._data.checkbox.selected.length;t<n;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!1);this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:e})},this.is_checked=function(e){return this.settings.checkbox.tie_selection?this.is_selected(e):!(!(e=this.get_node(e))||e.id===O.jstree.root)&&e.state.checked},this.get_checked=function(e){return this.settings.checkbox.tie_selection?this.get_selected(e):e?O.map(this._data.checkbox.selected,O.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected.slice()},this.get_top_checked=function(e){if(this.settings.checkbox.tie_selection)return this.get_top_selected(e);for(var t,n,i=this.get_checked(!0),r={},o=0,s=i.length;o<s;o++)r[i[o].id]=i[o];for(o=0,s=i.length;o<s;o++)for(t=0,n=i[o].children_d.length;t<n;t++)r[i[o].children_d[t]]&&delete r[i[o].children_d[t]];for(o in i=[],r)r.hasOwnProperty(o)&&i.push(o);return e?O.map(i,O.proxy(function(e){return this.get_node(e)},this)):i},this.get_bottom_checked=function(e){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(e);for(var t=this.get_checked(!0),n=[],i=0,r=t.length;i<r;i++)t[i].children.length||n.push(t[i].id);return e?O.map(n,O.proxy(function(e){return this.get_node(e)},this)):n},this.load_node=function(e,t){var n,i,r;if(!O.isArray(e)&&!this.settings.checkbox.tie_selection&&((r=this.get_node(e))&&r.state.loaded))for(n=0,i=r.children_d.length;n<i;n++)this._model.data[r.children_d[n]].state.checked&&(this._data.checkbox.selected=O.vakata.array_remove_item(this._data.checkbox.selected,r.children_d[n]));return l.load_node.apply(this,arguments)},this.get_state=function(){var e=l.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection||(e.checkbox=this._data.checkbox.selected.slice()),e},this.set_state=function(e,t){var n,i=l.set_state.apply(this,arguments);return i&&e.checkbox?(this.settings.checkbox.tie_selection||(this.uncheck_all(),n=this,O.each(e.checkbox,function(e,t){n.check_node(t)})),delete e.checkbox,this.set_state(e,t),!1):i},this.refresh=function(e,t){return this.settings.checkbox.tie_selection&&(this._data.checkbox.selected=[]),l.refresh.apply(this,arguments)}},O.jstree.defaults.conditionalselect=function(){return!0},O.jstree.plugins.conditionalselect=function(e,n){this.activate_node=function(e,t){return this.settings.conditionalselect.call(this,this.get_node(e),t)?n.activate_node.call(this,e,t):void 0}},O.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(e,t){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(e){var n=O.jstree.reference(e.reference),e=n.get_node(e.reference);n.create_node(e,{},"last",function(t){try{n.edit(t)}catch(e){setTimeout(function(){n.edit(t)},0)}})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(e){var t=O.jstree.reference(e.reference),e=t.get_node(e.reference);t.edit(e)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(e){var t=O.jstree.reference(e.reference),e=t.get_node(e.reference);t.is_selected(e)?t.delete_node(t.get_selected()):t.delete_node(e)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(e){var t=O.jstree.reference(e.reference),e=t.get_node(e.reference);t.is_selected(e)?t.cut(t.get_top_selected()):t.cut(e)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(e){var t=O.jstree.reference(e.reference),e=t.get_node(e.reference);t.is_selected(e)?t.copy(t.get_top_selected()):t.copy(e)}},paste:{separator_before:!1,icon:!1,_disabled:function(e){return!O.jstree.reference(e.reference).can_paste()},separator_after:!1,label:"Paste",action:function(e){var t=O.jstree.reference(e.reference),e=t.get_node(e.reference);t.paste(e)}}}}}}},O.jstree.plugins.contextmenu=function(e,o){this.bind=function(){o.bind.call(this);var t,n,i=0,r=null;this.element.on("init.jstree loading.jstree ready.jstree",O.proxy(function(){this.get_container_ul().addClass("jstree-contextmenu")},this)).on("contextmenu.jstree",".jstree-anchor",O.proxy(function(e,t){"input"!==e.target.tagName.toLowerCase()&&(e.preventDefault(),i=e.ctrlKey?+new Date:0,(t||r)&&(i=+new Date+1e4),r&&clearTimeout(r),this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e))},this)).on("click.jstree",".jstree-anchor",O.proxy(function(e){this._data.contextmenu.visible&&(!i||250<+new Date-i)&&O.vakata.context.hide(),i=0},this)).on("touchstart.jstree",".jstree-anchor",function(e){e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(t=e.originalEvent.changedTouches[0].clientX,n=e.originalEvent.changedTouches[0].clientY,r=setTimeout(function(){O(e.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(e){r&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(10<Math.abs(t-e.originalEvent.changedTouches[0].clientX)||10<Math.abs(n-e.originalEvent.changedTouches[0].clientY))&&(clearTimeout(r),O.vakata.context.hide())}).on("touchend.vakata.jstree",function(e){r&&clearTimeout(r)}),O(x).on("context_hide.vakata.jstree",O.proxy(function(e,t){this._data.contextmenu.visible=!1,O(t.reference).removeClass("jstree-context")},this))},this.teardown=function(){this._data.contextmenu.visible&&O.vakata.context.hide(),o.teardown.call(this)},this.show_contextmenu=function(t,n,i,e){if(!(t=this.get_node(t))||t.id===O.jstree.root)return!1;var r,o=this.settings.contextmenu,s=this.get_node(t,!0).children(".jstree-anchor"),a=!1;!o.show_at_node&&n!==E&&i!==E||(r=s.offset(),n=r.left,i=r.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(t)&&this.activate_node(t,e),a=o.items,O.isFunction(a)&&(a=a.call(this,t,O.proxy(function(e){this._show_contextmenu(t,n,i,e)},this))),O.isPlainObject(a)&&this._show_contextmenu(t,n,i,a)},this._show_contextmenu=function(e,t,n,i){var r=this.get_node(e,!0).children(".jstree-anchor");O(x).one("context_show.vakata.jstree",O.proxy(function(e,t){var n="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";O(t.element).addClass(n),r.addClass("jstree-context")},this)),this._data.contextmenu.visible=!0,O.vakata.context.show(r,{x:t,y:n},i),this.trigger("show_contextmenu",{node:e,x:t,y:n})}},_={element:y=!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1},(v=O).vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(e){v(x).triggerHandler("context_"+e+".vakata",{reference:_.reference,element:_.element,position:{x:_.position_x,y:_.position_y}})},_execute:function(e){return!(!(e=_.items[e])||e._disabled&&(!v.isFunction(e._disabled)||e._disabled({item:e,reference:_.reference,element:_.element}))||!e.action)&&e.action.call(null,{item:e,reference:_.reference,element:_.element,position:{x:_.position_x,y:_.position_y}})},_parse:function(e,t){if(!e)return!1;t||(_.html="",_.items=[]);var n,i="",r=!1;return t&&(i+="<ul>"),v.each(e,function(e,t){return!t||(_.items.push(t),!r&&t.separator_before&&(i+="<li class='vakata-context-separator'><a href='#' "+(v.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),r=!1,i+="<li class='"+(t._class||"")+(!0===t._disabled||v.isFunction(t._disabled)&&t._disabled({item:t,reference:_.reference,element:_.element})?" vakata-contextmenu-disabled ":"")+"' "+(t.shortcut?" data-shortcut='"+t.shortcut+"' ":"")+">",i+="<a href='#' rel='"+(_.items.length-1)+"' "+(t.title?"title='"+t.title+"'":"")+">",v.vakata.context.settings.icons&&(i+="<i ",t.icon&&(i+=-1!==t.icon.indexOf("/")||-1!==t.icon.indexOf(".")?" style='background:url(\""+t.icon+"\") center center no-repeat' ":" class='"+t.icon+"' "),i+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),i+=(v.isFunction(t.label)?t.label({item:e,reference:_.reference,element:_.element}):t.label)+(t.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+t.shortcut+'">'+(t.shortcut_label||"")+"</span>":"")+"</a>",t.submenu&&((n=v.vakata.context._parse(t.submenu,!0))&&(i+=n)),i+="</li>",void(t.separator_after&&(i+="<li class='vakata-context-separator'><a href='#' "+(v.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",r=!0)))}),i=i.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),t&&(i+="</ul>"),t||(_.html=i,v.vakata.context._trigger("parse")),10<i.length&&i},_show_submenu:function(e){var t,n,i,r,o,s,a,l;(e=v(e)).length&&e.children("ul").length&&(t=e.children("ul"),i=(n=e.offset().left)+e.outerWidth(),r=e.offset().top,o=t.width(),s=t.height(),a=v(window).width()+v(window).scrollLeft(),l=v(window).height()+v(window).scrollTop(),y?e[i-(o+10+e.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):e[a<i+o&&a-i<n?"addClass":"removeClass"]("vakata-context-right"),l<r+s+10&&t.css("bottom","-1px"),e.hasClass("vakata-context-right")?n<o&&t.css("margin-right",n-o):a-i<o&&t.css("margin-left",a-i-o),t.show())},show:function(e,t,n){var i,r,o,s,a,l,c;switch(_.element&&_.element.length&&_.element.width(""),!0){case!t&&!e:return!1;case!!t&&!!e:_.reference=e,_.position_x=t.x,_.position_y=t.y;break;case!t&&!!e:i=(_.reference=e).offset(),_.position_x=i.left+e.outerHeight(),_.position_y=i.top;break;case!!t&&!e:_.position_x=t.x,_.position_y=t.y}e&&!n&&v(e).data("vakata_contextmenu")&&(n=v(e).data("vakata_contextmenu")),v.vakata.context._parse(n)&&_.element.html(_.html),_.items.length&&(_.element.appendTo(x.body),r=_.element,o=_.position_x,s=_.position_y,a=r.width(),l=r.height(),c=v(window).width()+v(window).scrollLeft(),n=v(window).height()+v(window).scrollTop(),!y||(o-=r.outerWidth()-v(e).outerWidth())<v(window).scrollLeft()+20&&(o=v(window).scrollLeft()+20),c<o+a+20&&(o=c-(a+20)),n<s+l+20&&(s=n-(l+20)),_.element.css({left:o,top:s}).show().find("a").first().focus().parent().addClass("vakata-context-hover"),_.is_visible=!0,v.vakata.context._trigger("show"))},hide:function(){_.is_visible&&(_.element.hide().find("ul").hide().end().find(":focus").blur().end().detach(),_.is_visible=!1,v.vakata.context._trigger("hide"))}},v(function(){y="rtl"===v(x.body).css("direction");var t=!1;_.element=v("<ul class='vakata-context'></ul>"),_.element.on("mouseenter","li",function(e){e.stopImmediatePropagation(),v.contains(this,e.relatedTarget)||(t&&clearTimeout(t),_.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),v(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),v.vakata.context._show_submenu(this))}).on("mouseleave","li",function(e){v.contains(this,e.relatedTarget)||v(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(e){v(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),v.vakata.context.settings.hide_onmouseleave&&(t=setTimeout(function(){v.vakata.context.hide()},v.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(e){e.preventDefault(),v(this).blur().parent().hasClass("vakata-context-disabled")||!1===v.vakata.context._execute(v(this).attr("rel"))||v.vakata.context.hide()}).on("keydown","a",function(e){var t=null;switch(e.which){case 13:case 32:e.type="click",e.preventDefault(),v(e.currentTarget).trigger(e);break;case 37:_.is_visible&&(_.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 38:_.is_visible&&((t=_.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first()).length||(t=_.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),t.addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 39:_.is_visible&&(_.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 40:_.is_visible&&((t=_.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first()).length||(t=_.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),t.addClass("vakata-context-hover").children("a").focus(),e.stopImmediatePropagation(),e.preventDefault());break;case 27:v.vakata.context.hide(),e.preventDefault()}}).on("keydown",function(e){e.preventDefault();e=_.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();e.parent().not(".vakata-context-disabled")&&e.click()}),v(x).on("mousedown.vakata.jstree",function(e){_.is_visible&&_.element[0]!==e.target&&!v.contains(_.element[0],e.target)&&v.vakata.context.hide()}).on("context_show.vakata.jstree",function(e,t){_.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),y&&_.element.addClass("vakata-context-rtl").css("direction","rtl"),_.element.find("ul").hide().end()})}),O.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1},O.jstree.plugins.dnd=function(e,a){this.init=function(e,t){a.init.call(this,e,t),this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in x.createElement("span")},this.bind=function(){a.bind.call(this),this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",O.proxy(function(e){if(this.settings.dnd.large_drag_target&&O(e.target).closest(".jstree-node")[0]!==e.currentTarget)return!0;if("touchstart"===e.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!O(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var t=this.get_node(e.target),n=this.is_selected(t)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,i=1<n?n+" "+this.get_string("nodes"):this.get_text(e.currentTarget);if(this.settings.core.force_text&&(i=O.vakata.html.escape(i)),t&&t.id&&t.id!==O.jstree.root&&(1===e.which||"touchstart"===e.type||"dragstart"===e.type)&&(!0===this.settings.dnd.is_draggable||O.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,1<n?this.get_top_selected(!0):[t],e))){if(l={jstree:!0,origin:this,obj:this.get_node(t,!0),nodes:1<n?this.get_top_selected():[t.id]},d=e.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),O.vakata.dnd.start(e,l,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+i+'<ins class="jstree-copy" style="display:none;">+</ins></div>');O.vakata.dnd._trigger("start",e,{helper:O(),element:d,data:l})}},this)),this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(e){return e.preventDefault(),O.vakata.dnd._trigger("move",e,{helper:O(),element:d,data:l}),!1}).on("drop.jstree",O.proxy(function(e){return e.preventDefault(),O.vakata.dnd._trigger("stop",e,{helper:O(),element:d,data:l}),!1},this))},this.redraw_node=function(e,t,n,i){if((e=a.redraw_node.apply(this,arguments))&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)e.setAttribute("draggable",!0);else{for(var r=null,o=0,s=e.childNodes.length;o<s;o++)if(e.childNodes[o]&&e.childNodes[o].className&&-1!==e.childNodes[o].className.indexOf("jstree-anchor")){r=e.childNodes[o];break}r&&r.setAttribute("draggable",!0)}return e}},O(function(){var T=!1,L=!1,j=!1,A=!1,M=O('<div id="jstree-marker">&#160;</div>').hide();O(x).on("dragover.vakata.jstree",function(e){d&&O.vakata.dnd._trigger("move",e,{helper:O(),element:d,data:l})}).on("drop.vakata.jstree",function(e){d&&(O.vakata.dnd._trigger("stop",e,{helper:O(),element:d,data:l}),l=d=null)}).on("dnd_start.vakata.jstree",function(e,t){j=T=!1,t&&t.data&&t.data.jstree&&M.appendTo(x.body)}).on("dnd_move.vakata.jstree",function(e,r){var o=r.event.target!==j.target;if(!A||r.event&&"dragover"===r.event.type&&!o||clearTimeout(A),r&&r.data&&r.data.jstree&&(!r.event.target.id||"jstree-marker"!==r.event.target.id)){j=r.event;var s,t,a,l,c,d,h,u,f,p,g,m,v,y,_,x,b,k,C,w=O.jstree.reference(r.event.target),S=!1;if(w&&w._data&&w._data.dnd)if(M.attr("class","jstree-"+w.get_theme()+(w.settings.core.themes.responsive?" jstree-dnd-responsive":"")),b=r.data.origin&&(r.data.origin.settings.dnd.always_copy||r.data.origin.settings.dnd.copy&&(r.event.metaKey||r.event.ctrlKey)),r.helper.children().attr("class","jstree-"+w.get_theme()+" jstree-"+w.get_theme()+"-"+w.get_theme_variant()+" "+(w.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[b?"show":"hide"](),r.event.target!==w.element[0]&&r.event.target!==w.get_container_ul()[0]||0!==w.get_container_ul().children().length){if((S=w.settings.dnd.large_drop_target?O(r.event.target).closest(".jstree-node").children(".jstree-anchor"):O(r.event.target).closest(".jstree-anchor"))&&S.length&&S.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(s=S.offset(),t=(r.event.pageY!==E?r.event:r.event.originalEvent).pageY-s.top,c=S.outerHeight(),u=t<c/3?["b","i","a"]:c-c/3<t?["a","i","b"]:c/2<t?["i","a","b"]:["i","b","a"],O.each(u,function(e,t){switch(t){case"b":a=s.left-6,l=s.top,d=w.get_parent(S),h=S.parent().index(),C="jstree-below";break;case"i":_=w.settings.dnd.inside_pos,x=w.get_node(S.parent()),a=s.left-2,l=s.top+c/2+1,d=x.id,h="first"===_?0:"last"===_?x.children.length:Math.min(_,x.children.length),C="jstree-inside";break;case"a":a=s.left-6,l=s.top+c,d=w.get_parent(S),h=S.parent().index()+1,C="jstree-above"}for(f=!0,p=0,g=r.data.nodes.length;p<g;p++)if(m=r.data.origin&&(r.data.origin.settings.dnd.always_copy||r.data.origin.settings.dnd.copy&&(r.event.metaKey||r.event.ctrlKey))?"copy_node":"move_node",v=h,"move_node"==m&&"a"===t&&r.data.origin&&r.data.origin===w&&d===w.get_parent(r.data.nodes[p])&&(y=w.get_node(d),v>O.inArray(r.data.nodes[p],y.children)&&--v),!(f=f&&(w&&w.settings&&w.settings.dnd&&!1===w.settings.dnd.check_while_dragging||w.check(m,r.data.origin&&r.data.origin!==w?r.data.origin.get_node(r.data.nodes[p]):r.data.nodes[p],d,v,{dnd:!0,ref:w.get_node(S.parent()),pos:t,origin:r.data.origin,is_multi:r.data.origin&&r.data.origin!==w,is_foreign:!r.data.origin})))){w&&w.last_error&&(L=w.last_error());break}return"i"===t&&S.parent().is(".jstree-closed")&&w.settings.dnd.open_timeout&&(!r.event||"dragover"!==r.event.type||o)&&(A&&clearTimeout(A),A=setTimeout((i=S,function(){n.open_node(i)}),(n=w).settings.dnd.open_timeout)),f?((k=w.get_node(d,!0)).hasClass(".jstree-dnd-parent")||(O(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),k.addClass("jstree-dnd-parent")),T={ins:w,par:d,pos:"i"!==t||"last"!==_||0!==h||w.is_loaded(x)?h:"last"},M.css({left:a+"px",top:l+"px"}).show(),M.removeClass("jstree-above jstree-inside jstree-below").addClass(C),r.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),r.event.originalEvent&&r.event.originalEvent.dataTransfer&&(r.event.originalEvent.dataTransfer.dropEffect=b?"copy":"move"),L={},!(u=!0)):void 0;var n,i}),!0===u))return}else{for(f=!0,p=0,g=r.data.nodes.length;p<g&&(f=f&&w.check(r.data.origin&&(r.data.origin.settings.dnd.always_copy||r.data.origin.settings.dnd.copy&&(r.event.metaKey||r.event.ctrlKey))?"copy_node":"move_node",r.data.origin&&r.data.origin!==w?r.data.origin.get_node(r.data.nodes[p]):r.data.nodes[p],O.jstree.root,"last",{dnd:!0,ref:w.get_node(O.jstree.root),pos:"i",origin:r.data.origin,is_multi:r.data.origin&&r.data.origin!==w,is_foreign:!r.data.origin}));p++);if(f)return T={ins:w,par:O.jstree.root,pos:"last"},M.hide(),r.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(r.event.originalEvent&&r.event.originalEvent.dataTransfer&&(r.event.originalEvent.dataTransfer.dropEffect=b?"copy":"move"))}O(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),T=!1,r.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),r.event.originalEvent&&r.event.originalEvent.dataTransfer,M.hide()}}).on("dnd_scroll.vakata.jstree",function(e,t){t&&t.data&&t.data.jstree&&(M.hide(),j=T=!1,t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(e,t){if(O(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),A&&clearTimeout(A),t&&t.data&&t.data.jstree){M.hide().detach();var n,i,r=[];if(T){for(n=0,i=t.data.nodes.length;n<i;n++)r[n]=t.data.origin?t.data.origin.get_node(t.data.nodes[n]):t.data.nodes[n];T.ins[t.data.origin&&(t.data.origin.settings.dnd.always_copy||t.data.origin.settings.dnd.copy&&(t.event.metaKey||t.event.ctrlKey))?"copy_node":"move_node"](r,T.par,T.pos,!1,!1,!1,t.data.origin)}else(n=O(t.event.target).closest(".jstree")).length&&L&&L.error&&"check"===L.error&&((n=n.jstree(!0))&&n.settings.core.error.call(this,L));T=j=!1}}).on("keyup.jstree keydown.jstree",function(e,t){(t=O.vakata.dnd._get())&&t.data&&t.data.jstree&&("keyup"===e.type&&27===e.which?(A&&clearTimeout(A),A=j=L=T=!1,M.hide().detach(),O.vakata.dnd._clean()):(t.helper.find(".jstree-copy").first()[t.data.origin&&(t.data.origin.settings.dnd.always_copy||t.data.origin.settings.dnd.copy&&(e.metaKey||e.ctrlKey))?"show":"hide"](),j&&(j.metaKey=e.metaKey,j.ctrlKey=e.ctrlKey,O.vakata.dnd._trigger("move",j))))})}),m={element:!((g=O).vakata.html={div:g("<div></div>"),escape:function(e){return g.vakata.html.div.text(e).html()},strip:function(e){return g.vakata.html.div.empty().append(g.parseHTML(e)).text()}}),target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},g.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function(e,t,n){n===E&&(n=g.vakata.dnd._get()),n.event=t,g(x).triggerHandler("dnd_"+e+".vakata",n)},_get:function(){return{data:m.data,element:m.element,helper:m.helper}},_clean:function(){m.helper&&m.helper.remove(),m.scroll_i&&(clearInterval(m.scroll_i),m.scroll_i=!1),m={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},d=null,g(x).off("mousemove.vakata.jstree touchmove.vakata.jstree",g.vakata.dnd.drag),g(x).off("mouseup.vakata.jstree touchend.vakata.jstree",g.vakata.dnd.stop)},_scroll:function(e){if(!m.scroll_e||!m.scroll_l&&!m.scroll_t)return m.scroll_i&&(clearInterval(m.scroll_i),m.scroll_i=!1),!1;if(!m.scroll_i)return m.scroll_i=setInterval(g.vakata.dnd._scroll,100),!1;if(!0===e)return!1;var t=m.scroll_e.scrollTop(),e=m.scroll_e.scrollLeft();m.scroll_e.scrollTop(t+m.scroll_t*g.vakata.dnd.settings.scroll_speed),m.scroll_e.scrollLeft(e+m.scroll_l*g.vakata.dnd.settings.scroll_speed),t===m.scroll_e.scrollTop()&&e===m.scroll_e.scrollLeft()||g.vakata.dnd._trigger("scroll",m.scroll_e)},start:function(e,t,n){"touchstart"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=x.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),m.is_drag&&g.vakata.dnd.stop({});try{e.currentTarget.unselectable="on",e.currentTarget.onselectstart=function(){return!1},e.currentTarget.style&&(e.currentTarget.style.touchAction="none",e.currentTarget.style.msTouchAction="none",e.currentTarget.style.MozUserSelect="none")}catch(e){}return m.init_x=e.pageX,m.init_y=e.pageY,m.data=t,m.is_down=!0,m.element=e.currentTarget,m.target=e.target,m.is_touch="touchstart"===e.type,!1!==n&&(m.helper=g("<div id='vakata-dnd'></div>").html(n).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),g(x).on("mousemove.vakata.jstree touchmove.vakata.jstree",g.vakata.dnd.drag),g(x).on("mouseup.vakata.jstree touchend.vakata.jstree",g.vakata.dnd.stop),!1},drag:function(n){if("touchmove"===n.type&&n.originalEvent&&n.originalEvent.changedTouches&&n.originalEvent.changedTouches[0]&&(n.pageX=n.originalEvent.changedTouches[0].pageX,n.pageY=n.originalEvent.changedTouches[0].pageY,n.target=x.elementFromPoint(n.originalEvent.changedTouches[0].pageX-window.pageXOffset,n.originalEvent.changedTouches[0].pageY-window.pageYOffset)),m.is_down){if(!m.is_drag){if(!(Math.abs(n.pageX-m.init_x)>(m.is_touch?g.vakata.dnd.settings.threshold_touch:g.vakata.dnd.settings.threshold)||Math.abs(n.pageY-m.init_y)>(m.is_touch?g.vakata.dnd.settings.threshold_touch:g.vakata.dnd.settings.threshold)))return;m.helper&&(m.helper.appendTo(x.body),m.helper_w=m.helper.outerWidth()),m.is_drag=!0,g(m.target).one("click.vakata",!1),g.vakata.dnd._trigger("start",n)}var e,t,i,r,o=!1,s=!1,a=!1,l=!1,c=!1,d=!1;return m.scroll_t=0,m.scroll_l=0,m.scroll_e=!1,g(g(n.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(g(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var e=g(this),t=e.offset();return this.scrollHeight>this.offsetHeight&&(t.top+e.height()-n.pageY<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_t=1),n.pageY-t.top<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(t.left+e.width()-n.pageX<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_l=1),n.pageX-t.left<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_l=-1)),m.scroll_t||m.scroll_l?(m.scroll_e=g(this),!1):void 0}),m.scroll_e||(o=g(x),s=g(window),a=o.height(),e=s.height(),l=o.width(),t=s.width(),i=o.scrollTop(),r=o.scrollLeft(),e<a&&n.pageY-i<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_t=-1),e<a&&e-(n.pageY-i)<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_t=1),t<l&&n.pageX-r<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_l=-1),t<l&&t-(n.pageX-r)<g.vakata.dnd.settings.scroll_proximity&&(m.scroll_l=1),(m.scroll_t||m.scroll_l)&&(m.scroll_e=o)),m.scroll_e&&g.vakata.dnd._scroll(!0),m.helper&&(c=parseInt(n.pageY+g.vakata.dnd.settings.helper_top,10),d=parseInt(n.pageX+g.vakata.dnd.settings.helper_left,10),a&&a<c+25&&(c=a-50),l&&d+m.helper_w>l&&(d=l-(m.helper_w+2)),m.helper.css({left:d+"px",top:c+"px"})),g.vakata.dnd._trigger("move",n),!1}},stop:function(e){var t;return"touchend"===e.type&&e.originalEvent&&e.originalEvent.changedTouches&&e.originalEvent.changedTouches[0]&&(e.pageX=e.originalEvent.changedTouches[0].pageX,e.pageY=e.originalEvent.changedTouches[0].pageY,e.target=x.elementFromPoint(e.originalEvent.changedTouches[0].pageX-window.pageXOffset,e.originalEvent.changedTouches[0].pageY-window.pageYOffset)),m.is_drag?(e.target!==m.target&&g(m.target).off("click.vakata"),g.vakata.dnd._trigger("stop",e)):"touchend"===e.type&&e.target===m.target&&(t=setTimeout(function(){g(e.target).click()},100),g(e.target).one("click",function(){t&&clearTimeout(t)})),g.vakata.dnd._clean(),!1}},O.jstree.defaults.massload=null,O.jstree.plugins.massload=function(e,d){this.init=function(e,t){this._data.massload={},d.init.call(this,e,t)},this._load_nodes=function(o,s,a,l){var e,t,c,n=this.settings.massload,i=[],r=this._model.data;if(!a){for(e=0,t=o.length;e<t;e++)r[o[e]]&&(r[o[e]].state.loaded||r[o[e]].state.failed)&&!l||(i.push(o[e]),(c=this.get_node(o[e],!0))&&c.length&&c.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},i.length){if(O.isFunction(n))return n.call(this,i,O.proxy(function(e){var t,n;if(e)for(t in e)e.hasOwnProperty(t)&&(this._data.massload[t]=e[t]);for(t=0,n=o.length;t<n;t++)(c=this.get_node(o[t],!0))&&c.length&&c.removeClass("jstree-loading").attr("aria-busy",!1);d._load_nodes.call(this,o,s,a,l)},this));if("object"==typeof n&&n&&n.url)return n=O.extend(!0,{},n),O.isFunction(n.url)&&(n.url=n.url.call(this,i)),O.isFunction(n.data)&&(n.data=n.data.call(this,i)),O.ajax(n).done(O.proxy(function(e,t,n){var i,r;if(e)for(i in e)e.hasOwnProperty(i)&&(this._data.massload[i]=e[i]);for(i=0,r=o.length;i<r;i++)(c=this.get_node(o[i],!0))&&c.length&&c.removeClass("jstree-loading").attr("aria-busy",!1);d._load_nodes.call(this,o,s,a,l)},this)).fail(O.proxy(function(e){d._load_nodes.call(this,o,s,a,l)},this))}}return d._load_nodes.call(this,o,s,a,l)},this._load_node=function(e,t){var n,i=this._data.massload[e.id];return i?(n=this["string"==typeof i?"_append_html_data":"_append_json_data"](e,"string"==typeof i?O(O.parseHTML(i)).filter(function(){return 3!==this.nodeType}):i,function(e){t.call(this,e)}),(i=this.get_node(e.id,!0))&&i.length&&i.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[e.id],n):d._load_node.call(this,e,t)}},O.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},O.jstree.plugins.search=function(e,a){this.bind=function(){a.bind.call(this),this._data.search.str="",this._data.search.dom=O(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=!1,this._data.search.smc=!1,this._data.search.hdn=[],this.element.on("search.jstree",O.proxy(function(e,t){if(this._data.search.som&&t.res.length){for(var n,i,r=this._model.data,o=[],s=0,a=t.res.length;s<a;s++)if(r[t.res[s]]&&!r[t.res[s]].state.hidden&&(o.push(t.res[s]),o=o.concat(r[t.res[s]].parents),this._data.search.smc))for(n=0,i=r[t.res[s]].children_d.length;n<i;n++)r[r[t.res[s]].children_d[n]]&&!r[r[t.res[s]].children_d[n]].state.hidden&&o.push(r[t.res[s]].children_d[n]);o=O.vakata.array_remove_item(O.vakata.array_unique(o),O.jstree.root),this._data.search.hdn=this.hide_all(!0),this.show_node(o,!0),this.redraw(!0)}},this)).on("clear_search.jstree",O.proxy(function(e,t){this._data.search.som&&t.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))},this))},this.search=function(i,e,t,n,r,o){if(!1===i||""===O.vakata.trim(i.toString()))return this.clear_search();n=(n=this.get_node(n))&&n.id?n.id:null,i=i.toString();var s,a,l=this.settings.search,c=l.ajax||!1,d=this._model.data,h=null,u=[],f=[];if(this._data.search.res.length&&!r&&this.clear_search(),t===E&&(t=l.show_only_matches),o===E&&(o=l.show_only_matches_children),!e&&!1!==c)return O.isFunction(c)?c.call(this,i,O.proxy(function(e){e&&e.d&&(e=e.d),this._load_nodes(O.isArray(e)?O.vakata.array_unique(e):[],function(){this.search(i,!0,t,n,r,o)})},this),n):((c=O.extend({},c)).data||(c.data={}),c.data.str=i,n&&(c.data.inside=n),this._data.search.lastRequest&&this._data.search.lastRequest.abort(),this._data.search.lastRequest=O.ajax(c).fail(O.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(c)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(O.proxy(function(e){e&&e.d&&(e=e.d),this._load_nodes(O.isArray(e)?O.vakata.array_unique(e):[],function(){this.search(i,!0,t,n,r,o)})},this)),this._data.search.lastRequest);if(r||(this._data.search.str=i,this._data.search.dom=O(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=t,this._data.search.smc=o),h=new O.vakata.search(i,!0,{caseSensitive:l.case_sensitive,fuzzy:l.fuzzy}),O.each(d[n||O.jstree.root].children_d,function(e,t){var n=d[t];n.text&&!n.state.hidden&&(!l.search_leaves_only||n.state.loaded&&0===n.children.length)&&(l.search_callback&&l.search_callback.call(this,i,n)||!l.search_callback&&h.search(n.text).isMatch)&&(u.push(t),f=f.concat(n.parents))}),u.length){for(s=0,a=(f=O.vakata.array_unique(f)).length;s<a;s++)f[s]!==O.jstree.root&&d[f[s]]&&!0===this.open_node(f[s],null,0)&&this._data.search.opn.push(f[s]);r?(this._data.search.dom=this._data.search.dom.add(O(this.element[0].querySelectorAll("#"+O.map(u,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(O.jstree.idregex,"\\$&"):e.replace(O.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=O.vakata.array_unique(this._data.search.res.concat(u))):(this._data.search.dom=O(this.element[0].querySelectorAll("#"+O.map(u,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(O.jstree.idregex,"\\$&"):e.replace(O.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=u),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:i,res:this._data.search.res,show_only_matches:t})},this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.res.length&&(this._data.search.dom=O(this.element[0].querySelectorAll("#"+O.map(this._data.search.res,function(e){return-1!=="0123456789".indexOf(e[0])?"\\3"+e[0]+" "+e.substr(1).replace(O.jstree.idregex,"\\$&"):e.replace(O.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search")),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=O()},this.redraw_node=function(e,t,n,i){if((e=a.redraw_node.apply(this,arguments))&&-1!==O.inArray(e.id,this._data.search.res)){for(var r=null,o=0,s=e.childNodes.length;o<s;o++)if(e.childNodes[o]&&e.childNodes[o].className&&-1!==e.childNodes[o].className.indexOf("jstree-anchor")){r=e.childNodes[o];break}r&&(r.className+=" jstree-search")}return e}},(p=O).vakata.search=function(m,e,v){v=v||{},!1!==(v=p.extend({},p.vakata.search.defaults,v)).fuzzy&&(v.fuzzy=!0),m=v.caseSensitive?m:m.toLowerCase();var y,_,x,t,b=v.location,n=v.distance,k=v.threshold,C=m.length;return 32<C&&(v.fuzzy=!1),v.fuzzy&&(y=1<<C-1,_=function(){for(var e={},t=0,t=0;t<C;t++)e[m.charAt(t)]=0;for(t=0;t<C;t++)e[m.charAt(t)]|=1<<C-t-1;return e}(),x=function(e,t){e/=C,t=Math.abs(b-t);return n?e+t/n:t?1:e}),t=function(e){if(e=v.caseSensitive?e:e.toLowerCase(),m===e||-1!==e.indexOf(m))return{isMatch:!0,score:0};if(!v.fuzzy)return{isMatch:!1,score:1};var t,n,i,r,o,s,a,l,c,d=e.length,h=k,u=e.indexOf(m,b),f=C+d,p=1,g=[];for(-1!==u&&(h=Math.min(x(0,u),h),-1!==(u=e.lastIndexOf(m,b+C))&&(h=Math.min(x(0,u),h))),u=-1,t=0;t<C;t++){for(i=0,r=f;i<r;)x(t,b+r)<=h?i=r:f=r,r=Math.floor((f-i)/2+i);for(f=r,s=Math.max(1,b-r+1),a=Math.min(b+r,d)+C,(l=new Array(a+2))[a+1]=(1<<t)-1,n=a;s<=n;n--)if(c=_[e.charAt(n-1)],l[n]=0===t?(l[n+1]<<1|1)&c:(l[n+1]<<1|1)&c|(o[n+1]|o[n])<<1|1|o[n+1],l[n]&y&&(p=x(t,n-1))<=h){if(h=p,u=n-1,g.push(u),!(b<u))break;s=Math.max(1,2*b-u)}if(x(t+1,b)>h)break;o=l}return{isMatch:0<=u,score:p}},!0===e?{search:t}:t(e)},p.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1},O.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1};var u=!(O.jstree.plugins.sort=function(e,t){this.bind=function(){t.bind.call(this),this.element.on("model.jstree",O.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",O.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",O.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(e,t){var n,i;if((e=this.get_node(e))&&e.children&&e.children.length&&(e.children.sort(O.proxy(this.settings.sort,this)),t))for(n=0,i=e.children_d.length;n<i;n++)this.sort(e.children_d[n],!1)}});O.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1,preserve_loaded:!1},O.jstree.plugins.state=function(e,t){this.bind=function(){t.bind.call(this);var n=O.proxy(function(){this.element.on(this.settings.state.events,O.proxy(function(){u&&clearTimeout(u),u=setTimeout(O.proxy(function(){this.save_state()},this),100)},this)),this.trigger("state_ready")},this);this.element.on("ready.jstree",O.proxy(function(e,t){this.element.one("restore_state.jstree",n),this.restore_state()||n()},this))},this.save_state=function(){var e=this.get_state();this.settings.state.preserve_loaded||delete e.core.loaded;e={state:e,ttl:this.settings.state.ttl,sec:+new Date};O.vakata.storage.set(this.settings.state.key,JSON.stringify(e))},this.restore_state=function(){var n=O.vakata.storage.get(this.settings.state.key);if(n)try{n=JSON.parse(n)}catch(e){return!1}return!(n&&n.ttl&&n.sec&&+new Date-n.sec>n.ttl)&&(n&&n.state&&(n=n.state),n&&O.isFunction(this.settings.state.filter)&&(n=this.settings.state.filter.call(this,n)),!!n&&(this.settings.state.preserve_loaded||delete n.core.loaded,this.element.one("set_state.jstree",function(e,t){t.instance.trigger("restore_state",{state:O.extend(!0,{},n)})}),this.set_state(n),!0))},this.clear_state=function(){return O.vakata.storage.del(this.settings.state.key)}},O.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}},O.jstree.defaults.types={default:{}},O.jstree.defaults.types[O.jstree.root]={},O.jstree.plugins.types=function(e,d){this.init=function(e,t){var n,i;if(t&&t.types&&t.types.default)for(n in t.types)if("default"!==n&&n!==O.jstree.root&&t.types.hasOwnProperty(n))for(i in t.types.default)t.types.default.hasOwnProperty(i)&&t.types[n][i]===E&&(t.types[n][i]=t.types.default[i]);d.init.call(this,e,t),this._model.data[O.jstree.root].type=O.jstree.root},this.refresh=function(e,t){d.refresh.call(this,e,t),this._model.data[O.jstree.root].type=O.jstree.root},this.bind=function(){this.element.on("model.jstree",O.proxy(function(e,t){for(var n,i=this._model.data,r=t.nodes,o=this.settings.types,s="default",a=0,l=r.length;a<l;a++){if(s="default",i[r[a]].original&&i[r[a]].original.type&&o[i[r[a]].original.type]&&(s=i[r[a]].original.type),i[r[a]].data&&i[r[a]].data.jstree&&i[r[a]].data.jstree.type&&o[i[r[a]].data.jstree.type]&&(s=i[r[a]].data.jstree.type),i[r[a]].type=s,!0===i[r[a]].icon&&o[s].icon!==E&&(i[r[a]].icon=o[s].icon),o[s].li_attr!==E&&"object"==typeof o[s].li_attr)for(n in o[s].li_attr)if(o[s].li_attr.hasOwnProperty(n)){if("id"===n)continue;i[r[a]].li_attr[n]===E?i[r[a]].li_attr[n]=o[s].li_attr[n]:"class"===n&&(i[r[a]].li_attr.class=o[s].li_attr.class+" "+i[r[a]].li_attr.class)}if(o[s].a_attr!==E&&"object"==typeof o[s].a_attr)for(n in o[s].a_attr)if(o[s].a_attr.hasOwnProperty(n)){if("id"===n)continue;i[r[a]].a_attr[n]===E?i[r[a]].a_attr[n]=o[s].a_attr[n]:"href"===n&&"#"===i[r[a]].a_attr[n]?i[r[a]].a_attr.href=o[s].a_attr.href:"class"===n&&(i[r[a]].a_attr.class=o[s].a_attr.class+" "+i[r[a]].a_attr.class)}}i[O.jstree.root].type=O.jstree.root},this)),d.bind.call(this)},this.get_json=function(e,t,n){var i,r,o=this._model.data,s=t?O.extend(!0,{},t,{no_id:!1}):{},a=d.get_json.call(this,e,s,n);if(!1===a)return!1;if(O.isArray(a))for(i=0,r=a.length;i<r;i++)a[i].type=a[i].id&&o[a[i].id]&&o[a[i].id].type?o[a[i].id].type:"default",t&&t.no_id&&(delete a[i].id,a[i].li_attr&&a[i].li_attr.id&&delete a[i].li_attr.id,a[i].a_attr&&a[i].a_attr.id&&delete a[i].a_attr.id);else a.type=a.id&&o[a.id]&&o[a.id].type?o[a.id].type:"default",t&&t.no_id&&(a=this._delete_ids(a));return a},this._delete_ids=function(e){if(O.isArray(e)){for(var t=0,n=e.length;t<n;t++)e[t]=this._delete_ids(e[t]);return e}return delete e.id,e.li_attr&&e.li_attr.id&&delete e.li_attr.id,e.a_attr&&e.a_attr.id&&delete e.a_attr.id,e.children&&O.isArray(e.children)&&(e.children=this._delete_ids(e.children)),e},this.check=function(e,t,n,i,r){if(!1===d.check.call(this,e,t,n,i,r))return!1;t=t&&t.id?t:this.get_node(t),n=n&&n.id?n:this.get_node(n);var o,s,a,l,c=(c=t&&t.id?r&&r.origin?r.origin:O.jstree.reference(t.id):null)&&c._model&&c._model.data?c._model.data:null;switch(e){case"create_node":case"move_node":case"copy_node":if("move_node"!==e||-1===O.inArray(t.id,n.children)){if((o=this.get_rules(n)).max_children!==E&&-1!==o.max_children&&o.max_children===n.children.length)return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!n||!n.id)&&n.id})});if(o.valid_children!==E&&-1!==o.valid_children&&-1===O.inArray(t.type||"default",o.valid_children))return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!n||!n.id)&&n.id})});if(c&&t.children_d&&t.parents){for(a=s=0,l=t.children_d.length;a<l;a++)s=Math.max(s,c[t.children_d[a]].parents.length);s=s-t.parents.length+1}(s<=0||s===E)&&(s=1);do{if(o.max_depth!==E&&-1!==o.max_depth&&o.max_depth<s)return!(this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!n||!n.id)&&n.id})})}while(n=this.get_node(n.parent),o=this.get_rules(n),s++,n)}}return!0},this.get_rules=function(e){if(!(e=this.get_node(e)))return!1;e=this.get_type(e,!0);return e.max_depth===E&&(e.max_depth=-1),e.max_children===E&&(e.max_children=-1),e.valid_children===E&&(e.valid_children=-1),e},this.get_type=function(e,t){return!!(e=this.get_node(e))&&(t?O.extend({type:e.type},this.settings.types[e.type]):e.type)},this.set_type=function(e,t){var n,i,r,o,s,a,l,c,d=this._model.data;if(O.isArray(e)){for(i=0,r=(e=e.slice()).length;i<r;i++)this.set_type(e[i],t);return!0}if(n=this.settings.types,e=this.get_node(e),!n[t]||!e)return!1;if((l=this.get_node(e,!0))&&l.length&&(c=l.children(".jstree-anchor")),o=e.type,s=this.get_icon(e),e.type=t,!0!==s&&n[o]&&(n[o].icon===E||s!==n[o].icon)||this.set_icon(e,n[t].icon===E||n[t].icon),n[o]&&n[o].li_attr!==E&&"object"==typeof n[o].li_attr)for(a in n[o].li_attr)if(n[o].li_attr.hasOwnProperty(a)){if("id"===a)continue;"class"===a?(d[e.id].li_attr.class=(d[e.id].li_attr.class||"").replace(n[o].li_attr[a],""),l&&l.removeClass(n[o].li_attr[a])):d[e.id].li_attr[a]===n[o].li_attr[a]&&(d[e.id].li_attr[a]=null,l&&l.removeAttr(a))}if(n[o]&&n[o].a_attr!==E&&"object"==typeof n[o].a_attr)for(a in n[o].a_attr)if(n[o].a_attr.hasOwnProperty(a)){if("id"===a)continue;"class"===a?(d[e.id].a_attr.class=(d[e.id].a_attr.class||"").replace(n[o].a_attr[a],""),c&&c.removeClass(n[o].a_attr[a])):d[e.id].a_attr[a]===n[o].a_attr[a]&&("href"===a?(d[e.id].a_attr[a]="#",c&&c.attr("href","#")):(delete d[e.id].a_attr[a],c&&c.removeAttr(a)))}if(n[t].li_attr!==E&&"object"==typeof n[t].li_attr)for(a in n[t].li_attr)if(n[t].li_attr.hasOwnProperty(a)){if("id"===a)continue;d[e.id].li_attr[a]===E?(d[e.id].li_attr[a]=n[t].li_attr[a],l&&("class"===a?l.addClass(n[t].li_attr[a]):l.attr(a,n[t].li_attr[a]))):"class"===a&&(d[e.id].li_attr.class=n[t].li_attr[a]+" "+d[e.id].li_attr.class,l&&l.addClass(n[t].li_attr[a]))}if(n[t].a_attr!==E&&"object"==typeof n[t].a_attr)for(a in n[t].a_attr)if(n[t].a_attr.hasOwnProperty(a)){if("id"===a)continue;d[e.id].a_attr[a]===E?(d[e.id].a_attr[a]=n[t].a_attr[a],c&&("class"===a?c.addClass(n[t].a_attr[a]):c.attr(a,n[t].a_attr[a]))):"href"===a&&"#"===d[e.id].a_attr[a]?(d[e.id].a_attr.href=n[t].a_attr.href,c&&c.attr("href",n[t].a_attr.href)):"class"===a&&(d[e.id].a_attr.class=n[t].a_attr.class+" "+d[e.id].a_attr.class,c&&c.addClass(n[t].a_attr[a]))}return!0}},O.jstree.defaults.unique={case_sensitive:!1,trim_whitespace:!1,duplicate:function(e,t){return e+" ("+t+")"}},O.jstree.plugins.unique=function(e,g){this.check=function(e,t,n,i,r){if(!1===g.check.call(this,e,t,n,i,r))return!1;if(t=t&&t.id?t:this.get_node(t),!(n=n&&n.id?n:this.get_node(n))||!n.children)return!0;for(var o,s="rename_node"===e?i:t.text,a=[],l=this.settings.unique.case_sensitive,c=this.settings.unique.trim_whitespace,d=this._model.data,h=0,u=n.children.length;h<u;h++)o=d[n.children[h]].text,l||(o=o.toLowerCase()),c&&(o=o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),a.push(o);switch(l||(s=s.toLowerCase()),c&&(s=s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),e){case"delete_node":return!0;case"rename_node":return o=t.text||"",l||(o=o.toLowerCase()),c&&(o=o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),(h=-1===O.inArray(s,a)||t.text&&o===s)||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+s+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!n||!n.id)&&n.id})}),h;case"create_node":return(h=-1===O.inArray(s,a))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+s+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!n||!n.id)&&n.id})}),h;case"copy_node":return(h=-1===O.inArray(s,a))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+s+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!n||!n.id)&&n.id})}),h;case"move_node":return(h=t.parent===n.id&&(!r||!r.is_multi)||-1===O.inArray(s,a))||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+s+" already exists. Preventing: "+e,data:JSON.stringify({chk:e,pos:i,obj:!(!t||!t.id)&&t.id,par:!(!n||!n.id)&&n.id})}),h}return!0},this.create_node=function(e,t,n,i,r){if(!t||t.text===E){if(null===e&&(e=O.jstree.root),!(e=this.get_node(e)))return g.create_node.call(this,e,t,n,i,r);if(!(n=n===E?"last":n).toString().match(/^(before|after)$/)&&!r&&!this.is_loaded(e))return g.create_node.call(this,e,t,n,i,r);t=t||{};for(var o,s,a=this._model.data,l=this.settings.unique.case_sensitive,c=this.settings.unique.trim_whitespace,d=this.settings.unique.duplicate,h=o=this.get_string("New node"),u=[],f=0,p=e.children.length;f<p;f++)s=a[e.children[f]].text,l||(s=s.toLowerCase()),c&&(s=s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),u.push(s);for(f=1,s=h,l||(s=s.toLowerCase()),c&&(s=s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));-1!==O.inArray(s,u);)s=h=d.call(this,o,++f).toString(),l||(s=s.toLowerCase()),c&&(s=s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));t.text=h}return g.create_node.call(this,e,t,n,i,r)}};var f=x.createElement("DIV");if(f.setAttribute("unselectable","on"),f.setAttribute("role","presentation"),f.className="jstree-wholerow",f.innerHTML="&#160;",O.jstree.plugins.wholerow=function(e,o){this.bind=function(){o.bind.call(this),this.element.on("ready.jstree set_state.jstree",O.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",O.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",O.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",O.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");for(var n=!1,i=0,r=t.selected.length;i<r;i++)(n=this.get_node(t.selected[i],!0))&&n.length&&n.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",O.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",O.proxy(function(e,t){"hover_node"===e.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",O.proxy(function(e){var t;this._data.contextmenu&&(e.preventDefault(),t=O.Event("contextmenu",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,pageX:e.pageX,pageY:e.pageY}),O(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t))},this)).on("click.jstree",".jstree-wholerow",function(e){e.stopImmediatePropagation();var t=O.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});O(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t).focus()}).on("dblclick.jstree",".jstree-wholerow",function(e){e.stopImmediatePropagation();var t=O.Event("dblclick",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});O(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",O.proxy(function(e){e.stopImmediatePropagation();var t=O.Event("click",{metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey});O(e.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(t).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",O.proxy(function(e){return e.stopImmediatePropagation(),this.is_disabled(e.currentTarget)||this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",O.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),o.teardown.call(this)},this.redraw_node=function(e,t,n,i){var r;return(e=o.redraw_node.apply(this,arguments))&&(r=f.cloneNode(!0),-1!==O.inArray(e.id,this._data.core.selected)&&(r.className+=" jstree-wholerow-clicked"),this._data.core.focused&&this._data.core.focused===e.id&&(r.className+=" jstree-wholerow-hovered"),e.insertBefore(r,e.childNodes[0])),e}},window.customElements&&Object&&Object.create){var t=Object.create(HTMLElement.prototype);t.createdCallback=function(){var e,t={core:{},plugins:[]};for(e in O.jstree.plugins)O.jstree.plugins.hasOwnProperty(e)&&this.attributes[e]&&(t.plugins.push(e),this.getAttribute(e)&&JSON.parse(this.getAttribute(e))&&(t[e]=JSON.parse(this.getAttribute(e))));for(e in O.jstree.defaults.core)O.jstree.defaults.core.hasOwnProperty(e)&&this.attributes[e]&&(t.core[e]=JSON.parse(this.getAttribute(e))||this.getAttribute(e));O(this).jstree(t)};try{window.customElements.define("vakata-jstree",function(){},{prototype:t})}catch(e){}}}var p,g,m,v,y,_}),function(){var a={};"undefined"!=typeof exports?module.exports=a:this.fuzzy=a,a.simpleFilter=function(t,e){return e.filter(function(e){return a.test(t,e)})},a.test=function(e,t){return null!==a.match(e,t)},a.match=function(e,t,n){n=n||{};var i,r=0,o=[],s=t.length,a=0,l=0,c=n.pre||"",d=n.post||"",h=n.caseSensitive&&t||t.toLowerCase();e=n.caseSensitive&&e||e.toLowerCase();for(var u=0;u<s;u++)i=t[u],h[u]===e[r]?(i=c+i+d,r+=1,l+=1+l):l=0,a+=l,o[o.length]=i;return r===e.length?(a=h===e?1/0:a,{rendered:o.join(""),score:a}):null},a.filter=function(o,e,s){return e&&0!==e.length?"string"!=typeof o?e:(s=s||{},e.reduce(function(e,t,n,i){var r=t;s.extract&&(r=s.extract(t));r=a.match(o,r,s);return null!=r&&(e[e.length]={string:r.rendered,score:r.score,index:n,original:t}),e},[]).sort(function(e,t){var n=t.score-e.score;return n||e.index-t.index})):[]}}(),function(e,t){"function"==typeof define&&define.amd?define([],t):"undefined"!=typeof module&&module.exports?module.exports=t():e.ReconnectingWebSocket=t()}(this,function(){function h(e,i,t){function r(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}var n,o={debug:!1,automaticOpen:!0,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3};for(n in t=t||{},o)this[n]=(void 0!==t[n]?t:o)[n];this.url=e,this.reconnectAttempts=0,this.readyState=WebSocket.CONNECTING,this.protocol=null;var s,a=this,l=!1,c=!1,d=document.createElement("div");d.addEventListener("open",function(e){a.onopen(e)}),d.addEventListener("close",function(e){a.onclose(e)}),d.addEventListener("connecting",function(e){a.onconnecting(e)}),d.addEventListener("message",function(e){a.onmessage(e)}),d.addEventListener("error",function(e){a.onerror(e)}),this.addEventListener=d.addEventListener.bind(d),this.removeEventListener=d.removeEventListener.bind(d),this.dispatchEvent=d.dispatchEvent.bind(d),this.open=function(n){s=new WebSocket(a.url,i||[]),n||d.dispatchEvent(r("connecting")),(a.debug||h.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",a.url);var e=s,t=setTimeout(function(){(a.debug||h.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",a.url),c=!0,e.close(),c=!1},a.timeoutInterval);s.onopen=function(){clearTimeout(t),(a.debug||h.debugAll)&&console.debug("ReconnectingWebSocket","onopen",a.url),a.protocol=s.protocol,a.readyState=WebSocket.OPEN,a.reconnectAttempts=0;var e=r("open");e.isReconnect=n,n=!1,d.dispatchEvent(e)},s.onclose=function(e){var t;clearTimeout(void 0),s=null,l?(a.readyState=WebSocket.CLOSED,d.dispatchEvent(r("close"))):(a.readyState=WebSocket.CONNECTING,(t=r("connecting")).code=e.code,t.reason=e.reason,t.wasClean=e.wasClean,d.dispatchEvent(t),n||c||((a.debug||h.debugAll)&&console.debug("ReconnectingWebSocket","onclose",a.url),d.dispatchEvent(r("close"))),t=a.reconnectInterval*Math.pow(a.reconnectDecay,a.reconnectAttempts),setTimeout(function(){a.reconnectAttempts++,a.open(!0)},t>a.maxReconnectInterval?a.maxReconnectInterval:t))},s.onmessage=function(e){(a.debug||h.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",a.url,e.data);var t=r("message");t.data=e.data,d.dispatchEvent(t)},s.onerror=function(e){(a.debug||h.debugAll)&&console.debug("ReconnectingWebSocket","onerror",a.url,e),d.dispatchEvent(r("error"))}},1==this.automaticOpen&&this.open(!1),this.send=function(e){if(s)return(a.debug||h.debugAll)&&console.debug("ReconnectingWebSocket","send",a.url,e),s.send(e);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"},this.close=function(e,t){void 0===e&&(e=1e3),l=!0,s&&s.close(e,t)},this.refresh=function(){s&&s.close()}}return h.prototype.onopen=function(){},h.prototype.onclose=function(){},h.prototype.onconnecting=function(){},h.prototype.onmessage=function(){},h.prototype.onerror=function(){},h.debugAll=!1,h.CONNECTING=WebSocket.CONNECTING,h.OPEN=WebSocket.OPEN,h.CLOSING=WebSocket.CLOSING,h.CLOSED=WebSocket.CLOSED,h}),function(){var o,s=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};o=function(c,a,d,i,t,h){return c.widget("hr.codeshell",{options:{},_options:{showFileTree:!1,adminView:!1,enableIntellisense:!1,enableLiveAutocomplete:!1,intellisenseTooltipText:"Available only for C, C++, Java, Python, JavaScript, Ruby, PHP, C# and Go",inReact:!1,enableLiveAutocompleteLinting:!1,showSave:!1,showCustomInput:!0,showNewCustomInput:!1,showExecute:!1,showCompileTest:!0,compilePrimary:!1,showSubmit:!1,submitPrimary:!0,showUploadCode:!1,uploadCodeText:"Upload Code as File",showDownloadCode:!1,downloadCodeText:"Download Code as File",showNotification:!1,notificationMessage:"",showFullScreen:!1,showSettings:!0,showLanguageDropdown:!0,layout:0,statusText:"",showTheme:!1,showMode:!0,showHeader:!0,showNonEditableHeadTail:!1,enableVersioning:!1,versionIds:[],versioningRestUrl:"",foldCode:!1,enableLanguageChangeHook:!1,dynamicMode:!1,focusLogged:!1,customSetting:null,customToolBar:null,completionManualTriggered:!1,languages:["c","cpp","java","csharp","haskell","php","python","perl","ruby","bash","oracle","mysql","sql","clojure","scala","code","text","brainfuck","javascript","typescript","d","go","lua","erlang","sbcl","ocaml","pascal","python3","groovy","text_pseudo","objectivec","fsharp","visualbasic","cobol","tsql","lolcode","smalltalk","tcl","html","css","java8","java15","db2","octave","r","xquery","racket","xml","rust","swift","fortran","elixir","ada","nim","julia","pypy","pypy3","cpp14","cpp20","coffeescript","kotlin","dart","verilog"],defaultLanguage:"cpp",initialCode:null,initialLanguage:null,showTemplate:!0,forumMkdTool:!1,firepad:null,autoSaveNamespace:null,autoSaveTTL:null,onSave:null,autoSave:null,firstLineNumber:1,enableTrackTyping:!1,typingTimespan:180,execute_button_text:"Execute Code",compile_button_text:"Run Code",submit_button_text:"Submit Code",submit_button_sub_text:null,lang_head_template:{},lang_tail_template:{},lang_template:{},diagnostics:[],lineCount:0,isNewLineKeyPress:!0,lang_mime_mapping:{c:"text/x-csrc",cpp:"text/x-c++src",java:"text/x-java",csharp:"text/x-csharp",haskell:"text/x-haskell",php:"text/x-php",python:"text/x-python",pypy:"text/x-python",pypy3:"text/x-python",perl:"text/x-perl",ruby:"text/x-ruby",bash:"text/x-sh",clojure:"text/x-clojure",scala:"text/x-scala",code:"text/plain",text:"text/plain",brainfuck:"text/x-brainfuck",javascript:"text/javascript",typescript:"text/typescript",d:"text/x-d",go:"text/x-go",lua:"text/x-lua",erlang:"text/x-erlang",sbcl:"text/x-common-lisp",ocaml:"text/x-ocaml",pascal:"text/x-pascal",python3:"text/x-python",groovy:"text/x-groovy",text_pseudo:"text/plain",objectivec:"text/x-objectivec",fsharp:"text/x-fsharp",visualbasic:"text/x-vb",cobol:"text/x-cobol",smalltalk:"text/x-stsrc",tcl:"text/x-tcl",html:"text/html",css:"text/css",java8:"text/x-java",java15:"text/x-java",kotlin:"text/x-kotlin",db2:"text/x-plsql",octave:"text/x-octave",r:"text/x-rsrc",xquery:"application/xquery",racket:"text/x-scheme",xml:"text/xml",rust:"text/x-rustsrc",swift:"text/x-swift",elixir:"text/x-elixir",fortran:"text/x-fortran",ada:"text/x-adasrc",nim:"text/nim",julia:"text/x-julia",oracle:"text/x-plsql",tsql:"text/x-plsql",mysql:"text/x-plsql",sql:"text/x-plsql",cpp14:"text/x-c++src",cpp20:"text/x-c++src",coffeescript:"text/x-coffeescript",dart:"text/x-dart",verilog:"text/x-verilog"},lang_display_mapping:{c:"C",cpp:"C++",java:"Java 7",csharp:"C#",haskell:"Haskell",php:"PHP",python:"Python 2",pypy:"Pypy 2",pypy3:"Pypy 3",ruby:"Ruby",perl:"Perl",bash:"BASH",oracle:"Oracle",mysql:"MySQL",sql:"SQL",clojure:"Clojure",scala:"Scala",code:"Generic",text:"Plain Text",brainfuck:"Brainf**k",javascript:"JavaScript (Node.js)",typescript:"TypeScript",lua:"Lua",sbcl:"Common Lisp (SBCL)",erlang:"Erlang",go:"Go",d:"D",ocaml:"OCaml",pascal:"Pascal",python3:"Python 3",groovy:"Groovy",objectivec:"Objective-C",text_pseudo:"Plain Text",fsharp:"F#",visualbasic:"VB.NET",cobol:"COBOL",tsql:"MS SQL Server",lolcode:"LOLCODE",smalltalk:"Smalltalk",tcl:"Tcl",whitespace:"Whitespace",css:"CSS",html:"HTML",java8:"Java 8",java15:"Java 15",kotlin:"Kotlin",db2:"DB2",octave:"Octave",r:"R",xquery:"XQuery",racket:"Racket",xml:"XML",rust:"Rust",swift:"Swift",elixir:"Elixir",fortran:"Fortran",ada:"Ada",nim:"Nim",julia:"Julia",cpp14:"C++14",cpp20:"C++20",coffeescript:"CoffeeScript",dart:"Dart",verilog:"Verilog"},default_head_end:{c:"/* Head ends here */",cpp:"/* Head ends here */",java:"/* Head ends here */",csharp:"/* Head ends here */",haskell:"-- Head ends here",php:"/* Head ends here */",python:"# Head ends here",pypy:"# Head ends here",pypy3:"# Head ends here",perl:"# Head ends here",ruby:"# Head ends here",bash:"# Head ends here",clojure:"; Head ends here",scala:"/* Head ends here */",sbcl:"; Head ends here",lua:"-- Head ends here",javascript:"/* Head ends here */",typescript:"/* Head ends here */",pascal:"{ Head ends here }",python3:"# Head ends here",groovy:"// Head ends here",objectivec:"// Head ends here",fsharp:"// Head ends here",visualbasic:"' Head ends here",cobol:"* Head ends here",lolcode:"BTW Head ends here",smalltalk:'" Head ends here"',tcl:"# Head ends here",whitespace:"Head ends here",html:"\x3c!-- Head ends here --\x3e",css:"/* Head ends here */",java8:"/* Head ends here */",java15:"/* Head ends here */",kotlin:"/* Head ends here */",db2:"/* Head ends here */",octave:"# Head ends here",r:"# Head ends here",xquery:"(: Head ends here :)",racket:"; Head ends here",xml:"\x3c!-- Head ends here --\x3e",rust:"// Head ends here",elixir:"# Head ends here",fortran:"! Head ends here",ada:"-- Head ends here",nim:"# Head ends here",julia:"# Head ends here",cpp14:"/* Head ends here */",cpp20:"/* Head ends here */",coffeescript:"# Head ends here",dart:"/* Head ends here */",verilog:"/* Head ends here */"},lang_fold_mapping:{c:"brace",cpp:"brace",java:"brace",csharp:"brace",haskell:"indent",php:"brace",python:"indent",pypy:"indent",pypy3:"indent",ruby:"indent",perl:"brace",bash:"brace",oracle:"indent",mysql:"indent",sql:"indent",clojure:"indent",scala:"brace",code:"brace",text:"indent",brainfuck:"indent",javascript:"brace",typescript:"brace",lua:"indent",sbcl:"indent",erlang:"indent",go:"brace",d:"brace",ocaml:"indent",pascal:"indent",python3:"indent",groovy:"brace",objectivec:"brace",text_pseudo:"indent",fsharp:"indent",visualbasic:"indent",cobol:"indent",lolcode:"indent",smalltalk:"indent",tcl:"brace",whitespace:"indent",html:"tag",css:"brace",java8:"brace",java15:"brace",kotlin:"brace",db2:"indent",octave:"indent",r:"brace",xquery:"indent",racket:"brace",xml:"tag",rust:"brace",swift:"brace",elixir:"indent",fortran:"indent",ada:"indent",nim:"indent",julia:"indent",cpp14:"brace",cpp20:"brace",coffeescript:"indent",dart:"brace",verilog:"indent"},default_tail_start:{c:"/* Tail starts here */",cpp:"/* Tail starts here */",java:"/* Tail starts here */",csharp:"/* Tail starts here */",haskell:"-- Tail starts here",php:"/* Tail starts here */",python:"# Tail starts here",pypy:"# Tail starts here",pypy3:"# Tail starts here",perl:"# Tail starts here",ruby:"# Tail starts here",bash:"# Tail starts here",clojure:"; Tail starts here",scala:"/* Tail starts here */",sbcl:"; Tail starts here",lua:"-- Tail starts here",javascript:"/* Tail starts here */",typescript:"/* Tail starts here */",pascal:"{ Tail starts here }",python3:"# Tail starts here",groovy:"// Tail starts here",objectivec:"// Tail starts here",fsharp:"// Tail starts here",visualbasic:"' Tail starts here",cobol:"* Tail starts here",lolcode:"BTW Tail starts here",smalltalk:'" Tail starts here"',tcl:"# Tail starts here",whitespace:"Tail starts here",html:"\x3c!-- Tail starts here --\x3e",css:"/* Tails starts here */",java8:"/* Tail starts here */",java15:"/* Tail starts here */",kotlin:"/* Tail starts here */",db2:"/* Tail starts here */",octave:"# Tail starts here ",r:"# Tail starts here ",xquery:"(: Tail starts here :)",racket:"; Tail starts here",xml:"\x3c!-- Tail starts here --\x3e",rust:"// Tail starts here",swift:"// Tail starts here",elixir:"# Tail starts here",fortran:"! Tail starts here",ada:"-- Tail starts here",nim:"# Tail starts here",julia:"# Tail starts here",cpp14:"/* Tail starts here */",cpp20:"/* Tail starts here */",coffeescript:"# Tail starts here",dart:"/* Tail starts here */",verilog:"/* Tail starts here */"},lang_default_text:{c:"#include <stdio.h>\n#include <string.h>\n#include <math.h>\n#include <stdlib.h>\n\nint main() {\n\n    /* Enter your code here. Read input from STDIN. Print output to STDOUT */    \n    return 0;\n}\n",cpp:"#include <cmath>\n#include <cstdio>\n#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\n\n\nint main() {\n    /* Enter your code here. Read input from STDIN. Print output to STDOUT */   \n    return 0;\n}\n",java:"import java.io.*;\nimport java.util.*;\nimport java.text.*;\nimport java.math.*;\nimport java.util.regex.*;\n\npublic class Solution {\n\n    public static void main(String[] args) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. Your class should be named Solution. */\n    }\n}",csharp:"using System;\nusing System.Collections.Generic;\nusing System.IO;\nclass Solution {\n    static void Main(String[] args) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. Your class should be named Solution */\n    }\n}",php:'<?php\n$_fp = fopen("php://stdin", "r");\n/* Enter your code here. Read input from STDIN. Print output to STDOUT */\n\n?>',ruby:"# Enter your code here. Read input from STDIN. Print output to STDOUT",python:"# Enter your code here. Read input from STDIN. Print output to STDOUT",pypy:"# Enter your code here. Read input from STDIN. Print output to STDOUT",pypy3:"# Enter your code here. Read input from STDIN. Print output to STDOUT",perl:"# Enter your code here. Read input from STDIN. Print output to STDOUT",haskell:"-- Enter your code here. Read input from STDIN. Print output to STDOUT",clojure:"; Enter your code here. Read input from STDIN. Print output to STDOUT\n;",lua:"-- Enter your code here. Read input from STDIN. Print output to STDOUT",sbcl:";; Enter your code here. Read input from STDIN. Print output to STDOUT",erlang:"% Enter your code here. Read input from STDIN. Print output to STDOUT\n% Your class should be named solution\n\n-module(solution).\n-export([main/0]).\n\nmain() ->\n\t.\n",scala:"object Solution {\n\n    def main(args: Array[String]) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. Your class should be named Solution\n*/\n    }\n}",go:'package main\nimport "fmt"\n\nfunc main() {\n //Enter your code here. Read input from STDIN. Print output to STDOUT\n}',javascript:'function processData(input) {\n    //Enter your code here\n} \n\nprocess.stdin.resume();\nprocess.stdin.setEncoding("ascii");\n_input = "";\nprocess.stdin.on("data", function (input) {\n    _input += input;\n});\n\nprocess.stdin.on("end", function () {\n   processData(_input);\n});\n',typescript:'function processData(input) {\n    //Enter your code here\n} \n\nprocess.stdin.resume();\nprocess.stdin.setEncoding("ascii");\n_input = "";\nprocess.stdin.on("data", function (input) {\n    _input += input;\n});\n\nprocess.stdin.on("end", function () {\n   processData(_input);\n});\n',d:"/* Enter your code here. Read input from STDIN. Print output to STDOUT */",ocaml:"(* Enter your code here. Read input from STDIN. Print output to STDOUT *)",pascal:"(* Enter your code here. Read input from STDIN. Print output to STDOUT *)",groovy:"//Enter your code here. Read input from STDIN. Print output to STDOUT",text:"",objectivec:"//Enter your code here. Read input from STDIN. Print output to STDOUT",fsharp:"//Enter your code here. Read input from STDIN. Print output to STDOUT",visualbasic:"'Enter your code here. Read input from STDIN. Print output to STDOUT",cobol:"*Enter your code here. Read input from STDIN. Print output to STDOUT",lolcode:"BTW Enter your code here. Read input from STDIN. Print output to STDOUT",smalltalk:'"Enter your code here. Read input from STDIN. Print output to STDOUT"',tcl:"# Enter your code here. Read input from STDIN. Print output to STDOUT",whitespace:"Enter your code here. Read input from STDIN. Print output to STDOUT",html:"\x3c!-- Enter your code here --\x3e",css:"/* Enter your code here*/",java8:"import java.io.*;\nimport java.util.*;\n\npublic class Solution {\n\n    public static void main(String[] args) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. Your class should be named Solution. */\n    }\n}",java15:"import java.io.*;\nimport java.util.*;\n\npublic class Solution {\n\n    public static void main(String[] args) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. Your class should be named Solution. */\n    }\n}",kotlin:"import java.io.*\nimport java.util.*\n\nfun main(args: Array<String>) {\n        /* Enter your code here. Read input from STDIN. Print output to STDOUT. */\n}",octave:"# Enter your code here. Read input from STDIN. Print output to STDOUT",r:"# Enter your code here. Read input from STDIN. Print output to STDOUT",xquery:"(: Enter your code here. Read input from STDIN. Print output to STDOUT :)",racket:"#lang racket\n; Enter your code here. Read input from STDIN. Print output to STDOUT",xml:"\x3c!-- Enter your code here --\x3e",rust:"// Enter your code here ",swift:"import Foundation\n\n// Enter your code here ",elixir:"defmodule Solution do\n#Enter your code here. Read input from STDIN. Print output to STDOUT\nend",fortran:"! Enter your code here ",ada:"with Ada.Text_IO, Ada.Integer_Text_IO;\nuse Ada;\n\nprocedure Solution is\n-- Enter your code here. Read input from STDIN. Print output to STDOUT\n\n\nend Solution",nim:"# Enter your code here ",julia:"# Enter your code here ",cpp14:"#include <cmath>\n#include <cstdio>\n#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\n\n\nint main() {\n    /* Enter your code here. Read input from STDIN. Print output to STDOUT */   \n    return 0;\n}\n",cpp20:"#include <cmath>\n#include <cstdio>\n#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\n\n\nint main() {\n    /* Enter your code here. Read input from STDIN. Print output to STDOUT */   \n    return 0;\n}\n",coffeescript:"# Enter your code here",dart:"// Enter your code here. Read input from STDIN. Print output to STDOUT",verilog:"module main;\n  initial\n    begin\n      /* Enter your code here. Read input from STDIN. Print output to STDOUT */\n      \n      $finish;\n    end\nendmodule"},lang_suffix_map:{python:"python",python2:"python",python3:"python3",c:"c",cpp:"cpp",cpp14:"cpp",cpp20:"cpp",objectivec:"clang",go:"go",javascript:"javascript",java:"java",java8:"java",java15:"java",php:"php",swift:"swift",csharp:"csharp",ruby:"ruby",dart:"dart"}},headerTemplate:'<% if (showHeader) { %>\n<div class="clearfix grey-header fixed-hand0 cap plL plR psT psB" style="position: relative;">\n  <div class="msT pull-left"><em id="status-text"><%-statusText%></em></div>\n  <% if (enableVersioning) { %>\n  <div class="fork-dialog cs-dialog hide">\n    <div class="header">Fork <span class="version-seq"></span>\n        <i data-analytics="CodeShellForkCode" data-attr1="Cancel" class="icon--single icon-cancel-small close-fork-dialog cursor-pointer pull-right psR"></i>\n    </div>\n    <div class="body">\n      <p class="grey-msg">past buffers are marked read only, you wont be able to edit your current buffer without forking it</p>\n      <div class="m msT">\n        <button data-analytics="CodeShellForkCode" data-attr1="ForkCurrentBuffer" class="btn btn-primary fork-version" data-action="fork">Fork <span class="version-seq"></span></button>&nbsp;&nbsp;\n        <button data-analytics="CodeShellForkCode" data-attr1="CreateNewBuffer" class="btn btn-primary fork-version" data-action="orphan">Create New Buffer</button>\n      </div>\n    </div>\n  </div>\n  <div class="fork-limit-reached-dialog cs-dialog hide">\n    <div class="header">Fork Limit Reached</div>\n    <div class="body">\n      <p class="grey-msg">You can&rsquo;t create more than 20 buffers, please delete one of your old bufferes to create a new buffer.</p>\n      <div class="m msT">\n        <button class="btn close-fork-limit-reached-dialog">OK</button>&nbsp;&nbsp;\n      </div>\n    </div>\n  </div>\n  <div class="delete-version-dialog cs-dialog hide">\n    <div class="header">Delete <span class="version-seq"></span></div>\n    <div class="body">\n      <p class="grey-msg">Are you sure you want to delete <strong><span class="version-seq"></span></strong>? This action can&rsquo;t be undone.</p>\n      <div class="m msT">\n        <button class="btn delete-version-button">Yes</button>&nbsp;&nbsp;\n      </div>\n    </div>\n  </div>\n  <div class="pull-left no-select">\n    <p style="padding-top: 8px;">\n      <strong class="version-name">Current Buffer</strong>\n      <span class="gray-text version-meta">(saved locally, editable)</span>\n      &nbsp;&nbsp;\n      <a data-analytics="CodeShellShowForkOptions" class="fork-this-version"><i class="icon--grey cursor icon-flow-branch"></i></a>\n      <a data-analytics="CodeShellShowVersionTimeline" class="show-version-timeline"><i class="icon--grey cursor icon-back-in-time"></i></a>\n      <a class="delete-active-version hide"><i class="icon--grey cursor icon-trash"></i></a>\n    </p>\n  </div>\n  <% } %>\n  <% if(showFileTree && adminView) { %>\n  <div class=\'pull-left btn-group\' id=\'js-file-permissions\'>\n    <a class=\'cursor btn btn-white\' data-perm=\'1\' href=\'#\'>Hidden</a>\n    <a class=\'cursor btn btn-white\' data-perm=\'2\' href=\'#\'>List Only</a>\n    <a class=\'cursor btn btn-white\' data-perm=\'3\' href=\'#\'>Read Only</a>\n  </div>\n  <% } %>\n  <div class="pull-right">\n    <% if (customToolBar != null) { %>\n      <% _.each(customToolBar, function(button) { %>\n        <div class="inline">\n         <% if(button["type"] == "link") { %>\n            <a class=\'<%- button["classList"] %>\'> <%- button["text"] %> </a>\n         <% } %>\n         </div>\n        <% }) %>\n    <% } %>\n    <div class="inline large lines inverse pull-right msT msL">\n      <% if (showSave) { %>\n      <a class="cursor save-code no-select" id="save-code"><i class="icon-floppy icon--grey no-select"></i></a>\n      <% } %>\n      <% if (showFullScreen) { %>\n      <a class="restorefullscreen force-hide active-link no-select">\n          <i class="icon-resize-small-alt icon--grey no-select"></i></a>\n      <a class="fullscreen active-link no-select"\n         data-analytics="Switch to fullscreen"><i class="icon-resize-full-alt icon--grey no-select"></i></a>\n      <% } %>\n      <% if (layout == 1) { %>\n        <i id="vertical-icon" style="background-repeat: no-repeat; background-position: 50% 50%; border:none; float:left; margin-right: 7px;" class="orientation-icon js-tooltip" data-placement="bottom" title="Switch to vertical layout"></i>\n      <% } else if (layout == 2) { %>\n        <i id="horizontal-icon" style="background-repeat: no-repeat; background-position: 50% 50%; border:none; float:left; margin-right: 7px;" class="orientation-icon js-tooltip" data-placement="bottom" title="Switch to horizontal layout"></i>\n      <% } %>\n      <% if(showSettings) { %>\n      <a class="hide" style="display:none;"></a>\n      <div class="settings-editor" style="position:relative; margin-left: 0px;">\n        <a class="cursor no-select" data-analytics="CodeShellShowPreferences" id="show-preferences"><i class="icon-cog icon--grey no-select"></i></a>\n        <div id="pref-pane"\n          style="position: absolute;right: -0.5em;top: 2em;z-index: 9;background: #fff;border: 1px solid #ddd;border-radius: 5px;padding: 10px;  width: 25em; display: none;">\n          <div style="position: absolute;width: 0;right: 0.8em;height: 0;border-left: 7px solid transparent;border-right: 7px solid transparent;border-bottom: 7px solid #ddd;top: -0.4em;"></div>\n          <% if (showMode) { %>\n            <div class="formgroup horizontal">\n              <label class="span5">Editor Mode</label>\n              <div class="inline">\n                <div class="btn-group no-select">\n                  <a data-analytics="CodeShellEditorMode" data-attr1="Emacs" class="cursor emacs btn btn-small btn-white editor-mode-button no-select" data-editor="emacs">Emacs</a>\n                  <a data-analytics="CodeShellEditorMode" data-attr1="Normal" class="cursor default btn btn-small btn-white editor-mode-button no-select" data-editor="sublime">Normal</a>\n                  <a data-analytics="CodeShellEditorMode" data-attr1="Vim" class="cursor vim btn btn-small btn-white editor-mode-button no-select" data-editor="vim">Vim</a>\n                </div>\n              </div>\n            </div>\n          <% } %>\n          <% if (showTheme) { %>\n            <div class="formgroup horizontal">\n              <label class="span5">Editor Theme</label>\n              <div class="inline">\n                <div class="btn-group no-select">\n                  <a data-analytics="CodeShellEditorTheme" data-attr1="Light" class="cursor light btn btn-small btn-white editor-theme-button no-select btn-primary" data-editor="light">Light</a>\n                  <a data-analytics="CodeShellEditorTheme" data-attr1="Dark" class="cursor dark btn btn-small btn-white editor-theme-button no-select" data-editor="dark">Dark</a>\n                </div>\n              </div>\n            </div>\n          <% } %>\n          <div class="formgroup horizontal">\n            <label class="span5">Tab Spaces</label>\n            <div class="inline">\n              <div class="btn-group no-select">\n                <a data-analytics="CodeShellEditorSpace" data-attr1="2" class="cursor 2space btn btn-small btn-white editor-tabspace-button no-select" data-editor="2">2 spaces</a>\n                <a data-analytics="CodeShellEditorSpace" data-attr1="4" class="cursor 4space  btn btn-small btn-white editor-tabspace-button no-select btn-primary" data-editor="4">4 spaces</a>\n                <a data-analytics="CodeShellEditorSpace" data-attr1="8" class="cursor 8space btn btn-small btn-white editor-tabspace-button no-select" data-editor="8">8 spaces</a>\n              </div>\n            </div>\n          </div>\n          <% if (enableIntellisense) { %>\n            <div class="formgroup horizontal">\n              <label class="span5">Intellisense\n              <% if (inReact) { %>\n              <span data-balloon="<%= intellisenseTooltipText %>" data-balloon-pos="down">\n              <% } else { %>\n              <span class="js-tooltip" data-toggle="tooltip" data-placement="bottom" title="<%= intellisenseTooltipText %>" data-attr1="CodeCompletion">\n              <% } %>\n              <i class="icon-info-circled fnt-sz-small txt-navy"></i>\n              </span></label>\n              <div class="inline">\n                <div class="btn-group no-select">\n                  <a data-analytics="CodeShellAutoComplete" data-attr1="Enable" class="cursor emacs btn btn-small btn-white editor-autocomplete-button no-select btn-primary" data-editor="true">Enable</a>\n                  <a data-analytics="CodeShellAutoComplete" data-attr1="Disable" class="cursor default btn btn-small btn-white editor-autocomplete-button no-select" data-editor="false">Disable</a>\n                </div>\n              </div>\n            </div>\n          <% } %>\n          <% if (customSetting != null) { %>\n            <% _.each(customSetting, function(setting) { %>\n            <div class="formgroup horizontal">\n              <label class="span5"> <%=setting["label"] %></label>\n               <% if(setting["type"] == "link") { %>\n                  <a class=\'<%- setting["classList"] %>\'> <%- setting["text"] %> </a>\n               <% } %>\n            </div>\n              <% }) %>\n          <% } %>\n        </div>\n      </div>\n      <% } %>\n    </div>\n    <% if(showLanguageDropdown) { %>\n    <div class="pull-right lang-placeholder">\n      <div class="dummy-lang-container hide"></div>\n      <input type="hidden" id="select-lang">\n    </div>\n    <% } %>\n    <div class="clearfix"></div>\n  </div>\n</div>\n<% } %>\n<% if (enableVersioning) { %>\n<div class="version-timeline">\n  <div class="version-timeline-inner">\n    <div class="cross-line"></div>\n    <div class="start-slab pull-left"></div>\n    <% _.each (versionIds, function (version_id) { %>\n      <div class="version-ball pull-left cursor" data-version-id="<%= version_id %>"></div>\n    <% }); %>\n    <div class="current-version-ball green-bkg pull-left cursor"></div>\n  </div>\n</div>\n<% } %>',bodyTemplate:'<div class="hr_tour-code-solution movable-hand flex-row" style="display: flex;">\n  <% if (showFileTree) { %>\n  <div class="code-filetree">\n    <div id="filetree">\n    </div>\n  </div>\n  <% } %>\n  <div class="code-checker">\n    <div id="notification-message" class="clearfix grey-header cap <% if ( (!showNotification) || (!notificationMessage)){ %> hidden <% } %>"> <%= notificationMessage %></div>\n    <div class="code-editors">\n      <% if (showNonEditableHeadTail){ %>\n      <div class="code-head <% if(!adminView) { %>not-allowed<% } %>">\n        <% if(adminView) { %>\n        <div class="code-template">\n            Head\n        </div>\n        <% } %>\n        <textarea id="codeheadview" style="width:100%"/>\n      </div> <%}%>\n      <% if (dynamicMode) { %> <div class="loading-mode" style="display:none">Loading Editor... </div> <% } %>\n      <div class="code-body">\n        <% if(adminView && showNonEditableHeadTail) { %>\n        <div class="code-template">\n            Body\n        </div>\n        <% } %>\n       <textarea id="codeview" style="width:100%"></textarea>\n       </div>\n      <% if (showNonEditableHeadTail){ %>\n      <div class="code-tail <% if(!adminView) { %>not-allowed<% } %>">\n        <% if(adminView) { %>\n        <div class="code-template">\n            Tail\n        </div>\n        <% } %>\n        <textarea id="codetailview" style="width:100%"/>\n      </div> <%}%>\n      <div class="clearfix"></div>\n    </div>\n    <div id="codeeditor-statusbar" class="clearfix psA codeeditor_statusbar">\n      <span id="statusbar-mode"></span>\n      <div class="pull-right">\n        <span id="statusbar-line"></span>\n        <span id="statusbar-col"></span>\n        <span id="statusbar-count"></span>\n      </div>\n    </div>\n  </div>\n</div>',footerTemplate:'<div class="clearfix pmR pmL pmB plT fixed-hand1 codeshell-footer">\n  <div class="pull-right">\n    <% if (showExecute) { %>\n    <button class="btn bb-execute msR" data-analytics="Execute"><%= execute_button_text %></button>\n    <% } %>\n    <% if (showCompileTest) {  primaryClass= (compilePrimary ? "btn-primary": "")%>\n    <button class="btn bb-compile msR <%=primaryClass%>" data-analytics="Compile and Test"><%= compile_button_text %></button>\n    <% } %>\n    <% if (showSubmit) { primaryClass= (submitPrimary ? "btn-primary": "")%>\n    <button class="btn <%=primaryClass%> bb-submit ans-submit" data-analytics="Submit Code"><%= submit_button_text %></button>\n    <% } %>\n    <% if (submit_button_sub_text) {%>\n    <div class="msT"><%= submit_button_sub_text %></div>\n    <% } %>\n  </div>\n  <div class="pull-left inline">\n      <% if(showUploadCode) { %>\n      <button class="btn btn-text upload_file mlR" data-analytics="Upload File" type="button"><i class="icon-upload"></i><%= uploadCodeText %></button>\n      <% } %>\n      <% if(showDownloadCode) { %>\n      <a class="btn btn-text download_file mlR" data-analytics="Download File" href=\'<%= showDownloadCode %>\' target="_blank"><i class="icon-download"></i><%= downloadCodeText%></a>\n      <% } %>\n      <% if (showCustomInput || showNewCustomInput) { %>\n      <div class="mmT">\n          <label for="customtestcase"><div class="custom-checkbox-v3"><input type="checkbox" id="customtestcase"><span/></div><span class="lmT msL">Test against custom input</span></label>\n          <%if(showCustomInput){%>\n          <textarea rows="5" id="custominput" style="display:none"></textarea>\n          <%}%>\n      </div>\n      <% } %>\n  </div>\n  <%if(showNewCustomInput){%>\n    <div class="js-custom-input hide-new-custom" ></div>\n  <%}%>\n</div>',_create:function(){var e,t,n,i,r;return this.state={},t=this.getOptions(),this._stateChange("before_create"),this.ele_name=this.element.context.id,e=c(this.element),this.options=c.extend({},this._options,this.options),this.current_code=e.html(),e.empty(),e.append(d.template(this.headerTemplate,this.options)),e.append(d.template(this.bodyTemplate,this.options)),e.append(d.template(this.footerTemplate,this.options)),this.codeEditor=this._initCodeEditor(e.find("textarea#codeview")[0]),null!=(n=t.firepad)&&n.enabled&&(t.firepad.codeEditor=this.codeEditor,setTimeout((i=this,function(){return i._initFirepad(t.firepad)}))),this.options.showNonEditableHeadTail&&(this.codeEditorHead=this._initCodeEditor(e.find("textarea#codeheadview")[0],!this.options.adminView),this.codeEditorTail=this._initCodeEditor(e.find("textarea#codetailview")[0],!this.options.adminView)),this._bindBasicEvents(e),this._initializeAutoComplete(),this._suggestionBoxDisplayStatus=!1,this._autoCompleteReqestStatus=!1,this._autoCompleteSupportedLanguages=["java","c","cpp","cpp14","csharp","ruby","php","python","java8","python3","javascript","go"],this._lintingSupportedLanguages=["java","php","python","java8","python3","ruby","cpp","cpp14","c","go","javascript"],this._throttledEnableIntellisenseFunc=d.debounce(this._enableIntellisenseFunc,200),this._bindVersionBall(),this._bindCurrentVersionBall(),this._bindVersioningEvents(e),this._changeTheme(),this._setTabSize(this.codeEditor.options.tabSize),this._initFileTree(e),this.changeLanguage(this.state.language,(r=this,function(){return r._internalStateChange("mode-loaded",!0),r._check_created()})),this._internalStateChange("end-init",!0),this._check_created()},_stateChange:function(e){return this.state._=e,this._trigger(e)},_internalStateChange:function(e,t){var n;return(n=this.state).__||(n.__={}),this.state.__[e]=t},_check_created:function(){if(this.state.__&&this.state.__["end-init"]&&this.state.__["mode-loaded"])return this._stateChange("after_create")},_bindVersioningEvents:function(r){var n,t,i,o,s,a,l;return r.find(".fork-this-version").click((n=this,function(e){var t;return n.options.versionIds&&n.options.versionIds.length<20?(t=".fork-dialog",void 0===n.ActiveVersionId||null===n.ActiveVersionId?r.find(".fork-dialog .version-seq").html("Current Buffer"):r.find(".fork-dialog .version-seq").html("Buffer #"+(d.indexOf(n.options.versionIds,n.ActiveVersionId)+1))):t=".fork-limit-reached-dialog","none"===n.element.find(t).css("display")?(n.element.find(t).show(),c(e.currentTarget).find("i").addClass("green-color")):(n.element.find(t).hide(),c(e.currentTarget).find("i").removeClass("green-color"))})),r.find(".show-version-timeline").click((t=this,function(e){return"none"===t.element.find(".version-timeline").css("display")?(t.element.find(".version-timeline").show(),c(e.currentTarget).find("i").addClass("green-color")):(t.element.find(".version-timeline").hide(),c(e.currentTarget).find("i").removeClass("green-color"))})),r.find(".fork-version").click((i=this,function(e){e="orphan"===c(e.currentTarget).attr("data-action")?{code:i._getDefaultLangCode(i.state.language),language:i.state.language}:{code:i.codeEditor.getValue(),language:i.state.language};return i._forkNewBuffer(e)})),r.find(".close-fork-dialog").click((o=this,function(e){return o.element.find(".fork-dialog").hide(),o.element.find(".fork-this-version").find("i").removeClass("green-color")})),r.find(".close-fork-limit-reached-dialog").click((s=this,function(e){return s.element.find(".fork-limit-reached-dialog").hide(),s.element.find(".fork-this-version").find("i").removeClass("green-color")})),r.find(".delete-active-version").click((a=this,function(e){return c(e.currentTarget).find("i").hasClass("green-color")?(c(e.currentTarget).find("i").removeClass("green-color"),r.find(".delete-version-dialog").hide()):null!==a.ActiveVersionId?(c(e.currentTarget).find("i").addClass("green-color"),r.find(".delete-version-dialog").find(".version-seq").html("Buffer #"+(d.indexOf(a.options.versionIds,a.ActiveVersionId)+1)),r.find(".delete-version-dialog").show(),r.find(".delete-version-dialog").find(".delete-version-button").attr("data-version-id",a.ActiveVersionId)):void 0})),r.find(".delete-version-button").click((l=this,function(e){var t=parseInt(r.find(".delete-version-button").attr("data-version-id")),n=d.indexOf(l.options.versionIds,t),i=l;return c.ajax({url:l.options.versioningRestUrl,type:"DELETE",data:{version_id:t},success:function(e){return i.options.versionIds=d.reject(i.options.versionIds,function(e){return e===t}),i.element.find(".version-ball[data-version-id="+t+"]").remove(),(n<i.options.versionIds.length?i.element.find(".version-ball[data-version-id="+i.options.versionIds[n]+"]"):i.element.find(".current-version-ball")).click(),r.find(".delete-active-version").find("i").removeClass("green-color"),r.find(".delete-version-dialog").hide()}})}))},_bindBasicEvents:function(i){var n,r,t,o,s=this;return this.codeEditor.on("update",function(e){return s._updateStatusBar(s)}),this.codeEditor.on("cursorActivity",function(e){return s._updateStatusPosition(e)}),this.codeEditor.on("focus",(n=this,function(e){var t;return s.options.focusLogged?s.codeEditor.off("focus"):(s.options.focusLogged=!0,t=c(n.element).find("#select-lang").val(),s.triggerAnalyticsEvent("focus","CodeShellUserIsInsideTheEditor",t))})),this.options.showNonEditableHeadTail&&(this.codeEditorHead.on("cursorActivity",function(e){return s._updateStatusPosition(e)}),this.codeEditorTail.on("cursorActivity",function(e){return s._updateStatusPosition(e)})),this.options.adminView&&(this.options.showNonEditableHeadTail&&(this.codeEditorHead.on("change",function(e){return s._updateLangHeadCode(s,e),s._updateTailEditorLineNumber(!0)}),this.codeEditorTail.on("change",function(e){return s._updateLangTailCode(s,e)})),this.codeEditor.on("change",function(e){return s._updateLangCode(s,e)})),this.codeEditor.on("beforeChange",function(t,e){var n;return"paste"===e.origin?(n=e.text.map(function(e){return e.replace(/\t/g,d.times(t.getOption("indentUnit"),function(){return" "}).join(""))}),e.update(null,null,n)):d.isFunction(e.update)?e.update():void 0}),this.codeEditor.on("paste",function(e,t){return s.options.diagnostics=[]}),this.codeEditor.on("change",function(e){if(s._saveLangCode(s),s.options.showNonEditableHeadTail)return s._updateTailEditorLineNumber()}),this.codeEditor.on("keydown",function(e,t){if(s._totalCharactersTyped+=1,s._trigger("filechanged",{},s.currentFile),s.options.showSave&&(c(s.element).find("#save-code i").addClass("color-green"),(t.metaKey||t.ctrlKey)&&83===t.keyCode&&(s._saveCode(t),t.preventDefault())),s.options.enableTrackTyping)return s.setTypingEvent()}),this.codeEditor.on("viewportChange",function(e){return s._growEditor()}),this._shiftPressed=!1,this.options.enableIntellisense&&this.codeEditor.on("keyup",function(e,t){s._filterDiagnostics(e,t,e.lineCount()),16===t.keyCode&&(s._shiftPressed=!1),!0===s.options.enableLiveAutocomplete?t.key&&1===t.key.length&&t.key.match(/^[a-zA-Z.]/)&&!1===t.ctrlKey&&(190===t.keyCode&&(s._suggestionBoxDisplayStatus=!1),s._throttledEnableIntellisenseFunc(e)):190===t.keyCode&&!1===s._shiftPressed&&(s._suggestionBoxDisplayStatus=!1,s._enableIntellisenseFunc(e))}),this.options.enableIntellisense&&this.codeEditor.on("keydown",function(e,t){16===t.keyCode&&(s._shiftPressed=!0),!0===s._autoCompleteReqestStatus&&(s._autoCompleteReqestStatus=!1)}),this.codeEditor.on("blur",function(){if(!0===s._autoCompleteReqestStatus)return s._autoCompleteReqestStatus=!1}),i.find("#select-lang").change(function(e){return c(i)&&s.options.enableLanguageChangeHook?s._trigger("changinglanguage",{},{yes:function(){return s._changeLanguage(e,s)},no:function(){s.state.language;return c("#select-lang").select2("val",s.state.language)},from:s.state.language,to:c(e.currentTarget).select2("val")}):s._changeLanguage(e,s)}),i.find("#save-code").click(function(e){return e.preventDefault(),s._saveCode(e,s)}),i.find("#select-lang").on("select2-close",function(e){return setTimeout(function(){return s.focusEditor(s)},100)}),i.find(".editor-mode-button").click(function(e){return s._setEditorMode(e,s),s._updateStatusBar(s)}),i.find(".editor-tabspace-button").click(function(e){return s._setTabSize(c(e.currentTarget).attr("data-editor"),e)}),i.find("button.bb-execute").click(function(e){return s._checkAndSave(null,null,s,function(){var e={};return e.custominput=c(s.element).find("#custominput").val(),s._trigger("execute",{},e)})}),i.find("button.bb-compile").click(function(e){var t;return s.options.showFileTree?s._checkAndSave(null,null,s,function(){var e={};return s._trigger("compile",{},e)}):(t={code:s.codeEditor.getValue(),language:s.state.language},s.options.showCustomInput&&c(s.element).find("#customtestcase").prop("checked")&&(t.custominput=c(s.element).find("#custominput").val()),s._trigger("compile",{},t))}),d.each(this.options.customSetting,function(t){if(t.classList&&t.eventName)return i.find("a[class='"+t.classList+"']").click(function(e){return s._trigger(t.eventName,{},{})})}),d.each(this.options.customToolBar,function(t){if(t.classList&&t.eventName)return i.find("a[class='"+t.classList+"']").click(function(e){return s._trigger(t.eventName,{},{})})}),i.find("button.bb-submit").click(function(e){var t;return s.options.showFileTree?s._checkAndSave(null,null,s,function(){var e={};return s.triggerAnalyticsEvent("change","CodeShellTotalCharactersTypedBeforeSubmit",s._totalCharactersTyped),s._trigger("submit",{},e)}):(t={code:s.codeEditor.getValue(),language:s.state.language},s.options.showCustomInput&&c(s.element).find("#customtestcase").prop("checked")&&(t.custominput=c(s.element).find("#custominput").val()),s.triggerAnalyticsEvent("change","CodeShellTotalCharactersTypedBeforeSubmit",s._totalCharactersTyped,t.code.length),s._trigger("submit",{},t))}),i.find("#customtestcase").change(function(e){return c("#customtestcase").is(":checked")?(c(".js-custom-input").removeClass("hide-new-custom"),c(".js-custom-input").addClass("show-new-custom")):(c(".js-custom-input").removeClass("show-new-custom"),c(".js-custom-input").addClass("hide-new-custom"))}),i.find("#customtestcase").click(function(e){return c(s.element).find("#custominput").toggle(this.checked)}),i.find("#show-preferences").click((r=this,function(e){var t=i.find("#pref-pane");return"none"===t.css("display")?(c(e.currentTarget).find("i").addClass("green-color"),t.show(),r.element.find("#tab-spaces").val(r.codeEditor.options.tabSize)):(c(e.currentTarget).find("i").removeClass("green-color"),t.hide())})),i.click(function(e){var t=i.find("#pref-pane"),n=t.parent();if(!n.is(e.target)&&0===n.has(e.target).length)return i.find("i.green-color").removeClass("green-color"),t.hide()}),i.find(".editor-theme-button").click((t=this,function(e){e=c(e.currentTarget).attr("data-editor");return t._changeTheme(e),t.triggerAnalyticsEvent("change","CodeShellChangeTheme",e)})),i.find("#tab-spaces").keyup((o=this,function(e){return o._setTabSize(c(e.currentTarget).val()),o.triggerAnalyticsEvent("change","CodeShellChangeTabSpaces",c(e.currentTarget).val())}))},_initFileTree:function(e){var t,s;if(this.options.showFileTree&&((s=this).currentFile=null,t={core:{multiple:!1,data:this.options.showFileTree.data,check_callback:function(e,t,n,i,r){var o=function(e,t){var n;return null==t&&(t=null),e&&(n=c.jstree.reference("#filetree"),t&&e.id!==t&&n.set_id(e,t),n.refresh_node(e)),s._executingFileOps=!1};switch(e){case"create_node":s.options.showFileTree.onCreate&&(s._executingFileOps=!0,s.options.showFileTree.onCreate(t,n,o));break;case"rename_node":t.text!==i&&s.options.showFileTree.onRename&&(s._executingFileOps=!0,s.options.showFileTree.onRename(t,n,i,o))}return!0}},types:{file:{icon:"jstree-file"}},contextmenu:{items:{}},plugins:["wholerow","types","contextmenu"]},s.options.showFileTree.onCreate&&(t.contextmenu.items.create={label:"New",_disabled:function(e){var t;return!s.options.adminView&&("file"===(e=(t=c.jstree.reference(e.reference)).get_node(e.reference)).type&&(e=t.get_node(e.parent)),"#"!==e.id&&e.original.permission<4)},action:function(){return console.log("always called before")},submenu:{create_folder:{separator_after:!0,label:"Folder",action:function(e){var t=c.jstree.reference(e.reference),e=t.get_node(e.reference);return"file"===e.type&&(e=t.get_node(e.parent)),t.create_node(e,{id:Date.now().toString(36),text:"New_Folder",type:"default",permission:4},"last",function(e){return setTimeout(function(){return t.edit(e)},0)})}},create_file:{label:"File",action:function(e){var t=c.jstree.reference(e.reference),e=t.get_node(e.reference);return"file"===e.type&&(e=t.get_node(e.parent)),t.create_node(e,{id:Date.now().toString(36),text:"New_File",type:"file",permission:4},"last",function(e){return setTimeout(function(){return t.edit(e)},0)})}}}}),s.options.showFileTree.onRename&&(t.contextmenu.items.rename={label:"Rename",_disabled:function(e){return!s.options.adminView&&c.jstree.reference(e.reference).get_node(e.reference).original.permission<4},action:function(e){var t=c.jstree.reference(e.reference),e=t.get_node(e.reference);return t.edit(e)}}),s.options.showFileTree.onDelete&&(t.contextmenu.items.delete={label:"Delete",_disabled:function(e){return!s.options.adminView&&c.jstree.reference(e.reference).get_node(e.reference).original.permission<4},action:function(e){var t=c.jstree.reference(e.reference),n=t.get_node(e.reference),i=t.is_selected(n)?t.get_selected():n,e=function(e){if(null==e&&(e=!0),s._executingFileOps=!1,e)return t.delete_node(i)},n=t.get_parent(i);if(s.options.showFileTree.onDelete)return s._executingFileOps=!0,s.options.showFileTree.onDelete(i,n,e)}}),e.find("#filetree").jstree(t).on("changed.jstree",function(e,t){return s._checkAndSave(e,t,s)}),this.options.adminView))return e.find("#js-file-permissions a").off("click").on("click",function(e){return s._updateFilePermission(e,s)})},_updateFilePermission:function(e,t){var n;return e.preventDefault(),n=c(e.currentTarget),t.fileTree||(t.fileTree=c.jstree.reference("#filetree")),e=n.hasClass("active")?(n.removeClass("active btn-primary"),4):(n.addClass("active btn-primary").siblings().removeClass("active btn-primary"),n.data("perm")),(n=t.fileTree.get_selected(!0)[0]).original.permission=e,t.options.showFileTree.onPermissionUpdate(n)},_checkAndSave:function(e,n,i,t){var r;if(null==t&&(t=null),i.fileTree||(i.fileTree=c.jstree.reference("#filetree")),c(i.element).find("#save-code i").removeClass("color-green"),n){if(n.node)return(i.options.adminView&&n.node.original.permission<4?c("#js-file-permissions").find("a[data-perm="+n.node.original.permission+"]").addClass("active btn-primary").siblings():c("#js-file-permissions a")).removeClass("active btn-primary"),"file"===n.node.type?(i._showLoading(),i.currentFile&&(i.options.adminView||3<i.currentFile.original.permission)&&(r=i.value(),i.currentFile.original.fileContents.code!==r.code&&(i.currentFile.original.fileContents=r,i._executingFileOps=!0,i.options.showFileTree.onSave(i.currentFile,function(){return i._executingFileOps=!1}))),i.options.adminView||2<n.node.original.permission?null==n.node.original.fileContents?(i._executingFileOps=!0,i.options.showFileTree.fetch(n,function(e){var t;return e.node.id!==c("#filetree").jstree("get_selected")[0]&&i.currentFile||(d.isString(e.node.original.fileContents)?(i.currentFile=e.node,i._showLoading(e.node.original.fileContents)):(t=e.node.original.fileContents.language,e.node.original.fileContents.language=t||"text",i.currentFile=e.node,i.setValue(e.node.original.fileContents,{clearHistory:!0}),i._setNotifyFileReadOnly(n,i))),i._executingFileOps=!1})):n.node.id!==c("#filetree").jstree("get_selected")[0]&&i.currentFile?void 0:d.isString(n.node.original.fileContents)?(i._showLoading(n.node.original.fileContents),i.currentFile=n.node):(i.currentFile=n.node,i.setValue(n.node.original.fileContents,{clearHistory:!0}),i._setNotifyFileReadOnly(n,i)):i._showLoading("You don't have permission to access this file.")):i._showLoading('<i class="icon--single icon-attention"> </i>You have selected a folder, please select a file from the left pane to open its contents.')}else!i._executingFileOps&&i.currentFile&&(i.options.adminView||3<i.currentFile.original.permission)?(r=i.value(),i.currentFile.original.fileContents.code===r.code?t&&t():(i.currentFile.original.fileContents=r,i._executingFileOps=!0,i.options.showFileTree.onSave(i.currentFile,function(){if(i._executingFileOps=!1,t)return t()}))):t&&t()},_setNotifyFileReadOnly:function(e,t){return t.options.adminView||3<e.node.original.permission?(t.codeEditor.setOption("readOnly",!1),t.hideNotification()):(t.codeEditor.setOption("readOnly",!0),t.setNotificationMessage('<div class="pjL pmA"> <i class="icon--single icon-lock msR"/>This file is read only.</div>'))},_initializeAutoComplete:function(){var e,t,n;if(this.options.enableIntellisense)return e=c(this.element),"true"===c.cookie("enableIntellisenseUserPref")?this._setAutoCompleteState(!0,!1):"false"===c.cookie("enableIntellisenseUserPref")?this._setAutoCompleteState(!1,!1):this._setAutoCompleteState(!0,!0),t=this,e.find(".editor-autocomplete-button").click((n=this,function(e){"true"===c(e.currentTarget).attr("data-editor")?(n._setAutoCompleteState(!0,!0),t.triggerAnalyticsEvent("change","CodeShellAutoComplete","on")):(n._setAutoCompleteState(!1,!0),t.triggerAnalyticsEvent("change","CodeShellAutoComplete","off"))}))},_copyToCurrentBuffer:function(e){var t,n=c(this.element);return n.find(".version-ball").removeClass("green-bkg"),n.find(".version-name").html("Current Buffer"),n.find(".version-meta").html("(saved locally, editable)"),n.find(".current-version-ball").hasClass("green-bkg")||n.find(".current-version-ball").addClass("green-bkg"),this.versionGetXhr&&void 0===this.versionGetXhr.status&&this.versionGetXhr.abort(),this._showLoading("Loading current buffer... "),this.codeEditor.setOption("readOnly",!1),this.setValue(e),this.ActiveVersionId=null,this.saveLangCode(),t=this,setTimeout(function(){return t._hideLoading(),t.options.showLanguageDropdown&&(c(t.element).find(".dummy-lang-container").hide(),c(t.element).find("#select-lang").siblings(".select2-container").show()),t.element.find(".delete-active-version").hide(),t.ActiveVersionId=null},100)},_forkNewBuffer:function(t){var e,n,i;return null==t&&(t=null),n=c(this.element),e=void 0===this.ActiveVersionId||null===this.ActiveVersionId?{code:this.codeEditor.getValue(),language:this.state.language}:{code:this._getLangCode(this.currentBufferLang),language:this.currentBufferLang},this._showLoading("Saving previous buffer on cloud... "),this.element.find(".close-fork-dialog").click(),i=this,c.ajax({url:this.options.versioningRestUrl,type:"POST",data:e,success:function(e){return t&&i._copyToCurrentBuffer(t),i._hideLoading(),"none"===n.find(".version-timeline").css("display")&&n.find(".show-version-timeline").click(),n.find(".version-ball").removeClass("green-bkg"),n.find(".version-ball").hasClass("green-bkg")||n.find(".current-version-ball").addClass("green-bkg"),i._addNewVersion(e.id)}})},forkNewBuffer:function(e){var t,n;return this.options.enableVersioning?this.options.versionIds&&this.options.versionIds.length<20?(this._forkNewBuffer(e),n=this,setTimeout(function(){return n.saveLangCode()},0)):(t=".fork-limit-reached-dialog","none"===this.element.find(t).css("display")?(this.element.find(t).show(),this.element.find(".fork-this-version i").addClass("green-color")):(this.element.find(t).hide(),this.element.find(".fork-this-version i").removeClass("green-color"))):this.setValue(e)},_bindCurrentVersionBall:function(){var n;return c(this.element).find(".current-version-ball").click((n=this,function(e){var t={code:n._getLangCode(n.currentBufferLang||n.state.language),language:n.currentBufferLang||n.state.language};return n._copyToCurrentBuffer(t)}))},_bindVersionBall:function(){var r,o=c(this.element);return o.find(".version-ball").unbind("click").click((r=this,function(e){var t,n=parseInt(c(e.currentTarget).attr("data-version-id")),i=d.indexOf(r.options.versionIds,n)+1;return o.find(".current-version-ball").hasClass("green-bkg")&&(r.currentBufferLang=r.state.language,r.saveLangCode()),r.element.find(".delete-active-version").hide(),o.find(".version-name").html("Buffer #"+i),o.find(".version-meta").html("(saved on cloud, read-only)"),o.find(".version-ball").removeClass("green-bkg"),o.find(".current-version-ball").removeClass("green-bkg"),c(e.currentTarget).hasClass("green-bkg")||c(e.currentTarget).addClass("green-bkg"),(t=r)._showLoading("Looking up cloud for buffer #"+i+"... "),r.versionGetXhr&&void 0===r.versionGetXhr.status&&r.versionGetXhr.abort(),r.versionGetXhr=c.ajax({url:r.options.versioningRestUrl,type:"GET",data:{version_id:n},success:function(e){return t.setValue({code:e.source,language:e.language}),t.codeEditor.setOption("readOnly",!0),c(t.element).find(".dummy-lang-container").html(t.options.lang_display_mapping[e.language]).show(),c(t.element).find("#select-lang").siblings(".select2-container").hide(),t._hideLoading(),t.ActiveVersionId=n,t.element.find(".delete-active-version").show()}})}))},_addNewVersion:function(e){var t;if(-1===d.indexOf(this.options.versionIds,e))return this.options.versionIds.push(e),this.options.versionIds=d.sortBy(this.options.versionIds,function(e){return e}),t=null,d.each(this.options.versionIds,function(e){return 0===this.element.find(".version-ball[data-version-id="+e+"]").length&&((null!==t?this.element.find(".version-ball[data-version-id="+t+"]"):this.element.find(".start-slab")).after("<div class='version-ball pull-left cursor' data-version-id='"+e+"'></div>"),this._bindVersionBall()),t=e},this)},_updateStatusBar:function(){var e=function(){switch(this.codeEditor.options.keyMap){case"vim":return"--VIM--";case"vim-insert":return"-- INSERT --";case"emacs":return"EMACS";case"sublime":return"";case"emacs-Ctrl-X":return"C-x-";default:return""}}.call(this);return c(this.element).find("#statusbar-mode").text(e)},_updateStatusPosition:function(e){var t=e.doc.getCursor(),n=e.getOption("firstLineNumber");return(e=c(this.element)).find("#statusbar-line").text("Line: "+(t.line+n)),e.find("#statusbar-col").text("Col: "+(t.ch+1))},_getThemeName:function(e){return"dark"===e?"ambiance":"default"},_changeTheme:function(e){var t;return null==e&&(e=null),t=c(this.element),"dark"!==(e=e||c.cookie("hacker_editor_theme"))&&"light"!==e&&(e="light"),c.cookie("hacker_editor_theme",e,{path:"/",expires:365}),t.find(".editor-theme-button").removeClass("btn-primary"),t.find(".editor-theme-button[data-editor="+e+"]").addClass("btn-primary"),this.codeEditor.setOption("theme",this._getThemeName(e)),this.codeEditor.refresh()},_setTabSize:function(e,t){if(e=parseInt(e),d.isNumber(e)&&!d.isNaN(e)&&this.codeEditor.options.tabSize!==e&&(this._saveUserOpts({tabSize:e,indentUnit:e}),this.codeEditor.setOption("tabSize",e),this.codeEditor.setOption("indentUnit",e)),t)return c(t.currentTarget).parent().find(".editor-tabspace-button").removeClass("btn-primary"),c(t.currentTarget).addClass("btn-primary")},_setAutoCompleteState:function(e,t){var n;return null==t&&(t=!1),(n=c(this.element)).find(".editor-autocomplete-button").removeClass("btn-primary"),t&&c.cookie("enableIntellisenseUserPref",e,{path:"/",expires:365}),e?this.options.enableIntellisense=!0:(this.options.enableIntellisense=!1,this.options.diagnostics=[]),n.find(".editor-autocomplete-button[data-editor="+e+"]").addClass("btn-primary")},_parseJson:function(e,t){return!0===t&&e.forEach(function(e){return e.render=function(e,t,n){var i;n.completion&&((i=document.createElement("DIV")).className="CodeMirror-hint-divCompletionText",i.appendChild(document.createTextNode(" "+n.completion+" ")),e.appendChild(i)),e.style.display="table-row"}}),e},_updateLoadingMessage:function(e,t){var n=!0,i={completeSingle:!1,hint:function(e){return!0===n?n=!1:t=[],(e={from:e.getCursor(),to:e.getCursor(),list:[]}).list=t,e}};h.showHint(e,i.hint,i)},_cleanSuggestions:function(e){for(var t=0;t<e.length;)e[t].text=(e[t].text||"").replace(/^[^\w]*/i,""),e[t].meta=e[t].meta||"",e[t].menu=e[t].menu||"",e[t].completion=e[t].completion||"",t++;return e},_cleanToken:function(e){for(var t,n=0;n<e.length&&!(47<(t=e.charCodeAt(n))&&t<58||64<t&&t<91||96<t&&t<123||"_"===e[n]||"."===e[n]||"-"===e[n]&&">"===e[n+1]);)n++;return(e=e.substr(n)).lastIndexOf(":")&&(e=e.substr(e.lastIndexOf(":")+1)),e.trim()},_filterSuggestions:function(e,t){var n,i,r,o,s,a;for(t=t.toLowerCase(),n=[],i=0;i<e.length;){for(a=e[i].text?e[i].text.toLowerCase():"",r=1,o=s=0;o<t.length;){for(;a[s]!==t[o]&&s<a.length;)s++;if(s===a.length){r=0;break}o++}1===r&&n.push(e[i]),i++}return n},_fuzzyFilterSuggestions:function(e,t){var n={extract:function(e){return e.text}};return i.filter(t,e,n).map(function(e){return e.original})},_adjustHeightSuggestionBox:function(e){var t,n=this.codeEditor,i=n.cursorCoords(n.getCursor()),r=(a.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),a.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight)),o=e.getBoundingClientRect(),s=c("#CodeMirror-hint-infoDiv")[0],n=s.offsetHeight;r<o.bottom+n-o.top?(e.style.height=r-5-n+"px",t=parseInt(e.style.top.substr(0,e.style.top.length-2),10),t+=r-5-n,c(s).css("top",t+"px")):(r=parseInt(e.style.top.substr(0,e.style.top.length-2),10))<i.top&&r+(o.bottom-o.top)+n!==i.top&&(e.style.top=i.top-n-(o.bottom-o.top)+"px",t=i.top-n,c(s).css("top",t+"px"))},_setInfoDiv:function(e,t){var n,i,r;return e.meta.length?e.meta!==e.completion?(0<c("#CodeMirror-hint-infoDiv").length?(c("#CodeMirror-hint-infoDivInfo").text(e.meta),c("#CodeMirror-hint-infoDiv").css("width",c(t).parent().css("width")),c("#CodeMirror-hint-infoDiv").css("left",c(t).parent().css("left")),n=parseInt(c(t).parent().css("top").substr(0,c(t).parent().css("top").length-2),10),n+=parseInt(c(t).parent().css("height").substr(0,c(t).parent().css("height").length-2),10),c("#CodeMirror-hint-infoDiv").css("top",n+"px")):((i=document.createElement("ul")).id="CodeMirror-hint-infoDiv",c(t.parentNode.parentNode).append(c(i)),c("#CodeMirror-hint-infoDiv").css("width",c(t).parent().css("width")),c(i).css("left",c(t).parent().css("left")),n=parseInt(c(t).parent().css("top").substr(0,c(t).parent().css("top").length-2),10),n+=parseInt(c(t).parent().css("height").substr(0,c(t).parent().css("height").length-2),10),c(i).css("top",n+"px"),(r=document.createElement("span")).id="CodeMirror-hint-infoDivInfo",c(r).text(e.meta)),c(i).append(c(r)),this._adjustHeightSuggestionBox(c(".CodeMirror-hints")[0])):void c("#CodeMirror-hint-infoDiv").remove():c("#CodeMirror-hint-infoDiv").remove()},_removeShowHintWidget:function(e){this._updateSuggestions(e,[])},_updateSuggestions:function(e,t){var s=this,n={completeSingle:!1,hint:function(i){var r,o=i.getTokenAt(i.getCursor()).string;return(o=s._cleanToken(o))||!1!==s.options.completionManualTriggered?("."!==o&&"->"!==o||(o=""),t=(t=s._fuzzyFilterSuggestions(t,o)).slice(0,100),r={from:i.getCursor(),to:i.getCursor(),list:t},d.isEmpty(t)?(s._suggestionBoxDisplayStatus=!1,void c("#CodeMirror-hint-infoDiv").remove()):(h.on(r,"shown",function(){!1===s._suggestionBoxDisplayStatus&&s.triggerAnalyticsEvent("change","CodeShellAutoCompletePopUp","shown"),s._suggestionBoxDisplayStatus=!0}),h.on(r,"close",function(){s._suggestionBoxDisplayStatus=!1,c("#CodeMirror-hint-infoDiv").remove()}),h.on(r,"select",function(e,t){s._setInfoDiv(e,t)}),h.on(r,"pick",function(e){var t,n;s.options.isNewLineKeyPress=!1,s._suggestionBoxDisplayStatus=!1,t=r.to.ch-o.length,n={line:r.from.line,ch:t},t={line:r.to.line,ch:r.to.ch},i.replaceRange("",n,t),i.focus,t=e.completion.indexOf("("),(null!=(e=e.meta)?e.indexOf("()"):void 0)<0&&0<t&&(t=n.ch+t+1,i.setCursor({line:n.line,ch:t})),c("#CodeMirror-hint-infoDiv").remove(),s.triggerAnalyticsEvent("change","CodeShellAutoCompletePopUp","picked")}),r)):(s._suggestionBoxDisplayStatus=!1,void c("#CodeMirror-hint-infoDiv").remove())}};h.showHint(e,n.hint,n)},_getLoadingData:function(){return[{completion:"Loading...",text:"",meta:"",menu:"Loading..."}]},_showAutoCompleteLoadingMsg:function(e){var t=this._getLoadingData(),t=this._parseJson(t,!0);this._updateLoadingMessage(e,t)},_getNoCompletions:function(){return[{completion:"No completions.",text:"",meta:"",menu:" No completions."}]},_showNoAutoCompleteMsg:function(e){var t=this._getNoCompletions(),t=this._parseJson(t,!0);this._updateLoadingMessage(e,t)},_setDiagnostics:function(e){var t,n,i,r;for(this.options.diagnostics=[],r=[],n=0,i=e.length;n<i;n++)t={from:{line:(t=e[n]).range.start.line+1-this.options.firstLineNumber,ch:t.range.start.character},to:{line:t.range.end.line+1-this.options.firstLineNumber,ch:t.range.end.character},message:t.message,severity:1===t.severity?"error":"warning"},r.push(this.options.diagnostics.push(t));return r},_filterDiagnostics:function(e,t,n){var i=e.getCursor().line;return n<this.options.lineCount&&(this.options.diagnostics=[]),13===t.keyCode&&this.options.isNewLineKeyPress&&(this.options.diagnostics=this.options.diagnostics.map(function(e){return e.from.line>=i&&(e.from.line=e.from.line+1,e.to.line=e.to.line+1),e})),this.options.diagnostics=this.options.diagnostics.filter(function(e){return e.from.line!==i}),this.options.lineCount=e.lineCount(),this.options.isNewLineKeyPress=!0},_enableIntellisenseFunc:function(t){var n,e;!1!==this.options.enableIntellisense&&!1!==c(this.element).find("#auto-complete").prop("checked")&&(e=this.state.language,0<=s.call(this._autoCompleteSupportedLanguages,e)?(e=t.getTokenAt(t.getCursor()).string,e=this._cleanToken(e),!0!==this._autoCompleteReqestStatus&&(e.length<2&&"."!==e&&!1===this.options.completionManualTriggered||!0!==this._suggestionBoxDisplayStatus&&(n=this,setTimeout(function(){return n._autoCompleteReqestStatus=!1},1e3),a.autocompleteSocket&&a.autocompleteSocket.readyState===WebSocket.OPEN&&(e=JSON.stringify({body:this._getFullCodeOffsetLanguage(t)}),n._autoCompleteReqestStatus=!0,a.autocompleteSocket.send(e),a.autocompleteSocket.onmessage=function(e){e=JSON.parse(e.data);return n._startAutocompletion(t,e)})))):this._removeShowHintWidget(t))},_startAutocompletion:function(e,t){var n;return d.isArray(t)||"completions"===t.type?(this._autoCompleteReqestStatus=!1,"completions"===t.type&&(t=t.data),0===t.length?!0===this.options.completionManualTriggered?this._showNoAutoCompleteMsg(e):this._removeShowHintWidget(e):(n=this._parseJson(t,!0),n=this._cleanSuggestions(n),this._updateSuggestions(e,n)),this.options.completionManualTriggered=!1):"diagnostics"===t.type&&this.options.enableLiveAutocompleteLinting&&this.options.enableLiveAutocomplete&&(n=this.state.language,0<=s.call(this._lintingSupportedLanguages,n))?this._setDiagnostics(t.data):void 0},_getFullCodeOffsetLanguage:function(e){var t,n,i,r,o,s=this.state.language,a="",l=this._getLangHeadCode(s);for(0!==l.length&&(a+=l,a+="\n"),i=a.split("\n").length,--i,r=a.length,t=e.getCursor(),n=0;n<t.line;)r+=e.getLine(n).length+1,n++;return r+=t.ch,a+=e.getValue(),0!==(o=this._getLangTailCode(s)).length&&(a+="\n",a+=o),a+="\n",l=e.getTokenAt(t).string,l=this._cleanToken(l),o=Date.now(),{column:t.ch,line:t.line+i,wordToComplete:l,code:a,offset:r+1,fileType:s,loopback:{requestStartTime:o}}},changeFirePadMode:function(e){return null!=this.firepad&&this.firepad.firebaseAdapter_.ref_.child("question/settings").update({lang:e})},_initFirepad:function(e){var t,n,i,r,o,s,a;if(setTimeout((i=this,function(){if(!i.firepadRead)return i._firepadFallback()}),5e3),"undefined"!=typeof Firebase&&null!==Firebase)return Firebase.INTERNAL.forceWebSockets(),n=new Firebase(e.authUrl),t=e.codeEditor,n.authWithCustomToken(""+e.authToken,(r=this,function(e){if(r.firepadAuthReqCompleted=!0,null!=e)return r._firepadFallback()})),this.firepad=Firepad.fromCodeMirror(n,t,{richTextShortcuts:!1,richTextToolbar:!1}),this.firepad.firebaseAdapter_.ref_.child("question/settings").on("value",(o=this,function(e){e=e.val();if(null!=e&&o.state.language!==e.lang)return o.changeLanguage(e.lang)})),this.firepadReadyCB=(s=this,function(){return s._firepadReady()}),setTimeout((a=this,function(){var e;if(!(a.firepadRead||a.firepadFallback||null!=(e=a.firepad)&&e.ready))return a.fallbackCode=a._getLangCode(a.state.language),a.fallbackKey=a.getCurrentAutosavekey(),a.setStatusText("Fetching code.. Please wait")}),700),this.firepad.on("ready",this.firepadReadyCB);this._firepadFallback()},_firepadReady:function(){var e;return this.setStatusText(""),this.firepad.isHistoryEmpty()&&(this.options.showFileTree||this.codeEditor.setValue(this._getLangCode(this.state.language))),this.firepadRead=!0,e=this.getOptions(),this._setAnswer(e.firepad.readyCb)},_firepadFallback:function(){var e,t;if(this.setStatusText(""),this.firepadFallback=!0,null==this.firepadRead&&(null!=(null!=(e=this.getOptions().firepad)?e.answer:void 0)?this._setAnswer(null!=(t=this.options.firepad)?t.readyFailCb:void 0):(c.jStorage.set(this.fallbackKey,this.fallbackCode),this.options.showFileTree||this.codeEditor.setValue(this._getLangCode(this.state.language)),null!=(t=this.options.firepad)&&"function"==typeof t.readyFailCb&&t.readyFailCb())),null!=this.firepad)return this.firepad.firebaseAdapter_.ready_=!0,this.firepad.off("ready",this.firepadReadyCB),this.firepad.dispose(),this.firepad.firebaseAdapter_.zombie_=!0,this.firepad=void 0},disposeFirepad:function(){var e;return null!=(e=this.firepad)&&"function"==typeof e.dispose?e.dispose():void 0},_setAnswer:function(e){var t=null!=(t=this.getOptions().firepad)?t.answer:void 0;if(null!=t){var n,i=t.code,t=t.language;if(null!=i&&null!=t)return this.changeLanguage(t,(n=this,function(){return n.codeEditor.setValue(i),"function"==typeof e?e():void 0}));else"function"==typeof e&&e()}else"function"==typeof e&&e()},_createAutocompleteSocket:function(e){if(a.autocompleteWS&&a.autocompleteWS.close(),this.options.lang_suffix_map[e])return a.autocompleteWS=new t("wss://autosuggest.hackerrank.com/"+this.options.lang_suffix_map[e]),a.autocompleteWS.maxReconnectAttempts=6,autocompleteWS.onopen=function(){return a.autocompleteSocket=autocompleteWS},autocompleteWS.onerror=function(){if(a.autocompleteWS.reconnectAttempts===a.autocompleteWS.maxReconnectAttempts)return a.autocompleteSocket=!1}},_initCodeEditor:function(e,t){var n,i,r,o;return null==t&&(t=!1),n=this._getUserOpts(),c(this.element).find(".editor-mode-button[data-editor="+n.keyMap+"]").addClass("btn-primary"),this._initAutoSave(),this.options.language=this.state.language=this.options.initialLanguage&&(r=this.options.initialLanguage,0<=s.call(this.options.languages,r))?this.options.initialLanguage:n.userPreferredLang&&(o=n.userPreferredLang,0<=s.call(this.options.languages,o))?n.userPreferredLang:this.options.defaultLanguage&&(o=this.options.defaultLanguage,0<=s.call(this.options.languages,o))?this.options.defaultLanguage:0<this.options.languages.length?this.options.languages[0]:"text",this._initLanguageSelecter(),n.mode=this.options.lang_mime_mapping[this.state.language],n.specialChars=/[\u0000-\u001f\u007f\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,(i=this)._createAutocompleteSocket(this.state.language),this.options.enableIntellisense&&"emacs"!==n.keyMap&&(n.extraKeys["Ctrl-Space"]=function(e){i.options.completionManualTriggered=!0,i.options.enableIntellisense&&i._showAutoCompleteLoadingMsg(e),i._enableIntellisenseFunc(e)}),this.options.enableIntellisense&&"emacs"!==n.keyMap&&(n.extraKeys["Alt-Space"]=function(e){i.options.completionManualTriggered=!0,i.options.enableIntellisense&&i._showAutoCompleteLoadingMsg(e),i._enableIntellisenseFunc(e)}),n.readOnly=t,h.fromTextArea(e,n)},_initLanguageSelecter:function(){var t,e=c(this.element).find("#select-lang");if(e.select2({width:"off",data:d.map(d.sortBy(this.options.languages,function(e){return e}),(t=this,function(e){return{id:e,text:t.options.lang_display_mapping[e]}}))}),e.select2("val",this.state.language),1===this.options.languages.length&&"text"===this.options.languages[0])return e.parent().addClass("hidden")},_changeLanguage:function(e){var t,n=c(e.currentTarget).select2("val");return this.options.diagnostics=[],null!=(t=this.options.firepad)&&t.enabled&&!this.firepadFallback?this.changeFirePadMode(n):this.changeLanguage(n),this.triggerAnalyticsEvent("change","CodeShellChangeLanguage",c(e.currentTarget).select2("val"))},changeLanguage:function(e,t){var n;if(null==t&&(t=null),e)return this.newLanguage=e,this.options.dynamicMode?(this._showLoading(),this._trigger("loadmode",{},{lang:e,callback:(n=this,function(){return n._changeMode(t)})})):this._changeMode(t),this._createAutocompleteSocket(this.newLanguage)},_showLoading:function(e){return null==e&&(e="Loading Editor... "),c(this.element).find(".code-body, .code-head, .code-tail").hide(),c(this.element).find(".loading-mode").html(e).show()},_hideLoading:function(){return c(this.element).find(".code-body, .code-head, .code-tail").show(),c(this.element).find(".loading-mode").hide()},_changeMode:function(e){var t,n,i,r,o;return null==e&&(e=null),this._hideLoading(),n=this.newLanguage,t=this.state.language,this.options.language=this.state.language=n,null!=(i=this.options.firepad)&&i.enabled&&(null==n||null==t||n===t)||this.options.showFileTree||this.codeEditor.setValue(this._getLangCode(n)),this._foldCode(),this.options.showNonEditableHeadTail&&this._displayHeadAndTail(n),this._saveUserOpts({userPreferredLang:n}),this.codeEditor.setOption("mode",this.options.lang_mime_mapping[n]),this._setMainEditorLineNumber(n),c(this.element).find("#select-lang").select2("val",n),this.codeEditor.clearHistory(),null!=this.firepad&&(null!=(i=this.firepad.client_)&&null!=(r=i.undoManager)&&(r.undoStack=[]),null!=(r=this.firepad.client_)&&null!=(o=r.undoManager)&&(o.redoStack=[])),this._trigger("languagechange",{},{from:t,to:n}),"function"==typeof e?e():void 0},_saveCode:function(e){var t,n;if(e.preventDefault(),this.options.onSave)return t=c(this.element).find("#statusbar-mode"),n=t.text(),this.options.onSave(this),t.text("Saved"),setTimeout(function(){return t.text(n)},3e3)},_initAutoSave:function(){var e,t;if(this.options.autoSave&&this.options.onSave)return t=parseInt(this.options.autoSave,10),e=this.options.onSave,this._autoSaveCode(t,e)},_autoSaveCode:function(e,t){return t(),setInterval(this._autoSaveCode,e,e,t)},_setEditorMode:function(e){var t,n=c(e.currentTarget).attr("data-editor");return c(e.currentTarget).parent().find(".editor-mode-button").removeClass("btn-primary"),c(e.currentTarget).addClass("btn-primary"),this.codeEditor.setOption("keyMap",n),t=this,"emacs"===n?delete this.codeEditor.options.extraKeys["Ctrl-Space"]:this.codeEditor.options.extraKeys["Ctrl-Space"]=function(e){t._showAutoCompleteLoadingMsg(e),t._enableIntellisenseFunc(e)},this.focusEditor(e),this._saveUserOpts({keyMap:n})},focusEditor:function(e){return this.codeEditor.focus()},_selectTemplateValue:function(){return d.first(d.filter(arguments,function(e){return void 0!==e&&!1!==e}))},_getDefaultLangCode:function(e){var t,n;if(this.options.forumMkdTool)return"";if(this.options.showTemplate&&!this.options.showNonEditableHeadTail){if(void 0!==this.options.lang_head_template[e]||void 0!==this.options.lang_template[e]||void 0!==this.options.lang_tail_template[e])return""+(n=function(e){return e&&-1===e.indexOf("\n",e.length-1)?e+"\n":e})((t=function(e){var t=new Array(4).join(" ");return void 0===e?"":e.split("\t").join(t)})(this._selectTemplateValue(this.options.lang_head_template[e],"")))+n(t(this._selectTemplateValue(this.options.lang_template[e],"")))+n(t(this._selectTemplateValue(this.options.lang_tail_template[e],"")));if(this._selectTemplateValue(this.options.lang_template[e],this.options.lang_default_text[e]))return this._selectTemplateValue(this.options.lang_template[e],this.options.lang_default_text[e])}else if(this._selectTemplateValue(this.options.lang_template[e],this.options.lang_default_text[e]))return this._selectTemplateValue(this.options.lang_template[e],this.options.lang_default_text[e]);return""},_getLangCode:function(e){var t;return"before_create"===this.state._&&this.options.initialCode&&this.options.initialLanguage===e?this.options.initialCode:this.options.autoSaveNamespace&&(t=c.jStorage.get(this.getCurrentAutosavekey(e)))&&!c.jStorage.get(this.getCurrentAutosavekey(e)+"-default_template")?t:"after_create"===this.state._&&this.options.initialCode&&this.options.initialLanguage===e?this.options.initialCode:this._getDefaultLangCode(e)},_updateLangCode:function(e,t){return e.options.lang_template[e.state.language]=t.getValue()},_getLangHeadCode:function(e){return this.options.lang_head_template[e]&&c.trim(this.options.lang_head_template[e])?this.options.lang_head_template[e]:""},_updateLangHeadCode:function(e,t){return e.options.lang_head_template[e.state.language]=t.getValue()},_getLangTailCode:function(e){return this.options.lang_tail_template[e]&&c.trim(this.options.lang_tail_template[e])?this.options.lang_tail_template[e]:""},_updateLangTailCode:function(e,t){return e.options.lang_tail_template[e.state.language]=t.getValue()},_displayHeadAndTail:function(e){var t,n=c(this.element);return this.options.adminView||0!==this._getLangHeadCode(e).length?(this.codeEditorHead.setValue(this._getLangHeadCode(e)),t=this.codeEditorHead.getValue().split("\n").length,this.codeEditor.setOption("firstLineNumber",t+1),this.codeEditorHead.setOption("mode",this.options.lang_mime_mapping[e]),this.codeEditorHead.foldCode(h.Pos(0,0))):n.find(".code-head").hide(),this.options.adminView||0!==this._getLangTailCode(e).length?(this.codeEditorTail.setValue(this._getLangTailCode(e)),this._updateTailEditorLineNumber(),this.codeEditorTail.setOption("mode",this.options.lang_mime_mapping[e]),this.codeEditorTail.foldCode(h.Pos(0,0))):n.find(".code-tail").hide(),e=n.find(".code-head").height(),n.find(".code-editors").scrollTop(e-60)},_updateTailEditorLineNumber:function(e){var t,n;return null==e&&(e=!1),t=this.codeEditorHead.getValue().split("\n").length,n=this.codeEditor.getValue().split("\n").length,e&&this.codeEditor.setOption("firstLineNumber",t+1),this.codeEditorTail.setOption("firstLineNumber",t+n+1)},_setMainEditorLineNumber:function(e){var t=0;return this.options.adminView&&this.options.showNonEditableHeadTail?t=this.codeEditorHead.getValue().split("\n").length:0<this._getLangHeadCode(e).length&&(t=this._getLangHeadCode(e).split("\n").length),this.options.lang_head_offset&&this.options.lang_head_offset[e]&&(t+=this.options.lang_head_offset[e]),this.options.firstLineNumber=t+1,this.codeEditor.setOption("firstLineNumber",t+1)},_growEditor:function(){var e=this.element.find(".code-body").height();return e<300&&(e=300),this.element.find(".code-editors").css("max-height",e+110+"px")},_saveLangCode:function(){var e,t;if(void 0===this.ActiveVersionId||null===this.ActiveVersionId)return e=new Date,e=""+this.state.language+e.getHours()+e.getMinutes(),a[e]&&clearTimeout(a[e]),t=this,a[e]=setTimeout(function(){return t.saveLangCode()},3e3)},saveLangCode:function(){var e,t,n;if((void 0===this.ActiveVersionId||null===this.ActiveVersionId)&&(n=this.options).autoSaveNamespace){t=this.getCurrentAutosavekey(),e=this.codeEditor.getValue();try{return c.jStorage.set(t+"-default_template",this._getDefaultLangCode(this.state.language)===e||this.options.lang_default_text[this.state.language]===e,{TTL:n.autoSaveTTL}),c.jStorage.set(t,e,{TTL:n.autoSaveTTL})}catch(e){return this.setNotificationMessage('<div class="pjL pmA"> <i class="icon--single icon-attention msR"/>Issue saving to browser cache: another browser or computer may fix this.</div>'),console.log("Looks like an issue with saving to localstorage.")}}},getCurrentAutosavekey:function(e){var t;return null==e&&(e=null),t=this.options,null===e&&(e=this.state.language),t.autoSaveNamespace&&this.state.language?t.autoSaveNamespace+"-"+e:""},_getUserOpts:function(){var i=this,e={lineNumbers:!0,lineWrapping:!0,styleActiveLine:!0,autoCloseBrackets:!0,autoCloseTags:!0,indentWithTabs:!1,matchBrackets:!0,userPreferredLang:null,indentUnit:4},t={extraKeys:{Tab:function(e){var t;return e.somethingSelected()?e.indentSelection("add"):(t=e.coordsChar(e.cursorCoords()).ch%e.getOption("indentUnit"),t=Array(e.getOption("indentUnit")+1-t).join(" "),e.replaceSelection(t,"end","+input"))}},foldGutter:!0,gutters:["CodeMirror-lint-markers","CodeMirror-linenumbers","CodeMirror-foldgutter"],lint:{getAnnotations:function(e,t,n){return i.options.diagnostics},delay:0}};return c.jStorage.get("codeshellUserOpts")?c.extend(c.extend(e,c.parseJSON(c.jStorage.get("codeshellUserOpts"))),t):c.extend(e,t),!1!==this.options.showMode&&null!=e.keyMap&&"default"!==e.keyMap||(e.keyMap="sublime"),e},_saveUserOpts:function(e){var t=c.extend(this._getUserOpts(),e);try{return c.jStorage.set("codeshellUserOpts",JSON.stringify(t))}catch(e){return console.log("Error with saving to localstorage")}},getCurrentFile:function(){return this.currentFile},value:function(e,t){var n,i;return null==e&&(e=!1),null==t&&(t=null),e?this.options.showFileTree?(this._checkAndSave(null,null,this,t),{}):(n=[],d.each(this.options.languages,(i=this,function(e){return e===i.state.language?n.push(i.value()):n.push({code:i._getLangCode(e),language:e})})),n):{code:this.codeEditor.getValue(),language:this.state.language}},_foldCode:function(){var e,t,n,i,r,o,s,a,l,c;if(this.options.foldCode){for(i=this.codeEditor.getValue(),t=e=!1,c=[],a=o=0,l=(s=(i||"").split("\n")).length;a<l;a++)r=s[a],o+=1,e||t||-1===r.indexOf("Head ends")||(n=function(){return{from:{ch:0,line:0},to:{ch:0,line:o}}},h.newFoldFunction(n)(this.codeEditor,{}),e=!0),t||-1===r.indexOf("Tail starts")?c.push(void 0):(r=function(){return{from:{ch:0,line:o-1},to:{ch:0,line:s.length}}},h.newFoldFunction(r)(this.codeEditor,{}),c.push(t=!0));return c}},setValue:function(e,t){if(null==t&&(t={}),e.language)return this.changeLanguage(e.language,(n=this,function(){if(e.code)return n.codeEditor.setValue(e.code),t.clearHistory&&n.codeEditor.clearHistory(),n._foldCode()}));var n},setValueorFork:function(t){var n=this;if(t.language&&!0===a.HR.forkable)return this.changeLanguage(t.language,function(){var e;if(t.code)return c.jStorage.get(""+n.getCurrentAutosavekey(t.language))&&(e=n.value().code)!==t.code&&""!==e&&e!==n._getDefaultLangCode(t.language)&&e!==n.options.lang_default_text[t.language]&&!0===a.HR.forkable&&(a.HR.forkable=!1,n._forkNewBuffer(t)),n.setValue(t),n._foldCode()})},refresh:function(){var t,n,i;if(setTimeout((t=this,function(){var e;return null!=(e=t.codeEditor)?e.refresh():void 0}),25),this.options.showNonEditableHeadTail)return setTimeout((i=this,function(){var e;return null!=(e=i.codeEditorHead)?e.refresh():void 0}),25),setTimeout((n=this,function(){var e;return null!=(e=n.codeEditorTail)?e.refresh():void 0}),25)},onChange:function(e){if(null!==e)return this.codeEditor.on("change",e),this.options.adminView&&this.options.showNonEditableHeadTail?(this.codeEditorHead.on("change",e),this.codeEditorTail.on("change",e)):void 0},setOption:function(e,t){return this.codeEditor.setOption(e,t)},getOptions:function(){return this.options},setStatusText:function(e){return null==e&&(e=""),this.options.statusText=e,c(this.element).find("#status-text").html(d.escape(e))},deleteLangCode:function(){var e=this.options;if(e.autoSaveNamespace)return e=e.autoSaveNamespace+"-"+this.state.language,c.jStorage.deleteKey(e)},enableCompileBtn:function(){return c(this.element).find("button.bb-compile").removeAttr("btn-disabled").removeClass("disabled")},getEditor:function(){return this.codeEditor},setNotificationMessage:function(e){var t=c(this.element).find("#notification-message");return t.html(e),t.removeClass("hidden")},hideNotification:function(){return c(this.element).find("#notification-message").addClass("hidden")},updateCodeshellOption:function(e,t){if(this.options.adminView)return this._setOption(e,t),"languages"===e?(e=c(this.element).find("#select-lang").select2("val"),s.call(this.options.languages,e)<0&&(e=d.first(this.options.languages)),this._initLanguageSelecter(),this.changeLanguage(e)):void 0},setTypingEvent:function(){return a.typingTrackCodeLength||(a.typingTrackCodeLength=0),a.typingTrackCodeLength=a.typingTrackCodeLength+1,a.typingEventEnabled=!0,a.triggerTypingEvent||(a.triggerTypingEvent=function(){var e;if(a.typingEventEnabled=!1,c)return e=0,a.typingTrackCodeLength&&(e=a.typingTrackCodeLength),c.event.trigger({type:"AnalyticsEvent",event_type:"TypingEvent",event_name:"CodeShell",event_value:e}),a.typingTrackCodeLength=0}),a.typingTimeout&&a.clearTimeout(a.typingTimeout),a.typingTimeout=a.setTimeout(function(){return a.triggerTypingEvent()},1e3*this.options.typingTimespan)},triggerAnalyticsEvent:function(e,t,n,i){if(null==e&&(e=null),null==t&&(t=null),null==n&&(n=null),null==i&&(i=null),e&&t)return c.event.trigger({type:"AnalyticsEvent",event_type:e,event_name:t,event_value:n,integer_event_value:i})},_totalCharactersTyped:0,destroy:function(){return this._saveLangCode(this),this.disposeFirepad(),c.Widget.prototype.destroy.call(this)}})},"function"==typeof define&&define.amd?define("codeshell",["jquery","underscore","fuzzy","reconnectingWebsocket","codemirror/lib/codemirror","select2","json2","jstorage","jstree"],function(e,t,n,i,r){o(window.jQuery,window,t,n,i,r)}):o(window.jQuery,window,window._,window.fuzzy,window.ReconnectingWebSocket,window.CodeMirror)}.call(this);